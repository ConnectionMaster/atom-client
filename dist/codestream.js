module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=93)}([function(e,t,n){function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const i=n(2);t.ErrorCodes=i.ErrorCodes,t.ResponseError=i.ResponseError,t.CancellationToken=i.CancellationToken,t.CancellationTokenSource=i.CancellationTokenSource,t.Disposable=i.Disposable,t.Event=i.Event,t.Emitter=i.Emitter,t.Trace=i.Trace,t.SetTraceNotification=i.SetTraceNotification,t.LogTraceNotification=i.LogTraceNotification,t.RequestType=i.RequestType,t.RequestType0=i.RequestType0,t.NotificationType=i.NotificationType,t.NotificationType0=i.NotificationType0,t.MessageReader=i.MessageReader,t.MessageWriter=i.MessageWriter,t.ConnectionStrategy=i.ConnectionStrategy,t.StreamMessageReader=i.StreamMessageReader,t.StreamMessageWriter=i.StreamMessageWriter,t.IPCMessageReader=i.IPCMessageReader,t.IPCMessageWriter=i.IPCMessageWriter,t.createClientPipeTransport=i.createClientPipeTransport,t.createServerPipeTransport=i.createServerPipeTransport,t.generateRandomPipeName=i.generateRandomPipeName,t.createClientSocketTransport=i.createClientSocketTransport,t.createServerSocketTransport=i.createServerSocketTransport,r(n(13)),r(n(45)),t.createProtocolConnection=function(e,t,n,r){return i.createMessageConnection(e,t,n,r)}},function(e,t){e.exports=require("atom")},function(e,t,n){function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const i=n(11),o=n(40);t.RequestType=o.RequestType,t.RequestType0=o.RequestType0,t.RequestType1=o.RequestType1,t.RequestType2=o.RequestType2,t.RequestType3=o.RequestType3,t.RequestType4=o.RequestType4,t.RequestType5=o.RequestType5,t.RequestType6=o.RequestType6,t.RequestType7=o.RequestType7,t.RequestType8=o.RequestType8,t.RequestType9=o.RequestType9,t.ResponseError=o.ResponseError,t.ErrorCodes=o.ErrorCodes,t.NotificationType=o.NotificationType,t.NotificationType0=o.NotificationType0,t.NotificationType1=o.NotificationType1,t.NotificationType2=o.NotificationType2,t.NotificationType3=o.NotificationType3,t.NotificationType4=o.NotificationType4,t.NotificationType5=o.NotificationType5,t.NotificationType6=o.NotificationType6,t.NotificationType7=o.NotificationType7,t.NotificationType8=o.NotificationType8,t.NotificationType9=o.NotificationType9;const s=n(18);t.MessageReader=s.MessageReader,t.StreamMessageReader=s.StreamMessageReader,t.IPCMessageReader=s.IPCMessageReader,t.SocketMessageReader=s.SocketMessageReader;const a=n(19);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=n(14);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const u=n(41);t.CancellationTokenSource=u.CancellationTokenSource,t.CancellationToken=u.CancellationToken;const l=n(42);var d,h,f,p,g,m,v;r(n(43)),r(n(44)),function(e){e.type=new o.NotificationType("$/cancelRequest")}(d||(d={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(h=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(h=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(f=t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(f=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new o.NotificationType("$/setTraceNotification")}(p=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new o.NotificationType("$/logTraceNotification")}(g=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(m=t.ConnectionErrors||(t.ConnectionErrors={}));class ConnectionError extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,ConnectionError.prototype)}}function y(e,t,n,r){let s=0,a=0,y=0;const w="2.0";let b,_,S=void 0,C=Object.create(null),T=void 0,R=Object.create(null),k=new l.LinkedMap,E=Object.create(null),x=Object.create(null),D=h.Off,P=f.Text,A=v.New,O=new c.Emitter,M=new c.Emitter,I=new c.Emitter,q=new c.Emitter;function N(e){return"req-"+e.toString()}function j(e,t){var n;o.isRequestMessage(t)?e.set(N(t.id),t):o.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++y).toString():"res-"+n.toString(),t):e.set("not-"+(++a).toString(),t)}function L(e){}function F(){return A===v.Listening}function $(){return A===v.Closed}function W(){return A===v.Disposed}function U(){A!==v.New&&A!==v.Listening||(A=v.Closed,M.fire(void 0))}function z(){b||0===k.size||(b=setImmediate(()=>{b=void 0,function(){if(0===k.size)return;let e=k.shift();try{o.isRequestMessage(e)?function(e){if(W())return;function n(n,r,i){let s={jsonrpc:w,id:e.id};n instanceof o.ResponseError?s.error=n.toJson():s.result=void 0===n?null:n,B(s,r,i),t.write(s)}function r(n,r,i){let o={jsonrpc:w,id:e.id,error:n.toJson()};B(o,r,i),t.write(o)}!function(e){if(D===h.Off||!_)return;if(P===f.Text){let t=void 0;D===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),_.log(`Received request '${e.method} - (${e.id})'.`,t)}else K("receive-request",e)}(e);let s,a,c=C[e.method];c&&(s=c.type,a=c.handler);let l=Date.now();if(a||S){let c=new u.CancellationTokenSource,d=String(e.id);x[d]=c;try{let u,h=u=void 0===e.params||void 0!==s&&0===s.numberOfParams?a?a(c.token):S(e.method,c.token):i.array(e.params)&&(void 0===s||s.numberOfParams>1)?a?a(...e.params,c.token):S(e.method,...e.params,c.token):a?a(e.params,c.token):S(e.method,e.params,c.token);u?h.then?h.then(t=>{delete x[d],n(t,e.method,l)},t=>{delete x[d],t instanceof o.ResponseError?r(t,e.method,l):t&&i.string(t.message)?r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}):(delete x[d],n(u,e.method,l)):(delete x[d],function(n,r,i){void 0===n&&(n=null);let o={jsonrpc:w,id:e.id,result:n};B(o,r,i),t.write(o)}(u,e.method,l))}catch(t){delete x[d],t instanceof o.ResponseError?n(t,e.method,l):t&&i.string(t.message)?r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else r(new o.ResponseError(o.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):o.isNotificationMessage(e)?function(e){if(W())return;let t,r=void 0;if(e.method===d.type.method)t=(e=>{let t=e.id,n=x[String(t)];n&&n.cancel()});else{let n=R[e.method];n&&(t=n.handler,r=n.type)}if(t||T)try{!function(e){if(D===h.Off||!_||e.method===g.type.method)return;if(P===f.Text){let t=void 0;D===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),_.log(`Received notification '${e.method}'.`,t)}else K("receive-notification",e)}(e),void 0===e.params||void 0!==r&&0===r.numberOfParams?t?t():T(e.method):i.array(e.params)&&(void 0===r||r.numberOfParams>1)?t?t(...e.params):T(e.method,...e.params):t?t(e.params):T(e.method,e.params)}catch(t){t.message?n.error(`Notification handler '${e.method}' failed with message: ${t.message}`):n.error(`Notification handler '${e.method}' failed unexpectedly.`)}else I.fire(e)}(e):o.isResponseMessage(e)?function(e){if(W())return;if(null===e.id)e.error?n.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):n.error("Received response message without id. No further error information provided.");else{let t=String(e.id),r=E[t];if(function(e,t){if(D===h.Off||!_)return;if(P===f.Text){let n=void 0;if(D===h.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){let r=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";_.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${r}`,n)}else _.log(`Received response ${e.id} without active response promise.`,n)}else K("receive-response",e)}(e,r),r){delete E[t];try{if(e.error){let t=e.error;r.reject(new o.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");r.resolve(e.result)}}catch(e){e.message?n.error(`Response handler '${r.method}' failed with message: ${e.message}`):n.error(`Response handler '${r.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void n.error("Received empty message.");n.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(i.string(t.id)||i.number(t.id)){let e=String(t.id),n=E[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{z()}}()}))}e.onClose(U),e.onError(function(e){O.fire([e,void 0,void 0])}),t.onClose(U),t.onError(function(e){O.fire(e)});let V=e=>{try{if(o.isNotificationMessage(e)&&e.method===d.type.method){let n=N(e.params.id),i=k.get(n);if(o.isRequestMessage(i)){let o=r&&r.cancelUndispatched?r.cancelUndispatched(i,L):void 0;if(o&&(void 0!==o.error||void 0!==o.result))return k.delete(n),o.id=i.id,B(o,e.method,Date.now()),void t.write(o)}}j(k,e)}finally{z()}};function B(e,t,n){if(D!==h.Off&&_)if(P===f.Text){let r=void 0;D===h.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),_.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,r)}else K("send-response",e)}function K(e,t){if(!_||D===h.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};_.log(n)}function H(){if($())throw new ConnectionError(m.Closed,"Connection is closed.");if(W())throw new ConnectionError(m.Disposed,"Connection is disposed.")}function G(e){return void 0===e?null:e}function Q(e,t){let n,r=e.numberOfParams;switch(r){case 0:n=null;break;case 1:n=G(t[0]);break;default:n=[];for(let e=0;e<t.length&&e<r;e++)n.push(G(t[e]));if(t.length<r)for(let e=t.length;e<r;e++)n.push(null)}return n}let J={sendNotification:(e,...n)=>{let r,o;if(H(),i.string(e))switch(r=e,n.length){case 0:o=null;break;case 1:o=n[0];break;default:o=n}else r=e.method,o=Q(e,n);let s={jsonrpc:w,method:r,params:o};!function(e){if(D!==h.Off&&_)if(P===f.Text){let t=void 0;D===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),_.log(`Sending notification '${e.method}'.`,t)}else K("send-notification",e)}(s),t.write(s)},onNotification:(e,t)=>{H(),i.func(e)?T=e:t&&(i.string(e)?R[e]={type:void 0,handler:t}:R[e.method]={type:e,handler:t})},sendRequest:(e,...n)=>{let r,a;H(),function(){if(!F())throw new Error("Call listen() first.")}();let c=void 0;if(i.string(e))switch(r=e,n.length){case 0:a=null;break;case 1:u.CancellationToken.is(n[0])?(a=null,c=n[0]):a=G(n[0]);break;default:const t=n.length-1;u.CancellationToken.is(n[t])?(c=n[t],a=2===n.length?G(n[0]):n.slice(0,t).map(e=>G(e))):a=n.map(e=>G(e))}else{r=e.method,a=Q(e,n);let t=e.numberOfParams;c=u.CancellationToken.is(n[t])?n[t]:void 0}let l=s++,p=new Promise((e,n)=>{let i={jsonrpc:w,id:l,method:r,params:a},s={method:r,timerStart:Date.now(),resolve:e,reject:n};!function(e){if(D!==h.Off&&_)if(P===f.Text){let t=void 0;D===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),_.log(`Sending request '${e.method} - (${e.id})'.`,t)}else K("send-request",e)}(i);try{t.write(i)}catch(e){s.reject(new o.ResponseError(o.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),s=null}s&&(E[String(l)]=s)});return c&&c.onCancellationRequested(()=>{J.sendNotification(d.type,{id:l})}),p},onRequest:(e,t)=>{H(),i.func(e)?S=e:t&&(i.string(e)?C[e]={type:void 0,handler:t}:C[e.method]={type:e,handler:t})},trace:(e,t,n)=>{let r=!1,o=f.Text;void 0!==n&&(i.boolean(n)?r=n:(r=n.sendNotification||!1,o=n.traceFormat||f.Text)),P=o,_=(D=e)===h.Off?void 0:t,!r||$()||W()||J.sendNotification(p.type,{value:h.toString(e)})},onError:O.event,onClose:M.event,onUnhandledNotification:I.event,onDispose:q.event,dispose:()=>{if(W())return;A=v.Disposed,q.fire(void 0);let n=new Error("Connection got disposed.");Object.keys(E).forEach(e=>{E[e].reject(n)}),E=Object.create(null),x=Object.create(null),k=new l.LinkedMap,i.func(t.dispose)&&t.dispose(),i.func(e.dispose)&&e.dispose()},listen:()=>{H(),function(){if(F())throw new ConnectionError(m.AlreadyListening,"Connection is already listening")}(),A=v.Listening,e.listen(V)},inspect:()=>{console.log("inspect")}};return J.onNotification(g.type,e=>{D!==h.Off&&_&&_.log(e.message,D===h.Verbose?e.verbose:void 0)}),J}t.ConnectionError=ConnectionError,function(e){e.is=function(e){let t=e;return t&&i.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(v||(v={})),t.createMessageConnection=function(e,n,r,i){var o;return r||(r=t.NullLogger),y(void 0!==(o=e).listen&&void 0===o.read?e:new s.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(n)?n:new a.StreamMessageWriter(n),r,i)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(29);t.AutoLanguageClient=r.default;const i=n(5);t.Convert=i.default;const o=n(21);t.ConsoleLogger=o.ConsoleLogger,t.FilteredLogger=o.FilteredLogger;const s=n(70);t.DownloadFile=s.default;const a=n(32);t.LinterPushV2Adapter=a.default,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(29))},function(e,t){e.exports=require("path")},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),i=n(53),o=n(1);class Convert{static pathToUri(e){let t=e.replace(/\\/g,"/");return"/"!==t[0]&&(t=`/${t}`),encodeURI(`file://${t}`).replace(/[?#]/g,encodeURIComponent)}static uriToPath(e){const t=i.parse(e);if("file:"!==t.protocol||void 0===t.path)return e;let n=decodeURIComponent(t.path);return"win32"===process.platform?("/"===n[0]&&(n=n.substr(1)),n.replace(/\//g,"\\")):n}static pointToPosition(e){return{line:e.row,character:e.column}}static positionToPoint(e){return new o.Point(e.line,e.character)}static lsRangeToAtomRange(e){return new o.Range(Convert.positionToPoint(e.start),Convert.positionToPoint(e.end))}static atomRangeToLSRange(e){return{start:Convert.pointToPosition(e.start),end:Convert.pointToPosition(e.end)}}static editorToTextDocumentIdentifier(e){return{uri:Convert.pathToUri(e.getPath()||"")}}static editorToTextDocumentPositionParams(e,t){return{textDocument:Convert.editorToTextDocumentIdentifier(e),position:Convert.pointToPosition(null!=t?t:e.getCursorBufferPosition())}}static grammarScopesToTextEditorScopes(e){return e.map(e=>`atom-text-editor[data-grammar="${Convert.encodeHTMLAttribute(e.replace(/\./g," "))}"]`).join(", ")}static encodeHTMLAttribute(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};return e.replace(/[&<>'"]/g,e=>t[e])}static atomFileEventToLSFileEvents(e){switch(e.action){case"created":return[{uri:Convert.pathToUri(e.path),type:r.FileChangeType.Created}];case"modified":return[{uri:Convert.pathToUri(e.path),type:r.FileChangeType.Changed}];case"deleted":return[{uri:Convert.pathToUri(e.path),type:r.FileChangeType.Deleted}];case"renamed":{const t=[];return e.oldPath&&t.push({uri:Convert.pathToUri(e.oldPath),type:r.FileChangeType.Deleted}),e.path&&t.push({uri:Convert.pathToUri(e.path),type:r.FileChangeType.Created}),t}default:return[]}}static atomIdeDiagnosticToLSDiagnostic(e){return{range:Convert.atomRangeToLSRange(e.range),severity:Convert.diagnosticTypeToLSSeverity(e.type),source:e.providerName,message:e.text||""}}static diagnosticTypeToLSSeverity(e){switch(e){case"Error":return r.DiagnosticSeverity.Error;case"Warning":return r.DiagnosticSeverity.Warning;case"Info":return r.DiagnosticSeverity.Information;default:throw Error(`Unexpected diagnostic type ${e}`)}}static convertLsTextEdits(e){return(e||[]).map(Convert.convertLsTextEdit)}static convertLsTextEdit(e){return{oldRange:Convert.lsRangeToAtomRange(e.range),newText:e.newText}}}t.default=Convert},function(e,t,n){(function(e){(function(){var t,r,i,o,s,a,c,u,l,d,h,f,p,g,m,v,y,w,b,_=[].slice;u=n(8),s=n(71),v=n(4),b=n(72),a=n(74),m=n(75),y=n(76),l={__esModule:!1,getHomeDirectory:function(){return"win32"!==process.platform||process.env.HOME?process.env.HOME:process.env.USERPROFILE},absolute:function(e){if(null==e)return null;e=l.resolveHome(e);try{return u.realpathSync(e)}catch(t){return t,e}},normalize:function(e){return null==e?null:l.resolveHome(v.normalize(e.toString()))},resolveHome:function(e){return"~"===e?l.getHomeDirectory():0===e.indexOf("~"+v.sep)?""+l.getHomeDirectory()+e.substring(1):e},tildify:function(e){var t,n;return"win32"===process.platform?e:(n=l.normalize(e),null==(t=l.getHomeDirectory())?e:n===t?"~":n.startsWith(v.join(t,v.sep))?v.join("~",v.sep,n.substring(t.length+1)):e)},getAppDataDirectory:function(){switch(process.platform){case"darwin":return l.absolute(v.join("~","Library","Application Support"));case"linux":return"/var/lib";case"win32":return process.env.APPDATA;default:return null}},isAbsolute:function(e){return null==e&&(e=""),"win32"!==process.platform?"/"===e[0]:":"===e[1]||"\\"===e[0]&&"\\"===e[1]},existsSync:function(e){return p(e)&&!1!==w(e)},isDirectorySync:function(e){var t;return!!p(e)&&(!!(t=w(e))&&t.isDirectory())},isDirectory:function(e,t){return p(e)?u.stat(e,function(e,n){return t(null==e&&n.isDirectory())}):t(!1)},isFileSync:function(e){var t;return!!p(e)&&(!!(t=w(e))&&t.isFile())},isSymbolicLinkSync:function(e){var t;return!!p(e)&&(!!(t=g(e))&&t.isSymbolicLink())},isSymbolicLink:function(e,t){return p(e)?u.lstat(e,function(e,n){return"function"==typeof t?t(null!=n&&n.isSymbolicLink()):void 0}):process.nextTick(function(){return"function"==typeof t?t(!1):void 0})},isExecutableSync:function(e){var t;return!!p(e)&&(!!(t=w(e))&&0!=(1&t.mode))},getSizeSync:function(e){var t;return p(e)&&null!=(t=w(e).size)?t:-1},listSync:function(e,t){var n;return l.isDirectorySync(e)?(n=u.readdirSync(e),t&&(n=l.filterExtensions(n,t)),n=(n=n.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})).map(function(t){return v.join(e,t)})):[]},list:function(){var e,t,n,r;return r=arguments[0],(n=2<=arguments.length?_.call(arguments,1):[]).length>1&&(t=n.shift()),e=n.shift(),u.readdir(r,function(n,i){return null!=n?e(n):(t&&(i=l.filterExtensions(i,t)),i=(i=i.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})).map(function(e){return v.join(r,e)}),e(null,i))})},filterExtensions:function(e,t){return t=t.map(function(e){return""===e?e:"."+e.replace(/^\./,"")}),e.filter(function(e){return b.include(t,v.extname(e))})},listTreeSync:function(e){var t,n;return n=[],t=function(e){return n.push(e),!0},l.traverseTreeSync(e,t,t),n},move:function(e,t,n){return h(e,t,function(r,i){var o,s;if(!r)return i?(s=v.dirname(t),u.exists(s,function(r){if(!r)return l.makeTree(s,function(r){if(!r)return u.rename(e,t,n);n(r)});u.rename(e,t,n)})):((o=new Error("'"+t+"' already exists.")).code="EEXIST",void n(o));n(r)})},moveSync:function(e,t){var n,r;if(!f(e,t))throw(n=new Error("'"+t+"' already exists.")).code="EEXIST",n;return r=v.dirname(t),u.existsSync(r)||l.makeTreeSync(r),u.renameSync(e,t)},removeSync:function(e){return y.sync(e)},remove:function(e,t){return y(e,t)},writeFileSync:function(e,t,n){return m.sync(v.dirname(e)),u.writeFileSync(e,t,n)},writeFile:function(e,t,n,r){return r=b.last(arguments),m(v.dirname(e),function(i){return null!=i?"function"==typeof r?r(i):void 0:u.writeFile(e,t,n,r)})},copy:function(e,t,n){return m(v.dirname(t),function(r){var i,o;if(null==r)return(o=u.createReadStream(e)).on("error",function(e){return"function"==typeof n&&n(e),n=null}),(i=u.createWriteStream(t)).on("error",function(e){return"function"==typeof n&&n(e),n=null}),i.on("close",function(){return"function"==typeof n&&n(),n=null}),o.pipe(i);"function"==typeof n&&n(r)})},copySync:function(e,t){var n,r,i,o,s,a,c;for(o=u.readdirSync(e),m.sync(t),c=[],s=0,a=o.length;s<a;s++)r=o[s],i=v.join(e,r),n=v.join(t,r),l.isDirectorySync(i)?c.push(l.copySync(i,n)):c.push(l.copyFileSync(i,n));return c},copyFileSync:function(e,t,n){var r,i,o,s,a,c;null==n&&(n=16384),m.sync(v.dirname(t)),s=null,a=null;try{for(s=u.openSync(e,"r"),a=u.openSync(t,"w"),i=1,o=0,c=[];i>0;)r=new Buffer(n),i=u.readSync(s,r,0,r.length,o),u.writeSync(a,r,0,i,o),c.push(o+=i);return c}finally{null!=s&&u.closeSync(s),null!=a&&u.closeSync(a)}},makeTreeSync:function(e){if(!l.isDirectorySync(e))return m.sync(e)},makeTree:function(e,t){return l.isDirectory(e,function(n){return n?"function"==typeof t?t():void 0:m(e,function(e){return"function"==typeof t?t(e):void 0})})},traverseTreeSync:function(e,t,n){var r;if(null==n&&(n=t),l.isDirectorySync(e))return(r=function(e,t,n){var i,o,s,a,c,l,d;for(c=0,l=(d=u.readdirSync(e)).length;c<l;c++)o=d[c],i=v.join(e,o),(a=u.lstatSync(i)).isSymbolicLink()&&(s=w(i))&&(a=s),a.isDirectory()?n(i)&&r(i,t,n):a.isFile()&&t(i)})(e,t,n)},traverseTree:function(e,t,n,r){return u.readdir(e,function(i,o){var s,c,l,d,h;if(i)return"function"==typeof r?r():void 0;for((c=a.queue(function(e,r){return u.stat(e,function(i,o){return i?r(i):o.isFile()?(t(e),r()):o.isDirectory()&&n(e)?u.readdir(e,function(t,n){var i,o,s;if(t)return r(t);for(o=0,s=n.length;o<s;o++)i=n[o],c.unshift(v.join(e,i));return r()}):r()})})).concurrency=1,c.drain=r,h=[],l=0,d=o.length;l<d;l++)s=o[l],h.push(c.push(v.join(e,s)));return h})},md5ForPath:function(e){var t;return t=u.readFileSync(e),n(20).createHash("md5").update(t).digest("hex")},resolve:function(){var e,t,n,r,i,o,s,a,c,u;if(e=1<=arguments.length?_.call(arguments,0):[],b.isArray(b.last(e))&&(n=e.pop()),o=null!=(u=e.pop())?u.toString():void 0,i=e,o){if(l.isAbsolute(o)){if(n&&(s=l.resolveExtension(o,n)))return s;if(l.existsSync(o))return o}for(a=0,c=i.length;a<c;a++)if(r=i[a],t=v.join(r,o),n){if(s=l.resolveExtension(t,n))return s}else if(l.existsSync(t))return l.absolute(t)}},resolveOnLoadPath:function(){var t,n,r;return t=1<=arguments.length?_.call(arguments,0):[],r=null,r=null!=e.paths?e.paths:process.resourcesPath?[v.join(process.resourcesPath,"app","node_modules")]:[],n=s.globalPaths.concat(r),l.resolve.apply(l,_.call(n).concat(_.call(t)))},resolveExtension:function(e,t){var n,r,i,o;for(i=0,o=t.length;i<o;i++)if(""===(n=t[i])){if(l.existsSync(e))return l.absolute(e)}else if(r=e+"."+n.replace(/^\./,""),l.existsSync(r))return l.absolute(r)},isCompressedExtension:function(e){return null!=e&&r.hasOwnProperty(e.toLowerCase())},isImageExtension:function(e){return null!=e&&i.hasOwnProperty(e.toLowerCase())},isPdfExtension:function(e){return".pdf"===(null!=e?e.toLowerCase():void 0)},isBinaryExtension:function(e){return null!=e&&t.hasOwnProperty(e.toLowerCase())},isReadmePath:function(e){var t;return t=v.extname(e),"readme"===v.basename(e,t).toLowerCase()&&(""===t||l.isMarkdownExtension(t))},isMarkdownExtension:function(e){return null!=e&&o.hasOwnProperty(e.toLowerCase())},isCaseInsensitive:function(){var e,t;return null==l.caseInsensitiveFs&&(e=w(process.execPath.toLowerCase()),t=w(process.execPath.toUpperCase()),l.caseInsensitiveFs=!(!e||!t)&&(e.dev===t.dev&&e.ino===t.ino)),l.caseInsensitiveFs},isCaseSensitive:function(){return!l.isCaseInsensitive()},statSyncNoException:function(){var e;return e=1<=arguments.length?_.call(arguments,0):[],w.apply(null,e)},lstatSyncNoException:function(){var e;return e=1<=arguments.length?_.call(arguments,0):[],g.apply(null,e)}},d=null,c=function(){return null===d&&(d=process.versions.electron&&parseInt(process.versions.electron.split(".")[0])<=2),d},w=function(){var e;if(e=1<=arguments.length?_.call(arguments,0):[],u.statSyncNoException&&c())return u.statSyncNoException.apply(u,e);try{return u.statSync.apply(u,e)}catch(e){return e,!1}},g=function(){var e;if(e=1<=arguments.length?_.call(arguments,0):[],u.lstatSyncNoException&&c())return u.lstatSyncNoException.apply(u,e);try{return u.lstatSync.apply(u,e)}catch(e){return e,!1}},t={".ds_store":!0,".a":!0,".exe":!0,".o":!0,".pyc":!0,".pyo":!0,".so":!0,".woff":!0},r={".bz2":!0,".egg":!0,".epub":!0,".gem":!0,".gz":!0,".jar":!0,".lz":!0,".lzma":!0,".lzo":!0,".rar":!0,".tar":!0,".tgz":!0,".war":!0,".whl":!0,".xpi":!0,".xz":!0,".z":!0,".zip":!0},i={".gif":!0,".ico":!0,".jpeg":!0,".jpg":!0,".png":!0,".tif":!0,".tiff":!0,".webp":!0},o={".markdown":!0,".md":!0,".mdown":!0,".mkd":!0,".mkdown":!0,".rmd":!0,".ron":!0},p=function(e){return null!=e&&"string"==typeof e&&e.length>0},h=function(e,t,n){return u.stat(e,function(r,i){if(!r)return u.stat(t,function(r,o){if(!r||"ENOENT"!==r.code)return n(void 0,e.toLowerCase()===t.toLowerCase()&&i.dev===o.dev&&i.ino===o.ino);n(void 0,!0)});n(r)})},f=function(e,t){var n,r;return r=w(e),n=w(t),!r||!n||e.toLowerCase()===t.toLowerCase()&&r.dev===n.dev&&r.ino===n.ino},e.exports=new Proxy({},{get:function(e,t){var n;return null!=(n=l[t])?n:u[t]},set:function(e,t,n){return l[t]=n}})}).call(this)}).call(this,n(33)(e))},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),o=n(30),s=n(21);!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(0));t.LanguageClientConnection=class LanguageClientConnection extends o.EventEmitter{constructor(e,t){super(),this._rpc=e,this._log=t||new s.NullLogger,this.setupLogging(),e.listen(),this.isConnected=!0,this._rpc.onClose(()=>{this.isConnected=!1,this._log.warn("rpc.onClose","The RPC connection closed unexpectedly"),this.emit("close")})}setupLogging(){this._rpc.onError(e=>this._log.error(["rpc.onError",e])),this._rpc.onUnhandledNotification(e=>{null!=e.method&&null!=e.params?this._log.warn(`rpc.onUnhandledNotification ${e.method}`,e.params):this._log.warn("rpc.onUnhandledNotification",e)}),this._rpc.onNotification((...e)=>this._log.debug("rpc.onNotification",e))}dispose(){this._rpc.dispose()}initialize(e){return this._sendRequest("initialize",e)}initialized(){this._sendNotification("initialized",{})}shutdown(){return this._sendRequest("shutdown")}exit(){this._sendNotification("exit")}onCustom(e,t){this._onNotification({method:e},t)}sendCustomRequest(e,t){return this._sendRequest(e,t)}sendCustomNotification(e,t){this._sendNotification(e,t)}onShowMessage(e){this._onNotification({method:"window/showMessage"},e)}onShowMessageRequest(e){this._onRequest({method:"window/showMessageRequest"},e)}onLogMessage(e){this._onNotification({method:"window/logMessage"},e)}onTelemetryEvent(e){this._onNotification({method:"telemetry/event"},e)}onApplyEdit(e){this._onRequest({method:"workspace/applyEdit"},e)}didChangeConfiguration(e){this._sendNotification("workspace/didChangeConfiguration",e)}didOpenTextDocument(e){this._sendNotification("textDocument/didOpen",e)}didChangeTextDocument(e){this._sendNotification("textDocument/didChange",e)}didCloseTextDocument(e){this._sendNotification("textDocument/didClose",e)}willSaveTextDocument(e){this._sendNotification("textDocument/willSave",e)}willSaveWaitUntilTextDocument(e){return this._sendRequest("textDocument/willSaveWaitUntil",e)}didSaveTextDocument(e){this._sendNotification("textDocument/didSave",e)}didChangeWatchedFiles(e){this._sendNotification("workspace/didChangeWatchedFiles",e)}onPublishDiagnostics(e){this._onNotification({method:"textDocument/publishDiagnostics"},e)}completion(e,t){return this._sendRequest("textDocument/completion",e,t)}completionItemResolve(e){return this._sendRequest("completionItem/resolve",e)}hover(e){return this._sendRequest("textDocument/hover",e)}signatureHelp(e){return this._sendRequest("textDocument/signatureHelp",e)}gotoDefinition(e){return this._sendRequest("textDocument/definition",e)}findReferences(e){return this._sendRequest("textDocument/references",e)}documentHighlight(e){return this._sendRequest("textDocument/documentHighlight",e)}documentSymbol(e,t){return this._sendRequest("textDocument/documentSymbol",e)}workspaceSymbol(e){return this._sendRequest("workspace/symbol",e)}codeAction(e){return this._sendRequest("textDocument/codeAction",e)}codeLens(e){return this._sendRequest("textDocument/codeLens",e)}codeLensResolve(e){return this._sendRequest("codeLens/resolve",e)}documentLink(e){return this._sendRequest("textDocument/documentLink",e)}documentLinkResolve(e){return this._sendRequest("documentLink/resolve",e)}documentFormatting(e){return this._sendRequest("textDocument/formatting",e)}documentRangeFormatting(e){return this._sendRequest("textDocument/rangeFormatting",e)}documentOnTypeFormatting(e){return this._sendRequest("textDocument/onTypeFormatting",e)}rename(e){return this._sendRequest("textDocument/rename",e)}executeCommand(e){return this._sendRequest("workspace/executeCommand",e)}_onRequest(e,t){this._rpc.onRequest(e.method,n=>(this._log.debug(`rpc.onRequest ${e.method}`,n),t(n)))}_onNotification(e,t){this._rpc.onNotification(e.method,n=>{this._log.debug(`rpc.onNotification ${e.method}`,n),t(n)})}_sendNotification(e,t){this._log.debug(`rpc.sendNotification ${e}`,t),this._rpc.sendNotification(e,t)}_sendRequest(e,t,n){return r(this,void 0,void 0,function*(){this._log.debug(`rpc.sendRequest ${e} sending`,t);try{const r=performance.now();let o;o=n?yield this._rpc.sendRequest(e,t,n):yield this._rpc.sendRequest(e,t);const s=performance.now()-r;return this._log.debug(`rpc.sendRequest ${e} received (${Math.floor(s)}ms)`,o),o}catch(t){const r=t;throw n&&r.code===i.ErrorCodes.RequestCancelled?this._log.debug(`rpc.sendRequest ${e} was cancelled`):this._log.error(`rpc.sendRequest ${e} threw`,t),t}})}}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("assert")},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),o=n(2);function s(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(e,t){let n=t.get(e);return void 0===n||n.token.isCancellationRequested||n.cancel(),n=new o.CancellationTokenSource,t.set(e,n),n.token}t.getWordAtPosition=function(e,t){const n=s(e.getNonWordCharacters(t)),r=function(e,t,n){const{row:r,column:i}=t,o=e.rangeForRow(r,!1);let s;return e.scanInRange(n,o,e=>{const{range:n}=e;if(t.isGreaterThanOrEqual(n.start)&&t.isLessThan(n.end))return s=e,void e.stop();n.end.column>i&&e.stop()}),null==s?null:s.range}(e.getBuffer(),t,new RegExp(`^[\t ]*$|[^\\s${n}]+`,"g"));return null==r?new i.Range(t,t):r},t.escapeRegExp=s,t.cancelAndRefreshCancellationToken=a,t.doWithCancellationToken=function(e,t,n){return r(this,void 0,void 0,function*(){const r=a(e,t),i=yield n(r);return t.delete(e),i})},t.assertUnreachable=function(e){return e},t.promiseWithTimeout=function(e,t){return new Promise((n,r)=>{const i=setTimeout(()=>{r(new Error(`Timeout after ${e}ms`))},e);t.then(e=>{clearTimeout(i),n(e)}).catch(e=>{clearTimeout(i),r(e)})})}},function(e,t,n){function r(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=r,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every(e=>r(e))}},function(e,t){e.exports=require("os")},function(e,t,n){var r,i,o,s,a,c,u,l,d,h,f,p,g,m,v;n.r(t),n.d(t,"Position",function(){return r}),n.d(t,"Range",function(){return i}),n.d(t,"Location",function(){return o}),n.d(t,"Color",function(){return s}),n.d(t,"ColorInformation",function(){return a}),n.d(t,"ColorPresentation",function(){return c}),n.d(t,"FoldingRangeKind",function(){return u}),n.d(t,"FoldingRange",function(){return l}),n.d(t,"DiagnosticRelatedInformation",function(){return d}),n.d(t,"DiagnosticSeverity",function(){return h}),n.d(t,"Diagnostic",function(){return f}),n.d(t,"Command",function(){return p}),n.d(t,"TextEdit",function(){return g}),n.d(t,"TextDocumentEdit",function(){return m}),n.d(t,"WorkspaceEdit",function(){return v}),n.d(t,"WorkspaceChange",function(){return N}),n.d(t,"TextDocumentIdentifier",function(){return y}),n.d(t,"VersionedTextDocumentIdentifier",function(){return w}),n.d(t,"TextDocumentItem",function(){return b}),n.d(t,"MarkupKind",function(){return _}),n.d(t,"MarkupContent",function(){return S}),n.d(t,"CompletionItemKind",function(){return C}),n.d(t,"InsertTextFormat",function(){return T}),n.d(t,"CompletionItem",function(){return R}),n.d(t,"CompletionList",function(){return k}),n.d(t,"MarkedString",function(){return E}),n.d(t,"Hover",function(){return x}),n.d(t,"ParameterInformation",function(){return D}),n.d(t,"SignatureInformation",function(){return P}),n.d(t,"DocumentHighlightKind",function(){return A}),n.d(t,"DocumentHighlight",function(){return O}),n.d(t,"SymbolKind",function(){return M}),n.d(t,"SymbolInformation",function(){return I}),n.d(t,"DocumentSymbol",function(){return U}),n.d(t,"CodeActionKind",function(){return j}),n.d(t,"CodeActionContext",function(){return L}),n.d(t,"CodeAction",function(){return F}),n.d(t,"CodeLens",function(){return $}),n.d(t,"FormattingOptions",function(){return W}),n.d(t,"DocumentLink",function(){return z}),n.d(t,"EOL",function(){return K}),n.d(t,"TextDocument",function(){return V}),n.d(t,"TextDocumentSaveReason",function(){return B}),function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return H.objectLiteral(t)&&H.number(t.line)&&H.number(t.character)}}(r||(r={})),function(e){e.create=function(e,t,n,i){if(H.number(e)&&H.number(t)&&H.number(n)&&H.number(i))return{start:r.create(e,t),end:r.create(n,i)};if(r.is(e)&&r.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+i+"]")},e.is=function(e){var t=e;return H.objectLiteral(t)&&r.is(t.start)&&r.is(t.end)}}(i||(i={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return H.defined(t)&&i.is(t.range)&&(H.string(t.uri)||H.undefined(t.uri))}}(o||(o={})),function(e){e.create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},e.is=function(e){var t=e;return H.number(t.red)&&H.number(t.green)&&H.number(t.blue)&&H.number(t.alpha)}}(s||(s={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return i.is(t.range)&&s.is(t.color)}}(a||(a={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return H.string(t.label)&&(H.undefined(t.textEdit)||g.is(t))&&(H.undefined(t.additionalTextEdits)||H.typedArray(t.additionalTextEdits,g.is))}}(c||(c={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(u||(u={})),function(e){e.create=function(e,t,n,r,i){var o={startLine:e,endLine:t};return H.defined(n)&&(o.startCharacter=n),H.defined(r)&&(o.endCharacter=r),H.defined(i)&&(o.kind=i),o},e.is=function(e){var t=e;return H.number(t.startLine)&&H.number(t.startLine)&&(H.undefined(t.startCharacter)||H.number(t.startCharacter))&&(H.undefined(t.endCharacter)||H.number(t.endCharacter))&&(H.undefined(t.kind)||H.string(t.kind))}}(l||(l={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return H.defined(t)&&o.is(t.location)&&H.string(t.message)}}(d||(d={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(h||(h={})),function(e){e.create=function(e,t,n,r,i,o){var s={range:e,message:t};return H.defined(n)&&(s.severity=n),H.defined(r)&&(s.code=r),H.defined(i)&&(s.source=i),H.defined(o)&&(s.relatedInformation=o),s},e.is=function(e){var t=e;return H.defined(t)&&i.is(t.range)&&H.string(t.message)&&(H.number(t.severity)||H.undefined(t.severity))&&(H.number(t.code)||H.string(t.code)||H.undefined(t.code))&&(H.string(t.source)||H.undefined(t.source))&&(H.undefined(t.relatedInformation)||H.typedArray(t.relatedInformation,d.is))}}(f||(f={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i={title:e,command:t};return H.defined(n)&&n.length>0&&(i.arguments=n),i},e.is=function(e){var t=e;return H.defined(t)&&H.string(t.title)&&H.string(t.command)}}(p||(p={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return H.objectLiteral(t)&&H.string(t.newText)&&i.is(t.range)}}(g||(g={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return H.defined(t)&&w.is(t.textDocument)&&Array.isArray(t.edits)}}(m||(m={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||H.typedArray(t.documentChanges,m.is))}}(v||(v={}));var y,w,b,_,S,C,T,R,k,E,x,D,P,A,O,M,I,q=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(g.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(g.replace(e,t))},e.prototype.delete=function(e){this.edits.push(g.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}(),N=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach(function(e){var n=new q(e.edits);t._textEditChanges[e.textDocument.uri]=n}):e.changes&&Object.keys(e.changes).forEach(function(n){var r=new q(e.changes[n]);t._textEditChanges[n]=r}))}return Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(w.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for versioned document changes.");var t=e;if(!(r=this._textEditChanges[t.uri])){var n={textDocument:t,edits:i=[]};this._workspaceEdit.documentChanges.push(n),r=new q(i),this._textEditChanges[t.uri]=r}return r}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var r;if(!(r=this._textEditChanges[e])){var i=[];this._workspaceEdit.changes[e]=i,r=new q(i),this._textEditChanges[e]=r}return r},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return H.defined(t)&&H.string(t.uri)}}(y||(y={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return H.defined(t)&&H.string(t.uri)&&H.number(t.version)}}(w||(w={})),function(e){e.create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},e.is=function(e){var t=e;return H.defined(t)&&H.string(t.uri)&&H.string(t.languageId)&&H.number(t.version)&&H.string(t.text)}}(b||(b={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(_||(_={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(_||(_={})),function(e){e.is=function(e){var t=e;return H.objectLiteral(e)&&_.is(t.kind)&&H.string(t.value)}}(S||(S={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(C||(C={})),function(e){e.PlainText=1,e.Snippet=2}(T||(T={})),function(e){e.create=function(e){return{label:e}}}(R||(R={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(k||(k={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return H.string(t)||H.objectLiteral(t)&&H.string(t.language)&&H.string(t.value)}}(E||(E={})),function(e){e.is=function(e){var t=e;return H.objectLiteral(t)&&(S.is(t.contents)||E.is(t.contents)||H.typedArray(t.contents,E.is))&&(void 0===e.range||i.is(e.range))}}(x||(x={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(D||(D={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i={label:e};return H.defined(t)&&(i.documentation=t),H.defined(n)?i.parameters=n:i.parameters=[],i}}(P||(P={})),function(e){e.Text=1,e.Read=2,e.Write=3}(A||(A={})),function(e){e.create=function(e,t){var n={range:e};return H.number(t)&&(n.kind=t),n}}(O||(O={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(M||(M={})),function(e){e.create=function(e,t,n,r,i){var o={name:e,kind:t,location:{uri:r,range:n}};return i&&(o.containerName=i),o}}(I||(I={}));var j,L,F,$,W,U=function(){return function(){}}();!function(e){e.create=function(e,t,n,r,i,o){var s={name:e,detail:t,kind:n,range:r,selectionRange:i};return void 0!==o&&(s.children=o),s},e.is=function(e){var t=e;return t&&H.string(t.name)&&H.number(t.kind)&&i.is(t.range)&&i.is(t.selectionRange)&&(void 0===t.detail||H.string(t.detail))&&(void 0===t.deprecated||H.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(U||(U={})),function(e){e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports"}(j||(j={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return H.defined(t)&&H.typedArray(t.diagnostics,f.is)&&(void 0===t.only||H.typedArray(t.only,H.string))}}(L||(L={})),function(e){e.create=function(e,t,n){var r={title:e};return p.is(t)?r.command=t:r.edit=t,void 0!==n&&(r.kind=n),r},e.is=function(e){var t=e;return t&&H.string(t.title)&&(void 0===t.diagnostics||H.typedArray(t.diagnostics,f.is))&&(void 0===t.kind||H.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||p.is(t.command))&&(void 0===t.edit||v.is(t.edit))}}(F||(F={})),function(e){e.create=function(e,t){var n={range:e};return H.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return H.defined(t)&&i.is(t.range)&&(H.undefined(t.command)||p.is(t.command))}}($||($={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return H.defined(t)&&H.number(t.tabSize)&&H.boolean(t.insertSpaces)}}(W||(W={}));var z=function(){return function(){}}();!function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return H.defined(t)&&i.is(t.range)&&(H.undefined(t.target)||H.string(t.target))}}(z||(z={}));var V,B,K=["\n","\r\n","\r"];!function(e){e.create=function(e,t,n,r){return new G(e,t,n,r)},e.is=function(e){var t=e;return!!(H.defined(t)&&H.string(t.uri)&&(H.undefined(t.languageId)||H.string(t.languageId))&&H.number(t.lineCount)&&H.func(t.getText)&&H.func(t.positionAt)&&H.func(t.offsetAt))},e.applyEdits=function(e,t){for(var n=e.getText(),r=function e(t,n){if(t.length<=1)return t;var r=t.length/2|0,i=t.slice(0,r),o=t.slice(r);e(i,n),e(o,n);for(var s=0,a=0,c=0;s<i.length&&a<o.length;){var u=n(i[s],o[a]);t[c++]=u<=0?i[s++]:o[a++]}for(;s<i.length;)t[c++]=i[s++];for(;a<o.length;)t[c++]=o[a++];return t}(t,function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n}),i=n.length,o=r.length-1;o>=0;o--){var s=r[o],a=e.offsetAt(s.range.start),c=e.offsetAt(s.range.end);if(!(c<=i))throw new Error("Ovelapping edit");n=n.substring(0,a)+s.newText+n.substring(c,n.length),i=a}return n}}(V||(V={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(B||(B={}));var H,G=function(){function e(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=null},e.prototype.getLineOffsets=function(){if(null===this._lineOffsets){for(var e=[],t=this._content,n=!0,r=0;r<t.length;r++){n&&(e.push(r),n=!1);var i=t.charAt(r);n="\r"===i||"\n"===i,"\r"===i&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return r.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var s=n-1;return r.create(s,e-t[s])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(H||(H={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class CallbackList{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var n=!1,r=0,i=this._callbacks.length;r<i;r++)if(this._callbacks[r]===e){if(this._contexts[r]===t)return this._callbacks.splice(r,1),void this._contexts.splice(r,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],n=this._callbacks.slice(0),r=this._contexts.slice(0),i=0,o=n.length;i<o;i++)try{t.push(n[i].apply(r[i],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class Emitter{constructor(e){this._options=e}get event(){return this._event||(this._event=((e,t,n)=>{let r;return this._callbacks||(this._callbacks=new CallbackList),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),r={dispose:()=>{this._callbacks.remove(e,t),r.dispose=Emitter._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(n)&&n.push(r),r})),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}Emitter._noop=function(){},t.Emitter=Emitter},function(e,t){(function(){var e,n,r,i,o,s,a,c,u,l,d,h,f,p,g,m;t.score=function(e,t,r){var i,s,a;return i=r.preparedQuery,r.allowErrors||o(e,i.core_lw,i.core_up)?(a=e.toLowerCase(),s=n(e,a,i),Math.ceil(s)):0},t.isMatch=o=function(e,t,n){var r,i,o,s,a,c,u;if(o=e.length,s=t.length,!o||s>o)return!1;for(r=-1,i=-1;++i<s;){for(a=t.charCodeAt(i),c=n.charCodeAt(i);++r<o&&(u=e.charCodeAt(r))!==a&&u!==c;);if(r===o)return!1}return!0},t.computeScore=n=function(e,t,n){var r,i,o,s,a,p,g,v,y,w,b,_,S,C,T,R,k,E,x,D,P,A,O,M;if(T=n.query,R=n.query_lw,w=e.length,S=T.length,i=(r=u(e,t,T,R)).score,r.count===S)return h(S,w,i,r.pos);if((C=t.indexOf(R))>-1)return f(e,t,T,R,C,S,w);for(D=new Array(S),a=new Array(S),M=m(S,w),_=b=Math.ceil(.75*S)+5,g=!0,y=-1;++y<S;)D[y]=0,a[y]=0;for(v=-1;++v<w;)if(!(A=t[v]).charCodeAt(0)in n.charCodes){if(g){for(y=-1;++y<S;)a[y]=0;g=!1}}else for(E=0,x=0,s=0,k=!0,g=!0,y=-1;++y<S;){if((P=D[y])>E&&(E=P),p=0,R[y]===A)if(O=c(v,e,t),p=s>0?s:d(e,t,T,R,v,y,O),(o=x+l(v,y,O,i,p))>E)E=o,_=b;else{if(k&&--_<=0)return Math.max(E,D[S-1])*M;k=!1}x=P,s=a[y],a[y]=p,D[y]=E}return(E=D[S-1])*M},t.isWordStart=c=function(e,t,n){var r,i;return 0===e||(r=t[e],i=t[e-1],s(i)||r!==n[e]&&i===n[e-1])},t.isWordEnd=a=function(e,t,n,r){var i,o;return e===r-1||(i=t[e],o=t[e+1],s(o)||i===n[e]&&o!==n[e+1])},s=function(e){return" "===e||"."===e||"-"===e||"_"===e||"/"===e||"\\"===e},g=function(e){var t;return e<20?100+(t=20-e)*t:Math.max(120-e,0)},t.scoreSize=m=function(e,t){return 150/(150+Math.abs(t-e))},h=function(e,t,n,r){return 2*e*(150*n+g(r))*m(e,t)},t.scorePattern=p=function(e,t,n,r,i){var o,s;return s=e,o=6,n===e&&(o+=2),r&&(o+=3),i&&(o+=1),e===t&&(r&&(s+=n===t?2:1),i&&(o+=1)),n+s*(s+o)},t.scoreCharacter=l=function(e,t,n,r,i){var o;return o=g(e),n?o+150*((r>i?r:i)+10):o+150*i},t.scoreConsecutives=d=function(e,t,n,r,i,o,s){var c,u,l,d,h,f,g;for(c=(l=(u=e.length)-i)<(h=(d=n.length)-o)?l:h,f=0,g=0,n[o]===e[i]&&f++;++g<c&&r[++o]===t[++i];)n[o]===e[i]&&f++;return g<c&&i--,1===g?1+2*f:p(g,d,f,s,a(i,e,t,u))},t.scoreExactMatch=f=function(e,t,n,r,i,o,s){var u,l,d,f,g;for((g=c(i,e,t))||(d=t.indexOf(r,i+1))>-1&&(g=c(d,e,t))&&(i=d),l=-1,f=0;++l<o;)n[i+l]===e[l]&&f++;return u=a(i+o-1,e,t,s),h(o,s,p(o,o,f,g,u),i)},e=function(){return function(e,t,n){this.score=e,this.pos=t,this.count=n}}(),r=new e(0,.1,0),t.scoreAcronyms=u=function(t,n,o,a){var u,l,d,h,f,g,m,v,y,w,b;if(f=t.length,g=o.length,!(f>1&&g>1))return r;for(u=0,w=0,b=0,v=0,d=-1,h=-1;++h<g;){if(m=a[h],s(m)){if((d=n.indexOf(m,d+1))>-1){w++;continue}break}for(;++d<f;)if(m===n[d]&&c(d,t,n)){o[h]===t[d]&&v++,b+=d,u++;break}if(d===f)break}return u<2?r:(l=u===g&&i(t,n,o,u),y=p(u,g,v,!0,l),new e(y,b/u,u+w))},i=function(e,t,n,r){var i,o,s;if(i=0,(s=e.length)>12*n.length)return!1;for(o=-1;++o<s;)if(c(o,e,t)&&++i>r)return!1;return!0}}).call(this)},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("electron")},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(14),i=n(11);let o=8192,s=Buffer.from("\r","ascii")[0],a=Buffer.from("\n","ascii")[0],c="\r\n";class MessageBuffer{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(o)}append(e){var t=e;if("string"==typeof e){var n=e,r=Buffer.byteLength(n,this.encoding);(t=Buffer.allocUnsafe(r)).write(n,0,r,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var i=(Math.ceil((this.index+t.length)/o)+1)*o;0===this.index?(this.buffer=Buffer.allocUnsafe(i),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],i)}this.index+=t.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==s||this.buffer[t+1]!==a||this.buffer[t+2]!==s||this.buffer[t+3]!==a);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split(c).forEach(t=>{let n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");let r=t.substr(0,n),i=t.substr(n+1).trim();e[r]=i});let n=t+4;return this.buffer=this.buffer.slice(n),this.index=this.index-n,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),n=e;return this.buffer.copy(this.buffer,0,n),this.index=this.index-n,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&i.func(t.listen)&&i.func(t.dispose)&&i.func(t.onError)&&i.func(t.onClose)&&i.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class AbstractMessageReader{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader recevied error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=AbstractMessageReader;class StreamMessageReader extends AbstractMessageReader{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new MessageBuffer(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var n=JSON.parse(t);this.callback(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=StreamMessageReader;t.IPCMessageReader=class IPCMessageReader extends AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class SocketMessageReader extends StreamMessageReader{constructor(e,t="utf-8"){super(e,t)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(14),i=n(11);let o="Content-Length: ",s="\r\n";!function(e){e.is=function(e){let t=e;return t&&i.func(t.dispose)&&i.func(t.onClose)&&i.func(t.onError)&&i.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class AbstractMessageWriter{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer recevied error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=AbstractMessageWriter;t.StreamMessageWriter=class StreamMessageWriter extends AbstractMessageWriter{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(e){let t=JSON.stringify(e),n=Buffer.byteLength(t,this.encoding),r=[o,n.toString(),s,s];try{this.writable.write(r.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.IPCMessageWriter=class IPCMessageWriter extends AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class SocketMessageWriter extends AbstractMessageWriter{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),n=Buffer.byteLength(t,this.encoding),r=[o,n.toString(),s,s];try{this.sending=!0,this.socket.write(r.join(""),"ascii",n=>{n&&this.handleError(n,e);try{this.socket.write(t,this.encoding,t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(n){this.handleError(n,e)}})}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},function(e,t){e.exports=require("crypto")},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});t.ConsoleLogger=class ConsoleLogger{constructor(e){this.prefix=e}warn(...e){console.warn(...this.format(e))}error(...e){console.error(...this.format(e))}info(...e){console.info(...this.format(e))}debug(...e){console.debug(...this.format(e))}log(...e){console.log(...this.format(e))}format(e){const t=e.filter(e=>null!=e);return"string"==typeof t[0]?1===t.length?[`${this.prefix} ${t[0]}`]:2===t.length?[`${this.prefix} ${t[0]}`,t[1]]:[`${this.prefix} ${t[0]}`,t.slice(1)]:[`${this.prefix}`,t]}};t.NullLogger=class NullLogger{warn(...e){}error(...e){}info(...e){}log(...e){}debug(...e){}};class FilteredLogger{constructor(e,t){this._logger=e,this._predicate=t||((e,t)=>!0)}warn(...e){this._predicate("warn",e)&&this._logger.warn(...e)}error(...e){this._predicate("error",e)&&this._logger.error(...e)}info(...e){this._predicate("info",e)&&this._logger.info(...e)}debug(...e){this._predicate("debug",e)&&this._logger.debug(...e)}log(...e){this._predicate("log",e)&&this._logger.log(...e)}}FilteredLogger.UserLevelFilter=((e,t)=>"warn"===e||"error"===e),FilteredLogger.DeveloperLevelFilter=((e,t)=>!0),t.FilteredLogger=FilteredLogger},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);class ApplyEditAdapter{static attach(e){e.onApplyEdit(e=>ApplyEditAdapter.onApplyEdit(e))}static applyEdits(e,t){const n=e.createCheckpoint();try{return t.sort((e,t)=>-e.oldRange.compare(t.oldRange)),t.reduce((t,n)=>(ApplyEditAdapter.validateEdit(e,n,t),e.setTextInRange(n.oldRange,n.newText),n),null),e.groupChangesSinceCheckpoint(n),n}catch(t){throw e.revertToCheckpoint(n),t}}static onApplyEdit(e){return r(this,void 0,void 0,function*(){let t=e.edit.changes||{};e.edit.documentChanges&&(t={},e.edit.documentChanges.forEach(e=>{e&&e.textDocument&&(t[e.textDocument.uri]=e.edits)}));const n=Object.keys(t),o=[],s=n.map(e=>r(this,void 0,void 0,function*(){const n=i.default.uriToPath(e),r=(yield atom.workspace.open(n,{searchAllPanes:!0,activatePane:!1,activateItem:!1})).getBuffer(),s=i.default.convertLsTextEdits(t[e]),a=ApplyEditAdapter.applyEdits(r,s);o.push({buffer:r,checkpoint:a})}));return{applied:yield Promise.all(s).then(()=>!0).catch(e=>(atom.notifications.addError("workspace/applyEdits failed",{description:"Failed to apply edits.",detail:e.message}),o.forEach(({buffer:e,checkpoint:t})=>{e.revertToCheckpoint(t)}),!1))}})}static validateEdit(e,t,n){const r=e.getPath()||"";if(n&&t.oldRange.end.compare(n.oldRange.start)>0)throw Error(`Found overlapping edit ranges in ${r}`);const i=t.oldRange.start.row,o=t.oldRange.start.column,s=e.lineLengthForRow(i);if(null==s||o>s)throw Error(`Out of range edit on ${r}:${i+1}:${o+1}`)}}t.default=ApplyEditAdapter},function(e,t,n){(function(){var e,r,i,o,s,a,c;c=n(15),o=c.isMatch,e=c.computeScore,a=c.scoreSize,t.score=function(t,n,r){var i,a,c;return i=r.preparedQuery,r.allowErrors||o(t,i.core_lw,i.core_up)?(c=t.toLowerCase(),a=e(t,c,i),a=s(t,c,a,r),Math.ceil(a)):0},s=function(t,n,o,s){var c,u,l,d,h,f,p,g,m,v;if(0===o)return 0;for(m=s.preparedQuery,v=s.useExtensionBonus,g=s.pathSeparator,h=t.length-1;t[h]===g;)h--;if(p=h-(l=t.lastIndexOf(g,h)),f=1,v&&(o*=f+=i(n,m.ext,l,h,2)),-1===l)return o;for(d=m.depth;l>-1&&d-- >0;)l=t.lastIndexOf(g,l-1);return u=-1===l?o:f*e(t.slice(l+1,h+1),n.slice(l+1,h+1),m),(c=10/(20+r(t,h+1,g)))*u+(1-c)*o*a(0,2.5*p)},t.countDir=r=function(e,t,n){var r,i;if(t<1)return 0;for(r=0,i=-1;++i<t&&e[i]===n;);for(;++i<t;)if(e[i]===n)for(r++;++i<t&&e[i]===n;);return r},t.getExtension=function(e){var t;return(t=e.lastIndexOf("."))<0?"":e.substr(t+1)},i=function(e,t,n,r,o){var s,a,c,u;if(!t.length)return 0;if(!((u=e.lastIndexOf(".",r))>n))return 0;for((s=r-u)<(c=t.length)&&(c=s,s=t.length),u++,a=-1;++a<c&&e[u+a]===t[a];);return 0===a&&o>0?.9*i(e,t,n,u-2,o-1):a/s}}).call(this)},function(e,t,n){e.exports=p,p.Minimatch=g;var r={sep:"/"};try{r=n(4)}catch(e){}var i=p.GLOBSTAR=g.GLOBSTAR={},o=n(78),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="[^/]",c=a+"*?",u="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",l="(?:(?!(?:\\/|^)\\.).)*?",d="().*{}+?[]^$\\!".split("").reduce(function(e,t){return e[t]=!0,e},{});var h=/\/+/;function f(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(t){n[t]=e[t]}),n}function p(e,t,n){if("string"!=typeof t)throw new TypeError("glob pattern string required");return n||(n={}),!(!n.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new g(t,n).match(e))}function g(e,t){if(!(this instanceof g))return new g(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==r.sep&&(e=e.split(r.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function m(e,t){if(t||(t=this instanceof g?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:o(e)}p.filter=function(e,t){return t=t||{},function(n,r,i){return p(n,e,t)}},p.defaults=function(e){if(!e||!Object.keys(e).length)return p;var t=p,n=function(n,r,i){return t.minimatch(n,r,f(e,i))};return n.Minimatch=function(n,r){return new t.Minimatch(n,f(e,r))},n},g.defaults=function(e){return e&&Object.keys(e).length?p.defaults(e).Minimatch:g},g.prototype.debug=function(){},g.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,n),n=this.globParts=n.map(function(e){return e.split(h)}),this.debug(this.pattern,n),n=n.map(function(e,t,n){return e.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(e){return-1===e.indexOf(!1)}),this.debug(this.pattern,n),this.set=n},g.prototype.parseNegate=function(){var e=this.pattern,t=!1,n=this.options,r=0;if(n.nonegate)return;for(var i=0,o=e.length;i<o&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.substr(r));this.negate=t},p.braceExpand=function(e,t){return m(e,t)},g.prototype.braceExpand=m,g.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===e)return i;if(""===e)return"";var r,o="",u=!!n.nocase,l=!1,h=[],f=[],p=!1,g=-1,m=-1,y="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",w=this;function b(){if(r){switch(r){case"*":o+=c,u=!0;break;case"?":o+=a,u=!0;break;default:o+="\\"+r}w.debug("clearStateChar %j %j",r,o),r=!1}}for(var _,S=0,C=e.length;S<C&&(_=e.charAt(S));S++)if(this.debug("%s\t%s %s %j",e,S,o,_),l&&d[_])o+="\\"+_,l=!1;else switch(_){case"/":return!1;case"\\":b(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,S,o,_),p){this.debug("  in class"),"!"===_&&S===m+1&&(_="^"),o+=_;continue}w.debug("call clearStateChar %j",r),b(),r=_,n.noext&&b();continue;case"(":if(p){o+="(";continue}if(!r){o+="\\(";continue}h.push({type:r,start:S-1,reStart:o.length,open:s[r].open,close:s[r].close}),o+="!"===r?"(?:(?!(?:":"(?:",this.debug("plType %j %j",r,o),r=!1;continue;case")":if(p||!h.length){o+="\\)";continue}b(),u=!0;var T=h.pop();o+=T.close,"!"===T.type&&f.push(T),T.reEnd=o.length;continue;case"|":if(p||!h.length||l){o+="\\|",l=!1;continue}b(),o+="|";continue;case"[":if(b(),p){o+="\\"+_;continue}p=!0,m=S,g=o.length,o+=_;continue;case"]":if(S===m+1||!p){o+="\\"+_,l=!1;continue}if(p){var R=e.substring(m+1,S);try{RegExp("["+R+"]")}catch(e){var k=this.parse(R,v);o=o.substr(0,g)+"\\["+k[0]+"\\]",u=u||k[1],p=!1;continue}}u=!0,p=!1,o+=_;continue;default:b(),l?l=!1:!d[_]||"^"===_&&p||(o+="\\"),o+=_}p&&(R=e.substr(m+1),k=this.parse(R,v),o=o.substr(0,g)+"\\["+k[0],u=u||k[1]);for(T=h.pop();T;T=h.pop()){var E=o.slice(T.reStart+T.open.length);this.debug("setting tail",o,T),E=E.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,n){return n||(n="\\"),t+t+n+"|"}),this.debug("tail=%j\n   %s",E,E,T,o);var x="*"===T.type?c:"?"===T.type?a:"\\"+T.type;u=!0,o=o.slice(0,T.reStart)+x+"\\("+E}b(),l&&(o+="\\\\");var D=!1;switch(o.charAt(0)){case".":case"[":case"(":D=!0}for(var P=f.length-1;P>-1;P--){var A=f[P],O=o.slice(0,A.reStart),M=o.slice(A.reStart,A.reEnd-8),I=o.slice(A.reEnd-8,A.reEnd),q=o.slice(A.reEnd);I+=q;var N=O.split("(").length-1,j=q;for(S=0;S<N;S++)j=j.replace(/\)[+*?]?/,"");var L="";""===(q=j)&&t!==v&&(L="$");var F=O+M+q+L+I;o=F}""!==o&&u&&(o="(?=.)"+o);D&&(o=y+o);if(t===v)return[o,u];if(!u)return e.replace(/\\(.)/g,"$1");var $=n.nocase?"i":"";try{var W=new RegExp("^"+o+"$",$)}catch(e){return new RegExp("$.")}return W._glob=e,W._src=o,W};var v={};p.makeRe=function(e,t){return new g(e,t||{}).makeRe()},g.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?c:t.dot?u:l,r=t.nocase?"i":"",o=e.map(function(e){return e.map(function(e){return e===i?n:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src}).join("\\/")}).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,r)}catch(e){this.regexp=!1}return this.regexp},p.match=function(e,t,n){var r=new g(t,n=n||{});return e=e.filter(function(e){return r.match(e)}),r.options.nonull&&!e.length&&e.push(t),e},g.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/"));e=e.split(h),this.debug(this.pattern,"split",e);var i,o,s=this.set;for(this.debug(this.pattern,"set",s),o=e.length-1;o>=0&&!(i=e[o]);o--);for(o=0;o<s.length;o++){var a=s[o],c=e;n.matchBase&&1===a.length&&(c=[i]);var u=this.matchOne(c,a,t);if(u)return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},g.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,s=0,a=e.length,c=t.length;o<a&&s<c;o++,s++){this.debug("matchOne loop");var u,l=t[s],d=e[o];if(this.debug(t,l,d),!1===l)return!1;if(l===i){this.debug("GLOBSTAR",[t,l,d]);var h=o,f=s+1;if(f===c){for(this.debug("** at the end");o<a;o++)if("."===e[o]||".."===e[o]||!r.dot&&"."===e[o].charAt(0))return!1;return!0}for(;h<a;){var p=e[h];if(this.debug("\nglobstar while",e,h,t,f,p),this.matchOne(e.slice(h),t.slice(f),n))return this.debug("globstar found match!",h,a,p),!0;if("."===p||".."===p||!r.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,h,t,f);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!n||(this.debug("\n>>> no match, partial?",e,h,t,f),h!==a))}if("string"==typeof l?(u=r.nocase?d.toLowerCase()===l.toLowerCase():d===l,this.debug("string match",l,d,u)):(u=d.match(l),this.debug("pattern match",l,d,u)),!u)return!1}if(o===a&&s===c)return!0;if(o===a)return n;if(s===c)return o===a-1&&""===e[o];throw new Error("wtf?")}},function(e,t,n){function r(e){return"/"===e.charAt(0)}function i(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),n=t[1]||"",r=Boolean(n&&":"!==n.charAt(1));return Boolean(t[2]||r)}e.exports="win32"===process.platform?i:r,e.exports.posix=r,e.exports.win32=i},function(e,t){e.exports=require("child_process")},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.install=async function(e,t=!0){(0,r.default)(e,"[Package-Deps] Package name is required");const n=await i.getDependencies(e);if(!n.length)return;if(t){const t=await i.promptUser(e,n);if("Yes"!==t)return}const s=new o.default(e,n),a=await i.apmInstall(n,function(){s.advance()}),c=[];s.complete(a);for(const e of n)a.has(e.name)||c.push(atom.packages.activatePackage(e.name));await Promise.all(c)};var r=s(n(9)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(87)),o=s(n(92));function s(e){return e&&e.__esModule?e:{default:e}}void 0===window.__steelbrain_package_deps&&(window.__steelbrain_package_deps=new Set)},function(e,t){e.exports=require("net")},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(26),o=n(2),s=n(4),a=n(5),c=n(22),u=n(54),l=n(58),d=n(59),h=n(60),f=n(61),p=n(62),g=n(63),m=n(64),v=n(32),y=n(65),w=n(66),b=n(67),_=n(68),S=n(10),C=n(7);t.LanguageClientConnection=C.LanguageClientConnection;const T=n(21),R=n(69),k=n(1);t.default=class AutoLanguageClient{constructor(){this._isDeactivating=!1,this._serverAdapters=new WeakMap,this.processStdErr="",this.reportBusyWhile=((e,t)=>r(this,void 0,void 0,function*(){return this.busySignalService?this.busySignalService.reportBusyWhile(e,t):this.reportBusyWhileDefault(e,t)})),this.reportBusyWhileDefault=((e,t)=>r(this,void 0,void 0,function*(){let n;this.logger.info(`[Started] ${e}`);try{n=yield t()}finally{this.logger.info(`[Finished] ${e}`)}return n}))}getGrammarScopes(){throw Error("Must implement getGrammarScopes when extending AutoLanguageClient")}getLanguageName(){throw Error("Must implement getLanguageName when extending AutoLanguageClient")}getServerName(){throw Error("Must implement getServerName when extending AutoLanguageClient")}startServerProcess(e){throw Error("Must override startServerProcess to start language server process when extending AutoLanguageClient")}shouldStartForEditor(e){return this.getGrammarScopes().includes(e.getGrammar().scopeName)}getInitializeParams(e,t){return{processId:t.pid,rootPath:e,rootUri:a.default.pathToUri(e),workspaceFolders:[],capabilities:{workspace:{applyEdit:!0,configuration:!1,workspaceEdit:{documentChanges:!0},workspaceFolders:!1,didChangeConfiguration:{dynamicRegistration:!1},didChangeWatchedFiles:{dynamicRegistration:!1},symbol:{dynamicRegistration:!1},executeCommand:{dynamicRegistration:!1}},textDocument:{synchronization:{dynamicRegistration:!1,willSave:!0,willSaveWaitUntil:!0,didSave:!0},completion:{dynamicRegistration:!1,completionItem:{snippetSupport:!0,commitCharactersSupport:!1},contextSupport:!0},hover:{dynamicRegistration:!1},signatureHelp:{dynamicRegistration:!1},references:{dynamicRegistration:!1},documentHighlight:{dynamicRegistration:!1},documentSymbol:{dynamicRegistration:!1,hierarchicalDocumentSymbolSupport:!0},formatting:{dynamicRegistration:!1},rangeFormatting:{dynamicRegistration:!1},onTypeFormatting:{dynamicRegistration:!1},definition:{dynamicRegistration:!1},codeAction:{dynamicRegistration:!1},codeLens:{dynamicRegistration:!1},documentLink:{dynamicRegistration:!1},rename:{dynamicRegistration:!1},implementation:void 0,typeDefinition:void 0,colorProvider:void 0,foldingRange:void 0},experimental:{}}}}preInitialization(e){}postInitialization(e){}getConnectionType(){return null!=this.socket?"socket":"stdio"}getRootConfigurationKey(){return""}mapConfigurationObject(e){return e}getConnectionForEditor(e){return r(this,void 0,void 0,function*(){const t=yield this._serverManager.getServer(e);return t?t.connection:null})}restartAllServers(){return r(this,void 0,void 0,function*(){yield this._serverManager.restartAllServers()})}activate(){this._disposable=new k.CompositeDisposable,this.name=`${this.getLanguageName()} (${this.getServerName()})`,this.logger=this.getLogger(),this._serverManager=new R.ServerManager(e=>this.startServer(e),this.logger,e=>this.shouldStartForEditor(e),e=>this.filterChangeWatchedFiles(e),this.reportBusyWhile,this.getServerName()),this._serverManager.startListening(),process.on("exit",()=>this.exitCleanup.bind(this))}exitCleanup(){this._serverManager.terminate()}deactivate(){return r(this,void 0,void 0,function*(){this._isDeactivating=!0,this._disposable.dispose(),this._serverManager.stopListening(),yield this._serverManager.stopAllServers()})}spawnChildNode(e,t={}){return this.logger.debug(`starting child Node "${e.join(" ")}"`),t.env=t.env||Object.create(process.env),t.env&&(t.env.ELECTRON_RUN_AS_NODE="1",t.env.ELECTRON_NO_ATTACH_CONSOLE="1"),i.spawn(process.execPath,e,t)}getLogger(){const e=atom.config.get("core.debugLSP")?T.FilteredLogger.DeveloperLevelFilter:T.FilteredLogger.UserLevelFilter;return new T.FilteredLogger(new T.ConsoleLogger(this.name),e)}startServer(e){return r(this,void 0,void 0,function*(){const t=yield this.reportBusyWhile(`Starting ${this.getServerName()} for ${s.basename(e)}`,()=>r(this,void 0,void 0,function*(){return this.startServerProcess(e)}));this.captureServerErrors(t,e);const n=new C.LanguageClientConnection(this.createRpcConnection(t),this.logger);this.preInitialization(n);const i=this.getInitializeParams(e,t),o=n.initialize(i);this.reportBusyWhile(`${this.getServerName()} initializing for ${s.basename(e)}`,()=>o);const a=yield o,c={projectPath:e,process:t,connection:n,capabilities:a.capabilities,disposable:new k.CompositeDisposable};this.postInitialization(c),n.initialized(),n.on("close",()=>{this._isDeactivating||(this._serverManager.stopServer(c),this._serverManager.hasServerReachedRestartLimit(c)?(this.logger.warn(`Language server has exceeded auto-restart limit for project '${c.projectPath}'`),atom.notifications.addError(`The ${this.name} language server has exited and exceeded the restart limit for project '${c.projectPath}'`)):(this.logger.debug(`Restarting language server for project '${c.projectPath}'`),this._serverManager.startServer(e)))});const u=this.getRootConfigurationKey();return u&&c.disposable.add(atom.config.observe(u,e=>{const t=this.mapConfigurationObject(e||{});t&&n.didChangeConfiguration({settings:t})})),this.startExclusiveAdapters(c),c})}captureServerErrors(e,t){e.on("error",e=>this.handleSpawnFailure(e)),e.on("exit",(e,t)=>this.logger.debug(`exit: code ${e} signal ${t}`)),e.stderr.setEncoding("utf8"),e.stderr.on("data",e=>{const n=e.toString();this.handleServerStderr(n,t),this.processStdErr=(this.processStdErr+n).split("\n").slice(-5).join("\n")})}handleSpawnFailure(e){atom.notifications.addError(`${this.getServerName()} language server for ${this.getLanguageName()} unable to start`,{dismissable:!0,description:e.toString()})}createRpcConnection(e){let t,n;const r=this.getConnectionType();switch(r){case"ipc":t=new o.IPCMessageReader(e),n=new o.IPCMessageWriter(e);break;case"socket":t=new o.SocketMessageReader(this.socket),n=new o.SocketMessageWriter(this.socket);break;case"stdio":t=new o.StreamMessageReader(e.stdout),n=new o.StreamMessageWriter(e.stdin);break;default:return S.assertUnreachable(r)}return o.createMessageConnection(t,n,{log:(...e)=>{},warn:(...e)=>{},info:(...e)=>{},error:(...e)=>{this.logger.error(e)}})}startExclusiveAdapters(e){if(c.default.attach(e.connection),w.default.attach(e.connection,this.name,e.projectPath),g.default.canAdapt(e.capabilities)){const t=new g.default(e.connection,t=>this.shouldSyncForEditor(t,e.projectPath),e.capabilities.textDocumentSync,this.reportBusyWhile);e.disposable.add(t)}const t=new v.default(e.connection);null!=this._linterDelegate&&t.attach(this._linterDelegate),e.disposable.add(t);const n=new y.default(e.connection);let r;null!=this._consoleDelegate&&n.attach(this._consoleDelegate({id:this.name,name:"abc"})),e.disposable.add(n),_.default.canAdapt(e.capabilities)&&(r=new _.default(e,this.getGrammarScopes()),null!=this._signatureHelpRegistry&&r.attach(this._signatureHelpRegistry),e.disposable.add(r)),this._serverAdapters.set(e,{linterPushV2:t,loggingConsole:n,signatureHelpAdapter:r})}shouldSyncForEditor(e,t){return this.isFileInProject(e,t)&&this.shouldStartForEditor(e)}isFileInProject(e,t){return(e.getPath()||"").startsWith(t)}provideAutocomplete(){return{selector:this.getGrammarScopes().map(e=>e.includes(".")?"."+e:e).join(", "),inclusionPriority:1,suggestionPriority:2,excludeLowerPriority:!1,getSuggestions:this.getSuggestions.bind(this),onDidInsertSuggestion:this.onDidInsertSuggestion.bind(this),getSuggestionDetailsOnSelect:this.getSuggestionDetailsOnSelect.bind(this)}}getSuggestions(e){return r(this,void 0,void 0,function*(){const t=yield this._serverManager.getServer(e.editor);return null!=t&&u.default.canAdapt(t.capabilities)?(this.autoComplete=this.autoComplete||new u.default,this._lastAutocompleteRequest=e,this.autoComplete.getSuggestions(t,e,this.onDidConvertAutocomplete,atom.config.get("autocomplete-plus.minimumWordLength"))):[]})}getSuggestionDetailsOnSelect(e){return r(this,void 0,void 0,function*(){const t=this._lastAutocompleteRequest;if(null==t)return null;const n=yield this._serverManager.getServer(t.editor);return null!=n&&u.default.canResolve(n.capabilities)&&null!=this.autoComplete?this.autoComplete.completeSuggestion(n,e,t,this.onDidConvertAutocomplete):null})}onDidConvertAutocomplete(e,t,n){}onDidInsertSuggestion(e){}provideDefinitions(){return{name:this.name,priority:20,grammarScopes:this.getGrammarScopes(),getDefinition:this.getDefinition.bind(this)}}getDefinition(e,t){return r(this,void 0,void 0,function*(){const n=yield this._serverManager.getServer(e);return null!=n&&p.default.canAdapt(n.capabilities)?(this.definitions=this.definitions||new p.default,this.definitions.getDefinition(n.connection,n.capabilities,this.getLanguageName(),e,t)):null})}provideOutlines(){return{name:this.name,grammarScopes:this.getGrammarScopes(),priority:1,getOutline:this.getOutline.bind(this)}}getOutline(e){return r(this,void 0,void 0,function*(){const t=yield this._serverManager.getServer(e);return null!=t&&b.default.canAdapt(t.capabilities)?(this.outlineView=this.outlineView||new b.default,this.outlineView.getOutline(t.connection,e)):null})}consumeLinterV2(e){if(this._linterDelegate=e({name:this.name}),null!=this._linterDelegate)for(const e of this._serverManager.getActiveServers()){const t=this.getServerAdapter(e,"linterPushV2");null!=t&&t.attach(this._linterDelegate)}}provideFindReferences(){return{isEditorSupported:e=>this.getGrammarScopes().includes(e.getGrammar().scopeName),findReferences:this.getReferences.bind(this)}}getReferences(e,t){return r(this,void 0,void 0,function*(){const n=yield this._serverManager.getServer(e);return null!=n&&m.default.canAdapt(n.capabilities)?(this.findReferences=this.findReferences||new m.default,this.findReferences.getReferences(n.connection,e,t,n.projectPath)):null})}consumeDatatip(e){this._disposable.add(e.addProvider({providerName:this.name,priority:1,grammarScopes:this.getGrammarScopes(),validForScope:e=>this.getGrammarScopes().includes(e),datatip:this.getDatatip.bind(this)}))}getDatatip(e,t){return r(this,void 0,void 0,function*(){const n=yield this._serverManager.getServer(e);return null!=n&&f.default.canAdapt(n.capabilities)?(this.datatip=this.datatip||new f.default,this.datatip.getDatatip(n.connection,e,t)):null})}consumeConsole(e){this._consoleDelegate=e;for(const e of this._serverManager.getActiveServers()){const t=this.getServerAdapter(e,"loggingConsole");t&&t.attach(this._consoleDelegate({id:this.name,name:"abc"}))}return new k.Disposable(()=>{})}provideCodeFormat(){return{grammarScopes:this.getGrammarScopes(),priority:1,formatCode:this.getCodeFormat.bind(this)}}getCodeFormat(e,t){return r(this,void 0,void 0,function*(){const n=yield this._serverManager.getServer(e);return null!=n&&d.default.canAdapt(n.capabilities)?d.default.format(n.connection,n.capabilities,e,t):[]})}provideRangeCodeFormat(){return{grammarScopes:this.getGrammarScopes(),priority:1,formatCode:this.getRangeCodeFormat.bind(this)}}getRangeCodeFormat(e,t){return r(this,void 0,void 0,function*(){const n=yield this._serverManager.getServer(e);return null!=n&&n.capabilities.documentRangeFormattingProvider?d.default.formatRange(n.connection,e,t):[]})}provideFileCodeFormat(){return{grammarScopes:this.getGrammarScopes(),priority:1,formatEntireFile:this.getFileCodeFormat.bind(this)}}provideOnSaveCodeFormat(){return{grammarScopes:this.getGrammarScopes(),priority:1,formatOnSave:this.getFileCodeFormat.bind(this)}}getFileCodeFormat(e){return r(this,void 0,void 0,function*(){const t=yield this._serverManager.getServer(e);return null!=t&&t.capabilities.documentFormattingProvider?d.default.formatDocument(t.connection,e):[]})}provideOnTypeCodeFormat(){return{grammarScopes:this.getGrammarScopes(),priority:1,formatAtPosition:this.getOnTypeCodeFormat.bind(this)}}getOnTypeCodeFormat(e,t,n){return r(this,void 0,void 0,function*(){const r=yield this._serverManager.getServer(e);return null!=r&&r.capabilities.documentOnTypeFormattingProvider?d.default.formatOnType(r.connection,e,t,n):[]})}provideCodeHighlight(){return{grammarScopes:this.getGrammarScopes(),priority:1,highlight:(e,t)=>this.getCodeHighlight(e,t)}}getCodeHighlight(e,t){return r(this,void 0,void 0,function*(){const n=yield this._serverManager.getServer(e);return null!=n&&h.default.canAdapt(n.capabilities)?h.default.highlight(n.connection,n.capabilities,e,t):null})}provideCodeActions(){return{grammarScopes:this.getGrammarScopes(),priority:1,getCodeActions:(e,t,n)=>this.getCodeActions(e,t,n)}}getCodeActions(e,t,n){return r(this,void 0,void 0,function*(){const r=yield this._serverManager.getServer(e);return null!=r&&l.default.canAdapt(r.capabilities)?l.default.getCodeActions(r.connection,r.capabilities,this.getServerAdapter(r,"linterPushV2"),e,t,n):null})}consumeSignatureHelp(e){this._signatureHelpRegistry=e;for(const t of this._serverManager.getActiveServers()){const n=this.getServerAdapter(t,"signatureHelpAdapter");null!=n&&n.attach(e)}return new k.Disposable(()=>{this._signatureHelpRegistry=void 0})}consumeBusySignal(e){return this.busySignalService=e,new k.Disposable(()=>delete this.busySignalService)}filterChangeWatchedFiles(e){return!0}handleServerStderr(e,t){e.split("\n").filter(e=>e).forEach(e=>this.logger.warn(`stderr ${e}`))}getServerAdapter(e,t){const n=this._serverAdapters.get(e);return n&&n[t]}}},function(e,t){e.exports=require("events")},function(e,t,n){(function(){var t,r,i,o,s,a,c;c=n(23),r=c.countDir,o=c.getExtension,e.exports=function(){return function(e,n){var s,c,u;if(s=(u=null!=n?n:{}).optCharRegEx,c=u.pathSeparator,!e||!e.length)return null;this.query=e,this.query_lw=e.toLowerCase(),this.core=t(e,s),this.core_lw=this.core.toLowerCase(),this.core_up=a(this.core),this.depth=r(e,e.length,c),this.ext=o(this.query_lw),this.charCodes=i(this.query_lw)}}(),s=/[ _\-:\/\\]/g,t=function(e,t){return null==t&&(t=s),e.replace(t,"")},a=function(e){var t,n,r;for(t="",n=0,r=e.length;n<r;n++)t+=e[n].toUpperCase()[0];return t},i=function(e){var t,n,r;for(r=e.length,n=-1,t=[];++n<r;)t[e.charCodeAt(n)]=!0;return t}}).call(this)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(7);class LinterPushV2Adapter{constructor(e){this._diagnosticMap=new Map,this._diagnosticCodes=new Map,this._indies=new Set,e.onPublishDiagnostics(this.captureDiagnostics.bind(this))}dispose(){this.detachAll()}attach(e){this._indies.add(e),this._diagnosticMap.forEach((t,n)=>e.setMessages(n,t)),e.onDidDestroy(()=>{this._indies.delete(e)})}detachAll(){this._indies.forEach(e=>e.clearMessages()),this._indies.clear()}captureDiagnostics(e){const t=r.default.uriToPath(e.uri),n=new Map,i=e.diagnostics.map(e=>{const r=this.diagnosticToV2Message(t,e);return n.set(o(r.location.position,e.message),e.code),r});this._diagnosticMap.set(t,i),this._diagnosticCodes.set(t,n),this._indies.forEach(e=>e.setMessages(t,i))}diagnosticToV2Message(e,t){return{location:{file:e,position:r.default.lsRangeToAtomRange(t.range)},excerpt:t.message,linterName:t.source,severity:LinterPushV2Adapter.diagnosticSeverityToSeverity(t.severity||-1)}}static diagnosticSeverityToSeverity(e){switch(e){case i.DiagnosticSeverity.Error:return"error";case i.DiagnosticSeverity.Warning:return"warning";case i.DiagnosticSeverity.Information:case i.DiagnosticSeverity.Hint:default:return"info"}}getDiagnosticCode(e,t,n){const r=e.getPath();if(null!=r){const e=this._diagnosticCodes.get(r);if(null!=e)return e.get(o(t,n))||null}return null}}function o(e,t){return[].concat(...e.serialize(),t).join(",")}t.default=LinterPushV2Adapter},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){e.exports=w;var r=n(8),i=n(35),o=n(24),s=(o.Minimatch,n(81)),a=n(30).EventEmitter,c=n(4),u=n(9),l=n(25),d=n(83),h=n(36),f=(h.alphasort,h.alphasorti,h.setopts),p=h.ownProp,g=n(84),m=(n(16),h.childrenIgnored),v=h.isIgnored,y=n(38);function w(e,t,n){if("function"==typeof t&&(n=t,t={}),t||(t={}),t.sync){if(n)throw new TypeError("callback provided to sync glob");return d(e,t)}return new _(e,t,n)}w.sync=d;var b=w.GlobSync=d.GlobSync;function _(e,t,n){if("function"==typeof t&&(n=t,t=null),t&&t.sync){if(n)throw new TypeError("callback provided to sync glob");return new b(e,t)}if(!(this instanceof _))return new _(e,t,n);f(this,e,t),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof n&&(n=y(n),this.on("error",n),this.on("end",function(e){n(null,e)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return a();for(var o=!0,s=0;s<r;s++)this._process(this.minimatch.set[s],s,!1,a);function a(){--i._processing,i._processing<=0&&(o?process.nextTick(function(){i._finish()}):i._finish())}o=!1}w.glob=w,w.hasMagic=function(e,t){var n=function(e,t){if(null===t||"object"!=typeof t)return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}({},t);n.noprocess=!0;var r=new _(e,n).minimatch.set;if(!e)return!1;if(r.length>1)return!0;for(var i=0;i<r[0].length;i++)if("string"!=typeof r[0][i])return!0;return!1},w.Glob=_,s(_,a),_.prototype._finish=function(){if(u(this instanceof _),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();h.finish(this),this.emit("end",this.found)}},_.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,n=0;n<this.matches.length;n++)this._realpathSet(n,r)}function r(){0==--e&&t._finish()}},_.prototype._realpathSet=function(e,t){var n=this.matches[e];if(!n)return t();var r=Object.keys(n),o=this,s=r.length;if(0===s)return t();var a=this.matches[e]=Object.create(null);r.forEach(function(n,r){n=o._makeAbs(n),i.realpath(n,o.realpathCache,function(r,i){r?"stat"===r.syscall?a[n]=!0:o.emit("error",r):a[i]=!0,0==--s&&(o.matches[e]=a,t())})})},_.prototype._mark=function(e){return h.mark(this,e)},_.prototype._makeAbs=function(e){return h.makeAbs(this,e)},_.prototype.abort=function(){this.aborted=!0,this.emit("abort")},_.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},_.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var n=e[t];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<r.length;t++){var i=r[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},_.prototype._process=function(e,t,n,r){if(u(this instanceof _),u("function"==typeof r),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,n,r]);else{for(var i,s=0;"string"==typeof e[s];)s++;switch(s){case e.length:return void this._processSimple(e.join("/"),t,r);case 0:i=null;break;default:i=e.slice(0,s).join("/")}var a,c=e.slice(s);null===i?a=".":l(i)||l(e.join("/"))?(i&&l(i)||(i="/"+i),a=i):a=i;var d=this._makeAbs(a);if(m(this,a))return r();c[0]===o.GLOBSTAR?this._processGlobStar(i,a,d,c,t,n,r):this._processReaddir(i,a,d,c,t,n,r)}},_.prototype._processReaddir=function(e,t,n,r,i,o,s){var a=this;this._readdir(n,o,function(c,u){return a._processReaddir2(e,t,n,r,i,o,u,s)})},_.prototype._processReaddir2=function(e,t,n,r,i,o,s,a){if(!s)return a();for(var u=r[0],l=!!this.minimatch.negate,d=u._glob,h=this.dot||"."===d.charAt(0),f=[],p=0;p<s.length;p++){if("."!==(m=s[p]).charAt(0)||h)(l&&!e?!m.match(u):m.match(u))&&f.push(m)}var g=f.length;if(0===g)return a();if(1===r.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(p=0;p<g;p++){var m=f[p];e&&(m="/"!==e?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=c.join(this.root,m)),this._emitMatch(i,m)}return a()}r.shift();for(p=0;p<g;p++){m=f[p];e&&(m="/"!==e?e+"/"+m:e+m),this._process([m].concat(r),i,o,a)}a()},_.prototype._emitMatch=function(e,t){if(!this.aborted&&!v(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var n=l(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0;var i=this.statCache[n];i&&this.emit("stat",t,i),this.emit("match",t)}}},_.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var n=this,i=g("lstat\0"+e,function(r,i){if(r&&"ENOENT"===r.code)return t();var o=i&&i.isSymbolicLink();n.symlinks[e]=o,o||!i||i.isDirectory()?n._readdir(e,!1,t):(n.cache[e]="FILE",t())});i&&r.lstat(e,i)}},_.prototype._readdir=function(e,t,n){if(!this.aborted&&(n=g("readdir\0"+e+"\0"+t,n))){if(t&&!p(this.symlinks,e))return this._readdirInGlobStar(e,n);if(p(this.cache,e)){var i=this.cache[e];if(!i||"FILE"===i)return n();if(Array.isArray(i))return n(null,i)}r.readdir(e,function(e,t,n){return function(r,i){r?e._readdirError(t,r,n):e._readdirEntries(t,i,n)}}(this,e,n))}},_.prototype._readdirEntries=function(e,t,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var i=t[r];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,n(null,t)}},_.prototype._readdirError=function(e,t,n){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return n()}},_.prototype._processGlobStar=function(e,t,n,r,i,o,s){var a=this;this._readdir(n,o,function(c,u){a._processGlobStar2(e,t,n,r,i,o,u,s)})},_.prototype._processGlobStar2=function(e,t,n,r,i,o,s,a){if(!s)return a();var c=r.slice(1),u=e?[e]:[],l=u.concat(c);this._process(l,i,!1,a);var d=this.symlinks[n],h=s.length;if(d&&o)return a();for(var f=0;f<h;f++){if("."!==s[f].charAt(0)||this.dot){var p=u.concat(s[f],c);this._process(p,i,!0,a);var g=u.concat(s[f],r);this._process(g,i,!0,a)}}a()},_.prototype._processSimple=function(e,t,n){var r=this;this._stat(e,function(i,o){r._processSimple2(e,t,i,o,n)})},_.prototype._processSimple2=function(e,t,n,r,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!r)return i();if(e&&l(e)&&!this.nomount){var o=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=c.join(this.root,e):(e=c.resolve(this.root,e),o&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()},_.prototype._stat=function(e,t){var n=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&p(this.cache,n)){var o=this.cache[n];if(Array.isArray(o)&&(o="DIR"),!i||"DIR"===o)return t(null,o);if(i&&"FILE"===o)return t()}var s=this.statCache[n];if(void 0!==s){if(!1===s)return t(null,s);var a=s.isDirectory()?"DIR":"FILE";return i&&"FILE"===a?t():t(null,a,s)}var c=this,u=g("stat\0"+n,function(i,o){if(o&&o.isSymbolicLink())return r.stat(n,function(r,i){r?c._stat2(e,n,null,o,t):c._stat2(e,n,r,i,t)});c._stat2(e,n,i,o,t)});u&&r.lstat(n,u)},_.prototype._stat2=function(e,t,n,r,i){if(n&&("ENOENT"===n.code||"ENOTDIR"===n.code))return this.statCache[t]=!1,i();var o="/"===e.slice(-1);if(this.statCache[t]=r,"/"===t.slice(-1)&&r&&!r.isDirectory())return i(null,!1,r);var s=!0;return r&&(s=r.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,o&&"FILE"===s?i():i(null,s,r)}},function(e,t,n){e.exports=l,l.realpath=l,l.sync=d,l.realpathSync=d,l.monkeypatch=function(){r.realpath=l,r.realpathSync=d},l.unmonkeypatch=function(){r.realpath=i,r.realpathSync=o};var r=n(8),i=r.realpath,o=r.realpathSync,s=process.version,a=/^v[0-5]\./.test(s),c=n(77);function u(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function l(e,t,n){if(a)return i(e,t,n);"function"==typeof t&&(n=t,t=null),i(e,t,function(r,i){u(r)?c.realpath(e,t,n):n(r,i)})}function d(e,t){if(a)return o(e,t);try{return o(e,t)}catch(n){if(u(n))return c.realpathSync(e,t);throw n}}},function(e,t,n){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.alphasort=u,t.alphasorti=c,t.setopts=function(e,t,n){n||(n={});if(n.matchBase&&-1===t.indexOf("/")){if(n.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!n.silent,e.pattern=t,e.strict=!1!==n.strict,e.realpath=!!n.realpath,e.realpathCache=n.realpathCache||Object.create(null),e.follow=!!n.follow,e.dot=!!n.dot,e.mark=!!n.mark,e.nodir=!!n.nodir,e.nodir&&(e.mark=!0);e.sync=!!n.sync,e.nounique=!!n.nounique,e.nonull=!!n.nonull,e.nosort=!!n.nosort,e.nocase=!!n.nocase,e.stat=!!n.stat,e.noprocess=!!n.noprocess,e.absolute=!!n.absolute,e.maxLength=n.maxLength||1/0,e.cache=n.cache||Object.create(null),e.statCache=n.statCache||Object.create(null),e.symlinks=n.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(l))}(e,n),e.changedCwd=!1;var o=process.cwd();r(n,"cwd")?(e.cwd=i.resolve(n.cwd),e.changedCwd=e.cwd!==o):e.cwd=o;e.root=n.root||i.resolve(e.cwd,"/"),e.root=i.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=s(e.cwd)?e.cwd:d(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!n.nomount,n.nonegate=!0,n.nocomment=!0,e.minimatch=new a(t,n),e.options=e.minimatch.options},t.ownProp=r,t.makeAbs=d,t.finish=function(e){for(var t=e.nounique,n=t?[]:Object.create(null),r=0,i=e.matches.length;r<i;r++){var o=e.matches[r];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);t?n.push.apply(n,s):s.forEach(function(e){n[e]=!0})}else if(e.nonull){var a=e.minimatch.globSet[r];t?n.push(a):n[a]=!0}}t||(n=Object.keys(n));e.nosort||(n=n.sort(e.nocase?c:u));if(e.mark){for(var r=0;r<n.length;r++)n[r]=e._mark(n[r]);e.nodir&&(n=n.filter(function(t){var n=!/\/$/.test(t),r=e.cache[t]||e.cache[d(e,t)];return n&&r&&(n="DIR"!==r&&!Array.isArray(r)),n}))}e.ignore.length&&(n=n.filter(function(t){return!h(e,t)}));e.found=n},t.mark=function(e,t){var n=d(e,t),r=e.cache[n],i=t;if(r){var o="DIR"===r||Array.isArray(r),s="/"===t.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==t){var a=d(e,i);e.statCache[a]=e.statCache[n],e.cache[a]=e.cache[n]}}return i},t.isIgnored=h,t.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return!(!e.gmatcher||!e.gmatcher.match(t))})};var i=n(4),o=n(24),s=n(25),a=o.Minimatch;function c(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function u(e,t){return e.localeCompare(t)}function l(e){var t=null;if("/**"===e.slice(-3)){var n=e.replace(/(\/\*\*)+$/,"");t=new a(n,{dot:!0})}return{matcher:new a(e,{dot:!0}),gmatcher:t}}function d(e,t){var n=t;return n="/"===t.charAt(0)?i.join(e.root,t):s(t)||""===t?t:e.changedCwd?i.resolve(e.cwd,t):i.resolve(t),"win32"===process.platform&&(n=n.replace(/\\/g,"/")),n}function h(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))})}},function(e,t){e.exports=function e(t,n){if(t&&n)return e(t)(n);if("function"!=typeof t)throw new TypeError("need wrapper function");Object.keys(t).forEach(function(e){r[e]=t[e]});return r;function r(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];var r=t.apply(this,e),i=e[e.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach(function(e){r[e]=i[e]}),r}}},function(e,t,n){var r=n(37);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}e.exports=r(i),e.exports.strict=r(o),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(e,t,n){var r=n(85),i=n(86);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(11);var i;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.MessageWriteError=1,e.MessageReadError=2}(i=t.ErrorCodes||(t.ErrorCodes={}));class ResponseError extends Error{constructor(e,t,n){super(t),this.code=r.number(e)?e:i.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,ResponseError.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=ResponseError;class AbstractMessageType{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=AbstractMessageType;t.RequestType0=class RequestType0 extends AbstractMessageType{constructor(e){super(e,0),this._=void 0}};t.RequestType=class RequestType extends AbstractMessageType{constructor(e){super(e,1),this._=void 0}};t.RequestType1=class RequestType1 extends AbstractMessageType{constructor(e){super(e,1),this._=void 0}};t.RequestType2=class RequestType2 extends AbstractMessageType{constructor(e){super(e,2),this._=void 0}};t.RequestType3=class RequestType3 extends AbstractMessageType{constructor(e){super(e,3),this._=void 0}};t.RequestType4=class RequestType4 extends AbstractMessageType{constructor(e){super(e,4),this._=void 0}};t.RequestType5=class RequestType5 extends AbstractMessageType{constructor(e){super(e,5),this._=void 0}};t.RequestType6=class RequestType6 extends AbstractMessageType{constructor(e){super(e,6),this._=void 0}};t.RequestType7=class RequestType7 extends AbstractMessageType{constructor(e){super(e,7),this._=void 0}};t.RequestType8=class RequestType8 extends AbstractMessageType{constructor(e){super(e,8),this._=void 0}};t.RequestType9=class RequestType9 extends AbstractMessageType{constructor(e){super(e,9),this._=void 0}};t.NotificationType=class NotificationType extends AbstractMessageType{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class NotificationType0 extends AbstractMessageType{constructor(e){super(e,0),this._=void 0}};t.NotificationType1=class NotificationType1 extends AbstractMessageType{constructor(e){super(e,1),this._=void 0}};t.NotificationType2=class NotificationType2 extends AbstractMessageType{constructor(e){super(e,2),this._=void 0}};t.NotificationType3=class NotificationType3 extends AbstractMessageType{constructor(e){super(e,3),this._=void 0}};t.NotificationType4=class NotificationType4 extends AbstractMessageType{constructor(e){super(e,4),this._=void 0}};t.NotificationType5=class NotificationType5 extends AbstractMessageType{constructor(e){super(e,5),this._=void 0}};t.NotificationType6=class NotificationType6 extends AbstractMessageType{constructor(e){super(e,6),this._=void 0}};t.NotificationType7=class NotificationType7 extends AbstractMessageType{constructor(e){super(e,7),this._=void 0}};t.NotificationType8=class NotificationType8 extends AbstractMessageType{constructor(e){super(e,8),this._=void 0}};t.NotificationType9=class NotificationType9 extends AbstractMessageType{constructor(e){super(e,9),this._=void 0}},t.isRequestMessage=function(e){let t=e;return t&&r.string(t.method)&&(r.string(t.id)||r.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&r.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(r.string(t.id)||r.number(t.id)||null===t.id)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(14),i=n(11);var o;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None}),e.is=function(t){let n=t;return n&&(n===e.None||n===e.Cancelled||i.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(o=t.CancellationToken||(t.CancellationToken={}));const s=Object.freeze(function(e,t){let n=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(n)}}});class MutableToken{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._emitter=void 0))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?s:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}}t.CancellationTokenSource=class CancellationTokenSource{get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token.cancel():this._token=o.Cancelled}dispose(){this.cancel()}}},function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(r=t.Touch||(t.Touch={}));t.LinkedMap=class LinkedMap{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,n=r.None){let i=this._map.get(e);if(i)i.value=t,n!==r.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case r.None:this.addItemLast(i);break;case r.First:this.addItemFirst(i);break;case r.Last:default:this.addItemLast(i)}this._map.set(e,i),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._head;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.next}forEachReverse(e,t){let n=this._tail;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===r.First||t===r.Last)if(t===r.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===r.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),i=n(12),o=n(20),s=n(28),a=n(18),c=n(19);t.generateRandomPipeName=function(){const e=o.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:r.join(i.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let n,r=new Promise((e,t)=>{n=e});return new Promise((i,o)=>{let u=s.createServer(e=>{u.close(),n([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});u.on("error",o),u.listen(e,()=>{u.removeListener("error",o),i({onConnected:()=>r})})})},t.createServerPipeTransport=function(e,t="utf-8"){const n=s.createConnection(e);return[new a.SocketMessageReader(n,t),new c.SocketMessageWriter(n,t)]}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(28),i=n(18),o=n(19);t.createClientSocketTransport=function(e,t="utf-8"){let n,s=new Promise((e,t)=>{n=e});return new Promise((a,c)=>{let u=r.createServer(e=>{u.close(),n([new i.SocketMessageReader(e,t),new o.SocketMessageWriter(e,t)])});u.on("error",c),u.listen(e,"127.0.0.1",()=>{u.removeListener("error",c),a({onConnected:()=>s})})})},t.createServerSocketTransport=function(e,t="utf-8"){const n=r.createConnection(e,"127.0.0.1");return[new i.SocketMessageReader(n,t),new o.SocketMessageWriter(n,t)]}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(46),i=n(2),o=n(47);t.ImplementationRequest=o.ImplementationRequest;const s=n(48);t.TypeDefinitionRequest=s.TypeDefinitionRequest;const a=n(49);t.WorkspaceFoldersRequest=a.WorkspaceFoldersRequest,t.DidChangeWorkspaceFoldersNotification=a.DidChangeWorkspaceFoldersNotification;const c=n(50);t.ConfigurationRequest=c.ConfigurationRequest;const u=n(51);t.DocumentColorRequest=u.DocumentColorRequest,t.ColorPresentationRequest=u.ColorPresentationRequest;const l=n(52);t.FoldingRangeRequest=l.FoldingRangeRequest,function(e){e.is=function(e){let t=e;return r.string(t.language)||r.string(t.scheme)||r.string(t.pattern)}}(t.DocumentFilter||(t.DocumentFilter={})),function(e){e.type=new i.RequestType("client/registerCapability")}(t.RegistrationRequest||(t.RegistrationRequest={})),function(e){e.type=new i.RequestType("client/unregisterCapability")}(t.UnregistrationRequest||(t.UnregistrationRequest={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})),function(e){e.type=new i.RequestType("initialize")}(t.InitializeRequest||(t.InitializeRequest={})),function(e){e.unknownProtocolVersion=1}(t.InitializeError||(t.InitializeError={})),function(e){e.type=new i.NotificationType("initialized")}(t.InitializedNotification||(t.InitializedNotification={})),function(e){e.type=new i.RequestType0("shutdown")}(t.ShutdownRequest||(t.ShutdownRequest={})),function(e){e.type=new i.NotificationType0("exit")}(t.ExitNotification||(t.ExitNotification={})),function(e){e.type=new i.NotificationType("workspace/didChangeConfiguration")}(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4}(t.MessageType||(t.MessageType={})),function(e){e.type=new i.NotificationType("window/showMessage")}(t.ShowMessageNotification||(t.ShowMessageNotification={})),function(e){e.type=new i.RequestType("window/showMessageRequest")}(t.ShowMessageRequest||(t.ShowMessageRequest={})),function(e){e.type=new i.NotificationType("window/logMessage")}(t.LogMessageNotification||(t.LogMessageNotification={})),function(e){e.type=new i.NotificationType("telemetry/event")}(t.TelemetryEventNotification||(t.TelemetryEventNotification={})),function(e){e.type=new i.NotificationType("textDocument/didOpen")}(t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})),function(e){e.type=new i.NotificationType("textDocument/didChange")}(t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})),function(e){e.type=new i.NotificationType("textDocument/didClose")}(t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})),function(e){e.type=new i.NotificationType("textDocument/didSave")}(t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})),function(e){e.type=new i.NotificationType("textDocument/willSave")}(t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})),function(e){e.type=new i.RequestType("textDocument/willSaveWaitUntil")}(t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})),function(e){e.type=new i.NotificationType("workspace/didChangeWatchedFiles")}(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(t.FileChangeType||(t.FileChangeType={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(t.WatchKind||(t.WatchKind={})),function(e){e.type=new i.NotificationType("textDocument/publishDiagnostics")}(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(t.CompletionTriggerKind||(t.CompletionTriggerKind={})),function(e){e.type=new i.RequestType("textDocument/completion")}(t.CompletionRequest||(t.CompletionRequest={})),function(e){e.type=new i.RequestType("completionItem/resolve")}(t.CompletionResolveRequest||(t.CompletionResolveRequest={})),function(e){e.type=new i.RequestType("textDocument/hover")}(t.HoverRequest||(t.HoverRequest={})),function(e){e.type=new i.RequestType("textDocument/signatureHelp")}(t.SignatureHelpRequest||(t.SignatureHelpRequest={})),function(e){e.type=new i.RequestType("textDocument/definition")}(t.DefinitionRequest||(t.DefinitionRequest={})),function(e){e.type=new i.RequestType("textDocument/references")}(t.ReferencesRequest||(t.ReferencesRequest={})),function(e){e.type=new i.RequestType("textDocument/documentHighlight")}(t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})),function(e){e.type=new i.RequestType("textDocument/documentSymbol")}(t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})),function(e){e.type=new i.RequestType("workspace/symbol")}(t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})),function(e){e.type=new i.RequestType("textDocument/codeAction")}(t.CodeActionRequest||(t.CodeActionRequest={})),function(e){e.type=new i.RequestType("textDocument/codeLens")}(t.CodeLensRequest||(t.CodeLensRequest={})),function(e){e.type=new i.RequestType("codeLens/resolve")}(t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})),function(e){e.type=new i.RequestType("textDocument/formatting")}(t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})),function(e){e.type=new i.RequestType("textDocument/rangeFormatting")}(t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})),function(e){e.type=new i.RequestType("textDocument/onTypeFormatting")}(t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})),function(e){e.type=new i.RequestType("textDocument/rename")}(t.RenameRequest||(t.RenameRequest={})),function(e){e.type=new i.RequestType("textDocument/prepareRename")}(t.PrepareRenameRequest||(t.PrepareRenameRequest={})),function(e){e.type=new i.RequestType("textDocument/documentLink")}(t.DocumentLinkRequest||(t.DocumentLinkRequest={})),function(e){e.type=new i.RequestType("documentLink/resolve")}(t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})),function(e){e.type=new i.RequestType("workspace/executeCommand")}(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})),function(e){e.type=new i.RequestType("workspace/applyEdit")}(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=Object.prototype.toString;function i(e){return"[object String]"===r.call(e)}function o(e){return"[object Function]"===r.call(e)}function s(e){return Array.isArray(e)}t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"[object Number]"===r.call(e)},t.error=function(e){return"[object Error]"===r.call(e)},t.func=o,t.array=s,t.stringArray=function(e){return s(e)&&e.every(e=>i(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&o(e.then)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);!function(e){e.type=new r.RequestType("textDocument/implementation")}(t.ImplementationRequest||(t.ImplementationRequest={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);!function(e){e.type=new r.RequestType("textDocument/typeDefinition")}(t.TypeDefinitionRequest||(t.TypeDefinitionRequest={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);!function(e){e.type=new r.RequestType0("workspace/workspaceFolders")}(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})),function(e){e.type=new r.NotificationType("workspace/didChangeWorkspaceFolders")}(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);!function(e){e.type=new r.RequestType("workspace/configuration")}(t.ConfigurationRequest||(t.ConfigurationRequest={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);!function(e){e.type=new r.RequestType("textDocument/documentColor")}(t.DocumentColorRequest||(t.DocumentColorRequest={})),function(e){e.type=new r.RequestType("textDocument/colorPresentation")}(t.ColorPresentationRequest||(t.ColorPresentationRequest={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);!function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(t.FoldingRangeKind||(t.FoldingRangeKind={})),function(e){e.type=new r.RequestType("textDocument/foldingRange")}(t.FoldingRangeRequest||(t.FoldingRangeRequest={}))},function(e,t){e.exports=require("url")},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),o=n(10),s=n(55),a=n(7),c=n(1);class PossiblyResolvedCompletionItem{constructor(e,t){this.completionItem=e,this.isResolved=t}}class AutocompleteAdapter{constructor(){this._suggestionCache=new WeakMap,this._cancellationTokens=new WeakMap}static canAdapt(e){return null!=e.completionProvider}static canResolve(e){return null!=e.completionProvider&&!0===e.completionProvider.resolveProvider}getSuggestions(e,t,n,i){return r(this,void 0,void 0,function*(){const r=null!=e.capabilities.completionProvider&&e.capabilities.completionProvider.triggerCharacters||[],[o,a]=AutocompleteAdapter.getTriggerCharacter(t,r);if(!this.shouldTrigger(t,o,i||0))return[];const c=yield this.getOrBuildSuggestions(e,t,o,a,n),u=""!==o&&a?"":t.prefix;for(const e of c)e.replacementPrefix=u;return!(""===t.prefix||""!==o&&a)?s.filter(c,t.prefix,{key:"text"}):c})}shouldTrigger(e,t,n){return e.activatedManually||""!==t||n<=0||e.prefix.length>=n}getOrBuildSuggestions(e,t,n,i,s){return r(this,void 0,void 0,function*(){const r=this._suggestionCache.get(e),a=""!==n&&i?t.bufferPosition.column-n.length:t.bufferPosition.column-t.prefix.length-n.length,u=new c.Point(t.bufferPosition.row,a);if(r&&!r.isIncomplete&&r.triggerChar===n&&r.triggerPoint.isEqual(u))return Array.from(r.suggestionMap.keys());const l=yield o.doWithCancellationToken(e.connection,this._cancellationTokens,r=>e.connection.completion(AutocompleteAdapter.createCompletionParams(t,n,i),r)),d=Array.isArray(l)||!1===l.isIncomplete,h=this.completionItemsToSuggestions(l,t,s);return this._suggestionCache.set(e,{isIncomplete:!d,triggerChar:n,triggerPoint:u,suggestionMap:h}),Array.from(h.keys())})}completeSuggestion(e,t,n,i){return r(this,void 0,void 0,function*(){const r=this._suggestionCache.get(e);if(r){const o=r.suggestionMap.get(t);if(null!=o&&!1===o.isResolved){const r=yield e.connection.completionItemResolve(o.completionItem);null!=r&&(AutocompleteAdapter.completionItemToSuggestion(r,t,n,i),o.isResolved=!0)}}return t})}static getTriggerCharacter(e,t){const n=e.editor.getBuffer(),r=e.bufferPosition,i=r.column-e.prefix.length;for(const o of t){if(e.prefix.endsWith(o))return[o,!0];if(i>=o.length){const e=new c.Point(r.row,i-o.length);if(n.getTextInRange([e,[r.row,i]])===o)return[o,!1]}}return["",!1]}static getPrefixWithTrigger(e,t){return e.editor.getBuffer().getTextInRange([[t.row,t.column],e.bufferPosition])}static createCompletionParams(e,t,n){return{textDocument:i.default.editorToTextDocumentIdentifier(e.editor),position:i.default.pointToPosition(e.bufferPosition),context:AutocompleteAdapter.createCompletionContext(t,n)}}static createCompletionContext(e,t){return""===e?{triggerKind:a.CompletionTriggerKind.Invoked}:t?{triggerKind:a.CompletionTriggerKind.TriggerCharacter,triggerCharacter:e}:{triggerKind:a.CompletionTriggerKind.TriggerForIncompleteCompletions,triggerCharacter:e}}completionItemsToSuggestions(e,t,n){return new Map((Array.isArray(e)?e:e.items||[]).sort((e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label)).map(e=>[AutocompleteAdapter.completionItemToSuggestion(e,{},t,n),new PossiblyResolvedCompletionItem(e,!1)]))}static completionItemToSuggestion(e,t,n,r){return AutocompleteAdapter.applyCompletionItemToSuggestion(e,t),AutocompleteAdapter.applyTextEditToSuggestion(e.textEdit,n.editor,t),AutocompleteAdapter.applySnippetToSuggestion(e,t),null!=r&&r(e,t,n),t}static applyCompletionItemToSuggestion(e,t){t.text=e.insertText||e.label,t.displayText=e.label,t.type=AutocompleteAdapter.completionKindToSuggestionType(e.kind),t.rightLabel=e.detail,"string"==typeof e.documentation&&(t.descriptionMarkdown=e.documentation,t.description=e.documentation),null!=e.documentation&&"object"==typeof e.documentation&&("markdown"===e.documentation.kind?t.descriptionMarkdown=e.documentation.value:t.description=e.documentation.value)}static applyTextEditToSuggestion(e,t,n){e&&(n.replacementPrefix=t.getTextInBufferRange(i.default.lsRangeToAtomRange(e.range)),n.text=e.newText)}static applySnippetToSuggestion(e,t){e.insertTextFormat===a.InsertTextFormat.Snippet&&(t.snippet=null!=e.textEdit?e.textEdit.newText:e.insertText||"")}static completionKindToSuggestionType(e){switch(e){case a.CompletionItemKind.Constant:return"constant";case a.CompletionItemKind.Method:return"method";case a.CompletionItemKind.Function:case a.CompletionItemKind.Constructor:return"function";case a.CompletionItemKind.Field:case a.CompletionItemKind.Property:return"property";case a.CompletionItemKind.Variable:return"variable";case a.CompletionItemKind.Class:return"class";case a.CompletionItemKind.Struct:case a.CompletionItemKind.TypeParameter:return"type";case a.CompletionItemKind.Operator:return"selector";case a.CompletionItemKind.Interface:return"mixin";case a.CompletionItemKind.Module:return"module";case a.CompletionItemKind.Unit:return"builtin";case a.CompletionItemKind.Enum:case a.CompletionItemKind.EnumMember:return"enum";case a.CompletionItemKind.Keyword:return"keyword";case a.CompletionItemKind.Snippet:return"snippet";case a.CompletionItemKind.File:case a.CompletionItemKind.Folder:return"import";case a.CompletionItemKind.Reference:return"require";default:return"value"}}}t.default=AutocompleteAdapter},function(e,t,n){(function(){var t,r,i,o,s,a,c,u;i=n(56),o=n(57),u=n(15),a=n(23),t=n(31),c=null,r="win32"===("undefined"!=typeof process&&null!==process?process.platform:void 0)?"\\":"/",e.exports={filter:function(e,t,n){return null==n&&(n={}),(null!=t?t.length:void 0)&&(null!=e?e.length:void 0)?(n=s(n,t),i(e,t,n)):[]},score:function(e,t,n){return null==n&&(n={}),(null!=e?e.length:void 0)&&(null!=t?t.length:void 0)?(n=s(n,t)).usePathScoring?a.score(e,t,n):u.score(e,t,n):0},match:function(e,t,n){var r;return null==n&&(n={}),e&&t?e===t?function(){r=[];for(var t=0,n=e.length;0<=n?t<n:t>n;0<=n?t++:t--)r.push(t);return r}.apply(this):(n=s(n,t),o.match(e,t,n)):[]},wrap:function(e,t,n){return null==n&&(n={}),e&&t?(n=s(n,t),o.wrap(e,t,n)):[]},prepareQuery:function(e,t){return null==t&&(t={}),(t=s(t,e)).preparedQuery}},s=function(e,n){return null==e.allowErrors&&(e.allowErrors=!1),null==e.usePathScoring&&(e.usePathScoring=!0),null==e.useExtensionBonus&&(e.useExtensionBonus=!1),null==e.pathSeparator&&(e.pathSeparator=r),null==e.optCharRegEx&&(e.optCharRegEx=null),null==e.wrap&&(e.wrap=null),null==e.preparedQuery&&(e.preparedQuery=c&&c.query===n?c:c=new t(n,e)),e}}).call(this)},function(e,t,n){(function(){var t,r,i,o;i=n(15),t=n(23),n(31),r=function(e){return e.candidate},o=function(e,t){return t.score-e.score},e.exports=function(e,n,s){var a,c,u,l,d,h,f,p,g,m,v,y,w;for(p=[],u=s.key,d=s.maxResults,l=s.maxInners,v=s.usePathScoring,g=null!=l&&l>0?l:e.length+1,a=null!=u,f=v?t:i,y=0,w=e.length;y<w&&(c=e[y],!((m=a?c[u]:c)&&(h=f.score(m,n,s))>0)||(p.push({candidate:c,score:h}),--g));y++);return p.sort(o),e=p.map(r),null!=d&&(e=e.slice(0,d)),e}}).call(this)},function(e,t,n){(function(){var e,r,i,o,s,a,c,u,l,d;d=n(15),i=d.isMatch,o=d.isWordStart,l=d.scoreConsecutives,u=d.scoreCharacter,c=d.scoreAcronyms,t.match=s=function(t,n,o){var s,c,u,l,d,h;return s=o.allowErrors,d=o.preparedQuery,l=o.pathSeparator,s||i(t,d.core_lw,d.core_up)?(h=t.toLowerCase(),0===(u=r(t,h,d)).length?u:(t.indexOf(l)>-1&&(c=e(t,h,d,l),u=a(u,c)),u)):[]},t.wrap=function(e,t,n){var r,i,o,a,c,u,l,d,h;if(null!=n.wrap&&(u=(h=n.wrap).tagClass,d=h.tagOpen,l=h.tagClose),null==u&&(u="highlight"),null==d&&(d='<strong class="'+u+'">'),null==l&&(l="</strong>"),e===t)return d+e+l;if(0===(o=s(e,0,n)).length)return e;for(a="",r=-1,c=0;++r<o.length;){for((i=o[r])>c&&(a+=e.substring(c,i),c=i);++r<o.length;){if(o[r]!==i+1){r--;break}i++}++i>c&&(a+=d,a+=e.substring(c,i),a+=l,c=i)}return c<=e.length-1&&(a+=e.substring(c)),a},e=function(e,t,n,i){var o,s,a;for(a=e.length-1;e[a]===i;)a--;if(-1===(o=e.lastIndexOf(i,a)))return[];for(s=n.depth;s-- >0;)if(-1===(o=e.lastIndexOf(i,o-1)))return[];return o++,a++,r(e.slice(o,a),t.slice(o,a),n,o)},a=function(e,t){var n,r,i,o,s,a,c;if(s=e.length,0===(a=t.length))return e.slice();if(0===s)return t.slice();for(i=-1,r=t[o=0],c=[];++i<s;){for(n=e[i];r<=n&&++o<a;)r<n&&c.push(r),r=t[o];c.push(n)}for(;o<a;)c.push(t[o++]);return c},r=function(e,t,n,r){var i,s,a,d,h,f,p,g,m,v,y,w,b,_,S,C,T,R,k,E,x,D;for(null==r&&(r=0),_=n.query,S=n.query_lw,m=e.length,w=_.length,i=c(e,t,_,S).score,R=new Array(w),h=new Array(w),0,1,2,3,D=new Array(m*w),b=-1,g=-1;++g<w;)R[g]=0,h[g]=0;for(p=-1;++p<m;)for(C=0,k=0,d=0,E=t[p],g=-1;++g<w;)f=0,s=0,T=k,S[g]===E&&(x=o(p,e,t),f=d>0?d:l(e,t,_,S,p,g,x),s=T+u(p,g,x,i,f)),k=R[g],d=h[g],C>k?y=2:(C=k,y=1),s>C?(C=s,y=3):f=0,R[g]=C,h[g]=f,D[++b]=C>0?y:0;for(b=(p=m-1)*w+(g=w-1),a=!0,v=[];a&&p>=0&&g>=0;)switch(D[b]){case 1:p--,b-=w;break;case 2:g--,b--;break;case 3:v.push(p+r),g--,p--,b-=w+1;break;default:a=!1}return v.reverse(),v}}).call(this)},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),o=n(5),s=n(22),a=n(7);class CodeActionAdapter{static canAdapt(e){return!0===e.codeActionProvider}static getCodeActions(e,t,n,o,s,a){return r(this,void 0,void 0,function*(){if(null==n)return[];i(t.codeActionProvider,"Must have the textDocument/codeAction capability");const r=CodeActionAdapter.createCodeActionParams(n,o,s,a);return(yield e.codeAction(r)).map(t=>CodeActionAdapter.createCodeAction(t,e))})}static createCodeAction(e,t){return{apply(){return r(this,void 0,void 0,function*(){a.CodeAction.is(e)?(CodeActionAdapter.applyWorkspaceEdit(e.edit),yield CodeActionAdapter.executeCommand(e.command,t)):yield CodeActionAdapter.executeCommand(e,t)})},getTitle:()=>Promise.resolve(e.title),dispose(){}}}static applyWorkspaceEdit(e){a.WorkspaceEdit.is(e)&&s.default.onApplyEdit({edit:e})}static executeCommand(e,t){return r(this,void 0,void 0,function*(){a.Command.is(e)&&(yield t.executeCommand({command:e.command,arguments:e.arguments}))})}static createCodeActionParams(e,t,n,r){return{textDocument:o.default.editorToTextDocumentIdentifier(t),range:o.default.atomRangeToLSRange(n),context:{diagnostics:r.map(n=>{const r=o.default.atomIdeDiagnosticToLSDiagnostic(n);if(null!=n.range&&null!=n.text){const i=e.getDiagnosticCode(t,n.range,n.text);null!=i&&(r.code=i)}return r})}}}}t.default=CodeActionAdapter},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);class CodeFormatAdapter{static canAdapt(e){return!0===e.documentRangeFormattingProvider||!0===e.documentFormattingProvider}static format(e,t,n,r){if(t.documentRangeFormattingProvider)return CodeFormatAdapter.formatRange(e,n,r);if(t.documentFormattingProvider)return CodeFormatAdapter.formatDocument(e,n);throw new Error("Can not format document, language server does not support it")}static formatDocument(e,t){return r(this,void 0,void 0,function*(){const n=yield e.documentFormatting(CodeFormatAdapter.createDocumentFormattingParams(t));return i.default.convertLsTextEdits(n)})}static createDocumentFormattingParams(e){return{textDocument:i.default.editorToTextDocumentIdentifier(e),options:CodeFormatAdapter.getFormatOptions(e)}}static formatRange(e,t,n){return r(this,void 0,void 0,function*(){const r=yield e.documentRangeFormatting(CodeFormatAdapter.createDocumentRangeFormattingParams(t,n));return i.default.convertLsTextEdits(r)})}static createDocumentRangeFormattingParams(e,t){return{textDocument:i.default.editorToTextDocumentIdentifier(e),range:i.default.atomRangeToLSRange(t),options:CodeFormatAdapter.getFormatOptions(e)}}static formatOnType(e,t,n,o){return r(this,void 0,void 0,function*(){const r=yield e.documentOnTypeFormatting(CodeFormatAdapter.createDocumentOnTypeFormattingParams(t,n,o));return i.default.convertLsTextEdits(r)})}static createDocumentOnTypeFormattingParams(e,t,n){return{textDocument:i.default.editorToTextDocumentIdentifier(e),position:i.default.pointToPosition(t),ch:n,options:CodeFormatAdapter.getFormatOptions(e)}}static getFormatOptions(e){return{tabSize:e.getTabLength(),insertSpaces:e.getSoftTabs()}}}t.default=CodeFormatAdapter},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),o=n(5);t.default=class CodeHighlightAdapter{static canAdapt(e){return!0===e.documentHighlightProvider}static highlight(e,t,n,s){return r(this,void 0,void 0,function*(){return i(t.documentHighlightProvider,"Must have the documentHighlight capability"),(yield e.documentHighlight(o.default.editorToTextDocumentPositionParams(n,s))).map(e=>o.default.lsRangeToAtomRange(e.range))})}}},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),o=n(10);class DatatipAdapter{static canAdapt(e){return!0===e.hoverProvider}getDatatip(e,t,n){return r(this,void 0,void 0,function*(){const r=i.default.editorToTextDocumentPositionParams(t,n),s=yield e.hover(r);return null==s||DatatipAdapter.isEmptyHover(s)?null:{range:null==s.range?o.getWordAtPosition(t,n):i.default.lsRangeToAtomRange(s.range),markedStrings:(Array.isArray(s.contents)?s.contents:[s.contents]).map(e=>DatatipAdapter.convertMarkedString(t,e))}})}static isEmptyHover(e){return null==e.contents||"string"==typeof e.contents&&0===e.contents.length||Array.isArray(e.contents)&&(0===e.contents.length||""===e.contents[0])}static convertMarkedString(e,t){return"string"==typeof t?{type:"markdown",value:t}:t.kind?{type:"markdown",value:t.value}:t.language?{type:"snippet",grammar:atom.grammars.grammarForScopeName(`source.${t.language}`)||e.getGrammar(),value:t.value}:{type:"markdown",value:t.toString()}}}t.default=DatatipAdapter},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),o=n(10),s=n(1);class DefinitionAdapter{static canAdapt(e){return!0===e.definitionProvider}getDefinition(e,t,n,s,a){return r(this,void 0,void 0,function*(){const r=i.default.editorToTextDocumentPositionParams(s,a),c=DefinitionAdapter.normalizeLocations(yield e.gotoDefinition(r));if(null==c||0===c.length)return null;let u;if(t.documentHighlightProvider){const t=yield e.documentHighlight(r);null!=t&&t.length>0&&(u=t.map(e=>i.default.lsRangeToAtomRange(e.range)))}return{queryRange:u||[o.getWordAtPosition(s,a)],definitions:DefinitionAdapter.convertLocationsToDefinitions(c,n)}})}static normalizeLocations(e){return null==e?null:(Array.isArray(e)?e:[e]).filter(e=>null!=e.range.start)}static convertLocationsToDefinitions(e,t){return e.map(e=>({path:i.default.uriToPath(e.uri),position:i.default.positionToPoint(e.range.start),range:s.Range.fromObject(i.default.lsRangeToAtomRange(e.range)),language:t}))}}t.default=DefinitionAdapter},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),o=n(7),s=n(22),a=n(1),c=n(10);t.default=class DocumentSyncAdapter{constructor(e,t,n,r){this._connection=e,this._editorSelector=t,this._reportBusyWhile=r,this._disposable=new a.CompositeDisposable,this._editors=new WeakMap,this._versions=new Map,this._documentSync="object"==typeof n?n:{change:n||o.TextDocumentSyncKind.Full},this._disposable.add(atom.textEditors.observe(this.observeTextEditor.bind(this)))}static canAdapt(e){return this.canAdaptV2(e)||this.canAdaptV3(e)}static canAdaptV2(e){return e.textDocumentSync===o.TextDocumentSyncKind.Incremental||e.textDocumentSync===o.TextDocumentSyncKind.Full}static canAdaptV3(e){const t=e.textDocumentSync;return null!==t&&"object"==typeof t&&(t.change===o.TextDocumentSyncKind.Incremental||t.change===o.TextDocumentSyncKind.Full)}dispose(){this._disposable.dispose()}observeTextEditor(e){const t=e.observeGrammar(t=>this._handleGrammarChange(e));this._disposable.add(e.onDidDestroy(()=>{this._disposable.remove(t),t.dispose()})),this._disposable.add(t),!this._editors.has(e)&&this._editorSelector(e)&&this._handleNewEditor(e)}_handleGrammarChange(e){const t=this._editors.get(e);null==t||this._editorSelector(e)?null==t&&this._editorSelector(e)&&this._handleNewEditor(e):(this._editors.delete(e),this._disposable.remove(t),t.didClose(),t.dispose())}_handleNewEditor(e){const t=new TextEditorSyncAdapter(e,this._connection,this._documentSync,this._versions,this._reportBusyWhile);this._editors.set(e,t),this._disposable.add(t),this._disposable.add(e.onDidDestroy(()=>{const t=this._editors.get(e);t&&(this._editors.delete(e),this._disposable.remove(t),t.dispose())}))}getEditorSyncAdapter(e){return this._editors.get(e)}};class TextEditorSyncAdapter{constructor(e,t,n,r,i){this._editor=e,this._connection=t,this._documentSync=n,this._versions=r,this._reportBusyWhile=i,this._disposable=new a.CompositeDisposable,this._fakeDidChangeWatchedFiles=null==atom.project.onDidChangeFiles;const o=this.setupChangeTracking(n);null!=o&&this._disposable.add(o),n.willSave&&this._disposable.add(e.getBuffer().onWillSave(this.willSave.bind(this))),n.willSaveWaitUntil&&this._disposable.add(e.getBuffer().onWillSave(this.willSaveWaitUntil.bind(this))),!1!==n.openClose&&this._disposable.add(e.onDidDestroy(this.didClose.bind(this))),this._disposable.add(e.onDidSave(this.didSave.bind(this)),e.onDidChangePath(this.didRename.bind(this))),this._currentUri=this.getEditorUri(),!1!==n.openClose&&this.didOpen()}setupChangeTracking(e){switch(e.change){case o.TextDocumentSyncKind.Full:return this._editor.onDidChange(this.sendFullChanges.bind(this));case o.TextDocumentSyncKind.Incremental:return this._editor.getBuffer().onDidChangeText(this.sendIncrementalChanges.bind(this))}return null}dispose(){this._disposable.dispose()}getLanguageId(){return this._editor.getGrammar().name}getVersionedTextDocumentIdentifier(){return{uri:this.getEditorUri(),version:this._getVersion(this._editor.getPath()||"")}}sendFullChanges(){this._isPrimaryAdapter()&&(this._bumpVersion(),this._connection.didChangeTextDocument({textDocument:this.getVersionedTextDocumentIdentifier(),contentChanges:[{text:this._editor.getText()}]}))}sendIncrementalChanges(e){if(e.changes.length>0){if(!this._isPrimaryAdapter())return;this._bumpVersion(),this._connection.didChangeTextDocument({textDocument:this.getVersionedTextDocumentIdentifier(),contentChanges:e.changes.map(TextEditorSyncAdapter.textEditToContentChange).reverse()})}}static textEditToContentChange(e){return{range:i.default.atomRangeToLSRange(e.oldRange),rangeLength:e.oldText.length,text:e.newText}}_isPrimaryAdapter(){return Math.min(...atom.workspace.getTextEditors().filter(e=>e.getBuffer()===this._editor.getBuffer()).map(e=>e.id))===this._editor.id}_bumpVersion(){const e=this._editor.getPath();null!=e&&this._versions.set(e,this._getVersion(e)+1)}didOpen(){const e=this._editor.getPath();null!=e&&this._isPrimaryAdapter()&&this._connection.didOpenTextDocument({textDocument:{uri:this.getEditorUri(),languageId:this.getLanguageId().toLowerCase(),version:this._getVersion(e),text:this._editor.getText()}})}_getVersion(e){return this._versions.get(e)||1}didClose(){if(null==this._editor.getPath())return;atom.workspace.getTextEditors().find(e=>e.getBuffer()===this._editor.getBuffer())||this._connection.didCloseTextDocument({textDocument:{uri:this.getEditorUri()}})}willSave(){if(!this._isPrimaryAdapter())return;const e=this.getEditorUri();this._connection.willSaveTextDocument({textDocument:{uri:e},reason:o.TextDocumentSaveReason.Manual})}willSaveWaitUntil(){return r(this,void 0,void 0,function*(){if(!this._isPrimaryAdapter())return Promise.resolve();const e=this._editor.getBuffer(),t=this.getEditorUri(),n=this._editor.getLongTitle(),r=c.promiseWithTimeout(2500,this._connection.willSaveWaitUntilTextDocument({textDocument:{uri:t},reason:o.TextDocumentSaveReason.Manual})).then(t=>{const n=this._editor.getCursorBufferPosition();s.default.applyEdits(e,i.default.convertLsTextEdits(t)),this._editor.setCursorBufferPosition(n)}).catch(e=>{atom.notifications.addError("On-save action failed",{description:`Failed to apply edits to ${n}`,detail:e.message})});return this._reportBusyWhile(`Applying on-save edits for ${n}`,()=>r)||r})}didSave(){if(!this._isPrimaryAdapter())return;const e=this.getEditorUri(),t={textDocument:{uri:e,version:this._getVersion(e)}};this._documentSync.save&&this._documentSync.save.includeText&&(t.text=this._editor.getText()),this._connection.didSaveTextDocument(t),this._fakeDidChangeWatchedFiles&&this._connection.didChangeWatchedFiles({changes:[{uri:e,type:o.FileChangeType.Changed}]})}didRename(){if(!this._isPrimaryAdapter())return;const e=this._currentUri;this._currentUri=this.getEditorUri(),e&&(!1!==this._documentSync.openClose&&this._connection.didCloseTextDocument({textDocument:{uri:e}}),this._fakeDidChangeWatchedFiles&&this._connection.didChangeWatchedFiles({changes:[{uri:e,type:o.FileChangeType.Deleted},{uri:this._currentUri,type:o.FileChangeType.Created}]}),!1!==this._documentSync.openClose&&this.didOpen())}getEditorUri(){return i.default.pathToUri(this._editor.getPath()||"")}}t.TextEditorSyncAdapter=TextEditorSyncAdapter},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);class FindReferencesAdapter{static canAdapt(e){return!0===e.referencesProvider}getReferences(e,t,n,i){return r(this,void 0,void 0,function*(){const r=yield e.findReferences(FindReferencesAdapter.createReferenceParams(t,n));if(null==r)return null;const o=r.map(FindReferencesAdapter.locationToReference);return{type:"data",baseUri:i||"",referencedSymbolName:FindReferencesAdapter.getReferencedSymbolName(t,n,o),references:o}})}static createReferenceParams(e,t){return{textDocument:i.default.editorToTextDocumentIdentifier(e),position:i.default.pointToPosition(t),context:{includeDeclaration:!0}}}static locationToReference(e){return{uri:i.default.uriToPath(e.uri),name:null,range:i.default.lsRangeToAtomRange(e.range)}}static getReferencedSymbolName(e,t,n){if(0===n.length)return"";const r=n.find(e=>e.range.containsPoint(t))||n[0];return e.getBuffer().getTextInRange(r.range)}}t.default=FindReferencesAdapter},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(7);t.default=class LoggingConsoleAdapter{constructor(e){this._consoles=new Set,e.onLogMessage(this.logMessage.bind(this))}dispose(){this.detachAll()}attach(e){this._consoles.add(e)}detachAll(){this._consoles.clear()}logMessage(e){switch(e.type){case r.MessageType.Error:return void this._consoles.forEach(t=>t.error(e.message));case r.MessageType.Warning:return void this._consoles.forEach(t=>t.warn(e.message));case r.MessageType.Info:return void this._consoles.forEach(t=>t.info(e.message));case r.MessageType.Log:return void this._consoles.forEach(t=>t.log(e.message))}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(7);class NotificationsAdapter{static attach(e,t,n){e.onShowMessage(e=>NotificationsAdapter.onShowMessage(e,t,n)),e.onShowMessageRequest(e=>NotificationsAdapter.onShowMessageRequest(e,t,n))}static onShowMessageRequest(e,t,n){return new Promise((r,o)=>{const s={dismissable:!0,detail:`${t} ${n}`};e.actions&&(s.buttons=e.actions.map(e=>({text:e.title,onDidClick:()=>{r(e),null!=a&&a.dismiss()}})));const a=i(e.type,e.message,s);null!=a&&a.onDidDismiss(()=>{r(null)})})}static onShowMessage(e,t,n){i(e.type,e.message,{dismissable:!0,detail:`${t} ${n}`})}static actionItemToNotificationButton(e){return{text:e.title}}}function i(e,t,n){if(atom.notifications.getNotifications().some(function(i){const o=i.isDismissed&&i.isDismissed(),s=i.getOptions&&i.getOptions()||{};return!o&&i.getType()===function(e){switch(e){case r.MessageType.Error:return"error";case r.MessageType.Warning:return"warning";default:return"info"}}(e)&&i.getMessage()===t&&s.detail===n.detail}))return null;switch(e){case r.MessageType.Error:return atom.notifications.addError(t,n);case r.MessageType.Warning:return atom.notifications.addWarning(t,n);case r.MessageType.Log:return null;case r.MessageType.Info:default:return atom.notifications.addInfo(t,n)}}t.default=NotificationsAdapter},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),o=n(10),s=n(7),a=n(1);class OutlineViewAdapter{constructor(){this._cancellationTokens=new WeakMap}static canAdapt(e){return!0===e.documentSymbolProvider}getOutline(e,t){return r(this,void 0,void 0,function*(){const n=yield o.doWithCancellationToken(e,this._cancellationTokens,n=>e.documentSymbol({textDocument:i.default.editorToTextDocumentIdentifier(t)},n));return 0===n.length?{outlineTrees:[]}:void 0!==n[0].selectionRange?{outlineTrees:OutlineViewAdapter.createHierarchicalOutlineTrees(n)}:{outlineTrees:OutlineViewAdapter.createOutlineTrees(n)}})}static createHierarchicalOutlineTrees(e){return e.sort((e,t)=>e.range.start.line!==t.range.start.line?e.range.start.line-t.range.start.line:e.range.start.character!==t.range.start.character?e.range.start.character-t.range.start.character:e.range.end.line!==t.range.end.line?e.range.end.line-t.range.end.line:e.range.end.character-t.range.end.character),e.map(e=>{const t=OutlineViewAdapter.hierarchicalSymbolToOutline(e);return null!=e.children&&(t.children=OutlineViewAdapter.createHierarchicalOutlineTrees(e.children)),t})}static createOutlineTrees(e){e.sort((e,t)=>e.location.range.start.line===t.location.range.start.line?e.location.range.start.character-t.location.range.start.character:e.location.range.start.line-t.location.range.start.line);const t=e.filter(e=>e.name).map(e=>({containerName:e.containerName,outline:OutlineViewAdapter.symbolToOutline(e)})),n=t.reduce((e,t)=>{const n=t.outline.representativeName;if(null!=n){const r=e.get(n);null==r?e.set(n,[t.outline]):r.push(t.outline)}return e},new Map),r=[];for(const e of t){const t=e.containerName,i=e.outline;if(null==t||""===t)r.push(e.outline);else{const e=n.get(t);let o=OutlineViewAdapter._getClosestParent(e,i);null==o?(o={plainText:t,representativeName:t,startPosition:new a.Point(0,0),children:[i]},r.push(o),null==e?n.set(t,[o]):e.push(o)):o.children.push(i)}}return r}static _getClosestParent(e,t){if(null==e||0===e.length)return null;let n;for(const r of e)r!==t&&r.startPosition.isLessThanOrEqual(t.startPosition)&&(void 0===r.endPosition||t.endPosition&&r.endPosition.isGreaterThanOrEqual(t.endPosition))&&(void 0===n||n.startPosition.isLessThanOrEqual(r.startPosition)||null!=n.endPosition&&r.endPosition&&n.endPosition.isGreaterThanOrEqual(r.endPosition))&&(n=r);return n||null}static hierarchicalSymbolToOutline(e){const t=OutlineViewAdapter.symbolKindToEntityKind(e.kind);return{tokenizedText:[{kind:OutlineViewAdapter.symbolKindToTokenKind(e.kind),value:e.name}],icon:null!=t?t:void 0,representativeName:e.name,startPosition:i.default.positionToPoint(e.selectionRange.start),endPosition:i.default.positionToPoint(e.selectionRange.end),children:[]}}static symbolToOutline(e){const t=OutlineViewAdapter.symbolKindToEntityKind(e.kind);return{tokenizedText:[{kind:OutlineViewAdapter.symbolKindToTokenKind(e.kind),value:e.name}],icon:null!=t?t:void 0,representativeName:e.name,startPosition:i.default.positionToPoint(e.location.range.start),endPosition:i.default.positionToPoint(e.location.range.end),children:[]}}static symbolKindToEntityKind(e){switch(e){case s.SymbolKind.Array:return"type-array";case s.SymbolKind.Boolean:return"type-boolean";case s.SymbolKind.Class:return"type-class";case s.SymbolKind.Constant:return"type-constant";case s.SymbolKind.Constructor:return"type-constructor";case s.SymbolKind.Enum:return"type-enum";case s.SymbolKind.Field:return"type-field";case s.SymbolKind.File:return"type-file";case s.SymbolKind.Function:return"type-function";case s.SymbolKind.Interface:return"type-interface";case s.SymbolKind.Method:return"type-method";case s.SymbolKind.Module:return"type-module";case s.SymbolKind.Namespace:return"type-namespace";case s.SymbolKind.Number:return"type-number";case s.SymbolKind.Package:return"type-package";case s.SymbolKind.Property:return"type-property";case s.SymbolKind.String:return"type-string";case s.SymbolKind.Variable:return"type-variable";case s.SymbolKind.Struct:return"type-class";case s.SymbolKind.EnumMember:return"type-constant";default:return null}}static symbolKindToTokenKind(e){switch(e){case s.SymbolKind.Class:return"type";case s.SymbolKind.Constructor:return"constructor";case s.SymbolKind.Method:case s.SymbolKind.Function:return"method";case s.SymbolKind.String:return"string";default:return"plain"}}}t.default=OutlineViewAdapter},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(9),i=n(5),o=n(1);t.default=class SignatureHelpAdapter{constructor(e,t){this._disposables=new o.CompositeDisposable,this._connection=e.connection,this._capabilities=e.capabilities,this._grammarScopes=t}static canAdapt(e){return null!=e.signatureHelpProvider}dispose(){this._disposables.dispose()}attach(e){const{signatureHelpProvider:t}=this._capabilities;let n;r(null!=t),t&&Array.isArray(t.triggerCharacters)&&(n=new Set(t.triggerCharacters)),this._disposables.add(e({priority:1,grammarScopes:this._grammarScopes,triggerCharacters:n,getSignatureHelp:this.getSignatureHelp.bind(this)}))}getSignatureHelp(e,t){return this._connection.signatureHelp(i.default.editorToTextDocumentPositionParams(e,t))}}},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),o=n(4),s=n(1);t.ServerManager=class ServerManager{constructor(e,t,n,r,i,o){this._startServer=e,this._logger=t,this._startForEditor=n,this._changeWatchedFileFilter=r,this._reportBusyWhile=i,this._languageServerName=o,this._activeServers=[],this._startingServerPromises=new Map,this._restartCounterPerProject=new Map,this._stoppingServers=[],this._disposable=new s.CompositeDisposable,this._editorToServer=new Map,this._normalizedProjectPaths=[],this._isStarted=!1,this.updateNormalizedProjectPaths()}startListening(){this._isStarted||(this._disposable=new s.CompositeDisposable,this._disposable.add(atom.textEditors.observe(this.observeTextEditors.bind(this))),this._disposable.add(atom.project.onDidChangePaths(this.projectPathsChanged.bind(this))),atom.project.onDidChangeFiles&&this._disposable.add(atom.project.onDidChangeFiles(this.projectFilesChanged.bind(this))))}stopListening(){this._isStarted&&(this._disposable.dispose(),this._isStarted=!1)}observeTextEditors(e){const t=e.observeGrammar(t=>this._handleGrammarChange(e));this._disposable.add(e.onDidDestroy(()=>t.dispose())),this._handleTextEditor(e)}_handleTextEditor(e){return r(this,void 0,void 0,function*(){if(!this._editorToServer.has(e)){const t=yield this.getServer(e,{shouldStart:!0});null!=t&&(this._editorToServer.set(e,t),this._disposable.add(e.onDidDestroy(()=>{this._editorToServer.delete(e),this.stopUnusedServers()})))}})}_handleGrammarChange(e){this._startForEditor(e)?this._handleTextEditor(e):this._editorToServer.get(e)&&(this._editorToServer.delete(e),this.stopUnusedServers())}getActiveServers(){return this._activeServers.slice()}getServer(e,{shouldStart:t}={shouldStart:!1}){return r(this,void 0,void 0,function*(){const n=this.determineProjectPath(e);if(null==n)return null;const r=this._activeServers.find(e=>n===e.projectPath);if(r)return r;const i=this._startingServerPromises.get(n);return i||(t&&this._startForEditor(e)?yield this.startServer(n):null)})}startServer(e){return r(this,void 0,void 0,function*(){this._logger.debug(`Server starting "${e}"`);const t=this._startServer(e);this._startingServerPromises.set(e,t);try{const n=yield t;return this._activeServers.push(n),this._startingServerPromises.delete(e),this._logger.debug(`Server started "${e}" (pid ${n.process.pid})`),n}catch(t){throw this._startingServerPromises.delete(e),t}})}stopUnusedServers(){return r(this,void 0,void 0,function*(){const e=new Set(this._editorToServer.values()),t=this._activeServers.filter(t=>!e.has(t));t.length>0&&(this._logger.debug(`Stopping ${t.length} unused servers`),yield Promise.all(t.map(e=>this.stopServer(e))))})}stopAllServers(){return r(this,void 0,void 0,function*(){for(const[e,t]of this._restartCounterPerProject)clearTimeout(t.timerId),this._restartCounterPerProject.delete(e);yield Promise.all(this._activeServers.map(e=>this.stopServer(e)))})}restartAllServers(){return r(this,void 0,void 0,function*(){this.stopListening(),yield this.stopAllServers(),this._editorToServer=new Map,this.startListening()})}hasServerReachedRestartLimit(e){let t=this._restartCounterPerProject.get(e.projectPath);return t||(t={restarts:0,timerId:setTimeout(()=>{this._restartCounterPerProject.delete(e.projectPath)},18e4)},this._restartCounterPerProject.set(e.projectPath,t)),++t.restarts>5}stopServer(e){return r(this,void 0,void 0,function*(){yield this._reportBusyWhile(`Stopping ${this._languageServerName} for ${o.basename(e.projectPath)}`,()=>r(this,void 0,void 0,function*(){this._logger.debug(`Server stopping "${e.projectPath}"`),this._activeServers.splice(this._activeServers.indexOf(e),1),this._stoppingServers.push(e),e.disposable.dispose(),e.connection.isConnected&&(yield e.connection.shutdown());for(const[t,n]of this._editorToServer)n===e&&this._editorToServer.delete(t);this.exitServer(e),this._stoppingServers.splice(this._stoppingServers.indexOf(e),1)}))})}exitServer(e){const t=e.process.pid;try{e.connection.isConnected&&(e.connection.exit(),e.connection.dispose())}finally{e.process.kill()}this._logger.debug(`Server stopped "${e.projectPath}" (pid ${t})`)}terminate(){this._stoppingServers.forEach(e=>{this._logger.debug(`Server terminating "${e.projectPath}"`),this.exitServer(e)})}determineProjectPath(e){const t=e.getPath();return null==t?null:this._normalizedProjectPaths.find(e=>t.startsWith(e))||null}updateNormalizedProjectPaths(){this._normalizedProjectPaths=atom.project.getDirectories().map(e=>this.normalizePath(e.getPath()))}normalizePath(e){return e.endsWith(o.sep)?e:o.join(e,o.sep)}projectPathsChanged(e){return r(this,void 0,void 0,function*(){const t=new Set(e.map(this.normalizePath)),n=this._activeServers.filter(e=>!t.has(e.projectPath));yield Promise.all(n.map(e=>this.stopServer(e))),this.updateNormalizedProjectPaths()})}projectFilesChanged(e){if(0!==this._activeServers.length)for(const t of this._activeServers){const n=[];for(const r of e)r.path.startsWith(t.projectPath)&&this._changeWatchedFileFilter(r.path)&&n.push(i.default.atomFileEventToLSFileEvents(r)[0]),"renamed"===r.action&&r.oldPath.startsWith(t.projectPath)&&this._changeWatchedFileFilter(r.oldPath)&&n.push(i.default.atomFileEventToLSFileEvents(r)[1]);n.length>0&&t.connection.didChangeWatchedFiles({changes:n})}}}},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(8);t.default=function(e,t,n,o){return r(this,void 0,void 0,function*(){const s=new Request(e,{headers:new Headers({"Content-Type":"application/octet-stream"})}),a=yield fetch(s);if(!a.ok)throw Error(`Unable to download, server returned ${a.status} ${a.statusText}`);const c=a.body;if(null==c)throw Error("No response body");const u=o||parseInt(a.headers.get("Content-Length")||"0",10),l=c.getReader(),d=i.createWriteStream(t);yield function(e,t,n,i){return r(this,void 0,void 0,function*(){let r=0;for(;;){const o=yield t.read();if(o.done)return void(null!=i&&i(e,100));const s=o.value;if(null==s)throw Error("Empty chunk received during download");if(n.write(Buffer.from(s)),null!=i){r+=s.byteLength;const t=0===e?void 0:Math.floor(r/e*100);i(r,t)}}})}(u,l,d,n),d.end()})}},function(e,t){e.exports=require("module")},function(e,t,n){(function(){var t,r,i,o,s,a,c,u,l=[].slice;u=n(73),i={cmd:"⌘",ctrl:"⌃",alt:"⌥",option:"⌥",shift:"⇧",enter:"⏎",left:"←",right:"→",up:"↑",down:"↓"},o={cmd:"Cmd",ctrl:"Ctrl",alt:"Alt",option:"Alt",shift:"Shift",enter:"Enter",left:"Left",right:"Right",up:"Up",down:"Down"},a={"~":"`",_:"-","+":"=","|":"\\","{":"[","}":"]",":":";",'"':"'","<":",",">":".","?":"/"},c=function(e){var t,n,r,i,o;if(r=0,n=[],null==e)return n;for(t=i=0,o=e.length;i<o;t=++i)"."!==e[t]||0!==t&&"\\"===e[t-1]||(n.push(e.substring(r,t)),r=t+1);return n.push(e.substr(r,e.length)),n},r=function(e){return u.isObject(e)&&!u.isArray(e)},s={adviseBefore:function(e,t,n){var r;return r=e[t],e[t]=function(){var e;if(e=1<=arguments.length?l.call(arguments,0):[],!1!==n.apply(this,e))return r.apply(this,e)}},camelize:function(e){return e?e.replace(/[_-]+(\w)/g,function(e){return e[1].toUpperCase()}):""},capitalize:function(e){return e?"github"===e.toLowerCase()?"GitHub":e[0].toUpperCase()+e.slice(1):""},compactObject:function(e){var t,n,r;for(t in n={},e)null!=(r=e[t])&&(n[t]=r);return n},dasherize:function(e){return e?(e=e[0].toLowerCase()+e.slice(1)).replace(/([A-Z])|(_)/g,function(e,t){return t?"-"+t.toLowerCase():"-"}):""},deepClone:function(e){return u.isArray(e)?e.map(function(e){return s.deepClone(e)}):u.isObject(e)&&!u.isFunction(e)?s.mapObject(e,function(e,t){return[e,s.deepClone(t)]}):e},deepExtend:function(e){var t,n,i,o,a,c,u;for(o=e,t=0;++t<arguments.length;)if(i=arguments[t],r(o)&&r(i))for(a=0,c=(u=Object.keys(i)).length;a<c;a++)o[n=u[a]]=s.deepExtend(o[n],i[n]);else o=s.deepClone(i);return o},deepContains:function(e,t){var n,r,i;if(null==e)return!1;for(r=0,i=e.length;r<i;r++)if(n=e[r],u.isEqual(n,t))return!0;return!1},endsWith:function(e,t){return null==t&&(t=""),!!e&&-1!==e.indexOf(t,e.length-t.length)},escapeAttribute:function(e){return e?e.replace(/"/g,"&quot;").replace(/\n/g,"").replace(/\\/g,"-"):""},escapeRegExp:function(e){return e?e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"):""},humanizeEventName:function(e,t){var n,r,i,o;return r=(o=e.split(":"))[0],null==(n=o[1])?s.undasherize(r):(i=s.undasherize(r),null==t&&(t=s.undasherize(n)),i+": "+t)},humanizeKey:function(e,t){var n;return null==t&&(t=process.platform),e?(n="darwin"===t?i:o)[e]?n[e]:1===e.length&&null!=a[e]?[n.shift,a[e]]:1===e.length&&e===e.toUpperCase()&&e.toUpperCase()!==e.toLowerCase()?[n.shift,e.toUpperCase()]:1===e.length||/f[0-9]{1,2}/.test(e)?e.toUpperCase():"darwin"===t?e:s.capitalize(e):e},humanizeKeystroke:function(e,t){var n,r,i,o,a,c,l,d,h,f;if(null==t&&(t=process.platform),!e)return e;for(n=[],l=0,h=(a=e.split(" ")).length;l<h;l++){for(o=[],r=d=0,f=(c=(e=a[l]).split("-")).length;d<f;r=++d)""===(i=c[r])&&""===c[r-1]&&(i="-"),i&&o.push(s.humanizeKey(i,t));o=u.uniq(u.flatten(o)),o="darwin"===t?o.join(""):o.join("+"),n.push(o)}return n.join(" ")},isSubset:function(e,t){return u.every(e,function(e){return u.include(t,e)})},losslessInvert:function(e){var t,n,r;for(n in t={},e)null==t[r=e[n]]&&(t[r]=[]),t[r].push(n);return t},mapObject:function(e,t){var n,r,i,o,s,a,c;for(r={},o=0,s=(a=Object.keys(e)).length;o<s;o++)n=(c=t(n=a[o],e[n]))[0],i=c[1],r[n]=i;return r},multiplyString:function(e,t){var n,r;for(n="",r=0;r<t;)n+=e,r++;return n},pluralize:function(e,t,n){return null==e&&(e=0),null==n&&(n=t+"s"),1===e?e+" "+t:e+" "+n},remove:function(e,t){var n;return(n=e.indexOf(t))>=0&&e.splice(n,1),e},setValueForKeyPath:function(e,t,n){var r,i;for(i=c(t);i.length>1;)null==e[r=i.shift()]&&(e[r]={}),e=e[r];return null!=n?e[i.shift()]=n:delete e[i.shift()]},hasKeyPath:function(e,t){var n,r,i,o;for(i=0,o=(r=c(t)).length;i<o;i++){if(n=r[i],!e.hasOwnProperty(n))return!1;e=e[n]}return!0},spliceWithArray:function(e,t,n,r,i){var o,s,a,c;if(null==i&&(i=1e5),r.length<i)return e.splice.apply(e,[t,n].concat(l.call(r)));for(e.splice(t,n),c=[],o=s=0,a=r.length;i>0?s<=a:s>=a;o=s+=i)c.push(e.splice.apply(e,[t+o,0].concat(l.call(r.slice(o,o+i)))));return c},sum:function(e){var t,n,r;for(t=0,n=0,r=e.length;n<r;n++)t+=e[n];return t},uncamelcase:function(e){var t;return e?(t=e.replace(/([A-Z])|_+/g,function(e,t){return null==t&&(t="")," "+t}),s.capitalize(t.trim())):""},undasherize:function(e){return e?e.split("-").map(s.capitalize).join(" "):""},underscore:function(e){return e?(e=e[0].toLowerCase()+e.slice(1)).replace(/([A-Z])|-+/g,function(e,t){return null==t&&(t=""),"_"+t.toLowerCase()}):""},valueForKeyPath:function(e,t){var n,r,i;for(r=0,i=(n=c(t)).length;r<i;r++)if(null==(e=e[n[r]]))return;return e},isEqual:function(e,n,r,i){return u.isArray(r)&&u.isArray(i)?t(e,n,r,i):t(e,n)},isEqualForProperties:function(){var e,t,n,r,i,o;for(e=arguments[0],t=arguments[1],i=0,o=(n=3<=arguments.length?l.call(arguments,2):[]).length;i<o;i++)if(r=n[i],!u.isEqual(e[r],t[r]))return!1;return!0}},t=function(e,n,r,i){var o,s,a,c,l,d,h,f,p,g,m,v,y,w;if(null==r&&(r=[]),null==i&&(i=[]),e===n)return u.isEqual(e,n);if(u.isFunction(e)||u.isFunction(n))return u.isEqual(e,n);for(v=r.length;v--;)if(r[v]===e)return i[v]===n;if(r.push(e),i.push(n),p=!1,u.isFunction(null!=e?e.isEqual:void 0))p=e.isEqual(n,r,i);else if(u.isFunction(null!=n?n.isEqual:void 0))p=n.isEqual(e,i,r);else if(u.isArray(e)&&u.isArray(n)&&e.length===n.length){for(p=!0,g=y=0,w=e.length;y<w;g=++y)if(a=e[g],!t(a,n[g],r,i)){p=!1;break}}else if(u.isRegExp(e)&&u.isRegExp(n))p=u.isEqual(e,n);else if(u.isElement(e)&&u.isElement(n))p=e===n;else if(u.isObject(e)&&u.isObject(n))if(o=e.constructor,d=n.constructor,s=u.isFunction(o)&&o instanceof o,h=u.isFunction(d)&&d instanceof d,o===d||s&&h){for(m in c=0,p=!0,e)if(l=e[m],u.has(e,m)&&(c++,!u.has(n,m)||!t(l,n[m],r,i))){p=!1;break}if(p){for(m in f=0,n)n[m],u.has(n,m)&&f++;p=c===f}}else p=!1;else p=u.isEqual(e,n);return r.pop(),i.pop(),p},e.exports=u.extend({},u,s)}).call(this)},function(e,t,n){(function(e){var n;!function(){var r="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},i=r._,o=Array.prototype,s=Object.prototype,a="undefined"!=typeof Symbol?Symbol.prototype:null,c=o.push,u=o.slice,l=s.toString,d=s.hasOwnProperty,h=Array.isArray,f=Object.keys,p=Object.create,g=function(){},m=function(e){return e instanceof m?e:this instanceof m?void(this._wrapped=e):new m(e)};t.nodeType?r._=m:(!e.nodeType&&e.exports&&(t=e.exports=m),t._=m),m.VERSION="1.9.1";var v,y=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return function(){return e.apply(t,arguments)}},w=function(e,t,n){return m.iteratee!==v?m.iteratee(e,t):null==e?m.identity:m.isFunction(e)?y(e,t,n):m.isObject(e)&&!m.isArray(e)?m.matcher(e):m.property(e)};m.iteratee=v=function(e,t){return w(e,t,1/0)};var b=function(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=r,e.apply(this,o)}},_=function(e){if(!m.isObject(e))return{};if(p)return p(e);g.prototype=e;var t=new g;return g.prototype=null,t},S=function(e){return function(t){return null==t?void 0:t[e]}},C=function(e,t){return null!=e&&d.call(e,t)},T=function(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0},R=Math.pow(2,53)-1,k=S("length"),E=function(e){var t=k(e);return"number"==typeof t&&t>=0&&t<=R};m.each=m.forEach=function(e,t,n){var r,i;if(t=y(t,n),E(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=m.keys(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e},m.map=m.collect=function(e,t,n){t=w(t,n);for(var r=!E(e)&&m.keys(e),i=(r||e).length,o=Array(i),s=0;s<i;s++){var a=r?r[s]:s;o[s]=t(e[a],a,e)}return o};var x=function(e){return function(t,n,r,i){var o=arguments.length>=3;return function(t,n,r,i){var o=!E(t)&&m.keys(t),s=(o||t).length,a=e>0?0:s-1;for(i||(r=t[o?o[a]:a],a+=e);a>=0&&a<s;a+=e){var c=o?o[a]:a;r=n(r,t[c],c,t)}return r}(t,y(n,i,4),r,o)}};m.reduce=m.foldl=m.inject=x(1),m.reduceRight=m.foldr=x(-1),m.find=m.detect=function(e,t,n){var r=(E(e)?m.findIndex:m.findKey)(e,t,n);if(void 0!==r&&-1!==r)return e[r]},m.filter=m.select=function(e,t,n){var r=[];return t=w(t,n),m.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},m.reject=function(e,t,n){return m.filter(e,m.negate(w(t)),n)},m.every=m.all=function(e,t,n){t=w(t,n);for(var r=!E(e)&&m.keys(e),i=(r||e).length,o=0;o<i;o++){var s=r?r[o]:o;if(!t(e[s],s,e))return!1}return!0},m.some=m.any=function(e,t,n){t=w(t,n);for(var r=!E(e)&&m.keys(e),i=(r||e).length,o=0;o<i;o++){var s=r?r[o]:o;if(t(e[s],s,e))return!0}return!1},m.contains=m.includes=m.include=function(e,t,n,r){return E(e)||(e=m.values(e)),("number"!=typeof n||r)&&(n=0),m.indexOf(e,t,n)>=0},m.invoke=b(function(e,t,n){var r,i;return m.isFunction(t)?i=t:m.isArray(t)&&(r=t.slice(0,-1),t=t[t.length-1]),m.map(e,function(e){var o=i;if(!o){if(r&&r.length&&(e=T(e,r)),null==e)return;o=e[t]}return null==o?o:o.apply(e,n)})}),m.pluck=function(e,t){return m.map(e,m.property(t))},m.where=function(e,t){return m.filter(e,m.matcher(t))},m.findWhere=function(e,t){return m.find(e,m.matcher(t))},m.max=function(e,t,n){var r,i,o=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,c=(e=E(e)?e:m.values(e)).length;a<c;a++)null!=(r=e[a])&&r>o&&(o=r);else t=w(t,n),m.each(e,function(e,n,r){((i=t(e,n,r))>s||i===-1/0&&o===-1/0)&&(o=e,s=i)});return o},m.min=function(e,t,n){var r,i,o=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,c=(e=E(e)?e:m.values(e)).length;a<c;a++)null!=(r=e[a])&&r<o&&(o=r);else t=w(t,n),m.each(e,function(e,n,r){((i=t(e,n,r))<s||i===1/0&&o===1/0)&&(o=e,s=i)});return o},m.shuffle=function(e){return m.sample(e,1/0)},m.sample=function(e,t,n){if(null==t||n)return E(e)||(e=m.values(e)),e[m.random(e.length-1)];var r=E(e)?m.clone(e):m.values(e),i=k(r);t=Math.max(Math.min(t,i),0);for(var o=i-1,s=0;s<t;s++){var a=m.random(s,o),c=r[s];r[s]=r[a],r[a]=c}return r.slice(0,t)},m.sortBy=function(e,t,n){var r=0;return t=w(t,n),m.pluck(m.map(e,function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};var D=function(e,t){return function(n,r,i){var o=t?[[],[]]:{};return r=w(r,i),m.each(n,function(t,i){var s=r(t,i,n);e(o,t,s)}),o}};m.groupBy=D(function(e,t,n){C(e,n)?e[n].push(t):e[n]=[t]}),m.indexBy=D(function(e,t,n){e[n]=t}),m.countBy=D(function(e,t,n){C(e,n)?e[n]++:e[n]=1});var P=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;m.toArray=function(e){return e?m.isArray(e)?u.call(e):m.isString(e)?e.match(P):E(e)?m.map(e,m.identity):m.values(e):[]},m.size=function(e){return null==e?0:E(e)?e.length:m.keys(e).length},m.partition=D(function(e,t,n){e[n?0:1].push(t)},!0),m.first=m.head=m.take=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[0]:m.initial(e,e.length-t)},m.initial=function(e,t,n){return u.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},m.last=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[e.length-1]:m.rest(e,Math.max(0,e.length-t))},m.rest=m.tail=m.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},m.compact=function(e){return m.filter(e,Boolean)};var A=function(e,t,n,r){for(var i=(r=r||[]).length,o=0,s=k(e);o<s;o++){var a=e[o];if(E(a)&&(m.isArray(a)||m.isArguments(a)))if(t)for(var c=0,u=a.length;c<u;)r[i++]=a[c++];else A(a,t,n,r),i=r.length;else n||(r[i++]=a)}return r};m.flatten=function(e,t){return A(e,t,!1)},m.without=b(function(e,t){return m.difference(e,t)}),m.uniq=m.unique=function(e,t,n,r){m.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=w(n,r));for(var i=[],o=[],s=0,a=k(e);s<a;s++){var c=e[s],u=n?n(c,s,e):c;t&&!n?(s&&o===u||i.push(c),o=u):n?m.contains(o,u)||(o.push(u),i.push(c)):m.contains(i,c)||i.push(c)}return i},m.union=b(function(e){return m.uniq(A(e,!0,!0))}),m.intersection=function(e){for(var t=[],n=arguments.length,r=0,i=k(e);r<i;r++){var o=e[r];if(!m.contains(t,o)){var s;for(s=1;s<n&&m.contains(arguments[s],o);s++);s===n&&t.push(o)}}return t},m.difference=b(function(e,t){return t=A(t,!0,!0),m.filter(e,function(e){return!m.contains(t,e)})}),m.unzip=function(e){for(var t=e&&m.max(e,k).length||0,n=Array(t),r=0;r<t;r++)n[r]=m.pluck(e,r);return n},m.zip=b(m.unzip),m.object=function(e,t){for(var n={},r=0,i=k(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n};var O=function(e){return function(t,n,r){n=w(n,r);for(var i=k(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(n(t[o],o,t))return o;return-1}};m.findIndex=O(1),m.findLastIndex=O(-1),m.sortedIndex=function(e,t,n,r){for(var i=(n=w(n,r,1))(t),o=0,s=k(e);o<s;){var a=Math.floor((o+s)/2);n(e[a])<i?o=a+1:s=a}return o};var M=function(e,t,n){return function(r,i,o){var s=0,a=k(r);if("number"==typeof o)e>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return r[o=n(r,i)]===i?o:-1;if(i!=i)return(o=t(u.call(r,s,a),m.isNaN))>=0?o+s:-1;for(o=e>0?s:a-1;o>=0&&o<a;o+=e)if(r[o]===i)return o;return-1}};m.indexOf=M(1,m.findIndex,m.sortedIndex),m.lastIndexOf=M(-1,m.findLastIndex),m.range=function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;o<r;o++,e+=n)i[o]=e;return i},m.chunk=function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(u.call(e,r,r+=t));return n};var I=function(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var o=_(e.prototype),s=e.apply(o,i);return m.isObject(s)?s:o};m.bind=b(function(e,t,n){if(!m.isFunction(e))throw new TypeError("Bind must be called on a function");var r=b(function(i){return I(e,r,t,this,n.concat(i))});return r}),m.partial=b(function(e,t){var n=m.partial.placeholder,r=function(){for(var i=0,o=t.length,s=Array(o),a=0;a<o;a++)s[a]=t[a]===n?arguments[i++]:t[a];for(;i<arguments.length;)s.push(arguments[i++]);return I(e,r,this,this,s)};return r}),m.partial.placeholder=m,m.bindAll=b(function(e,t){var n=(t=A(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=m.bind(e[r],e)}}),m.memoize=function(e,t){var n=function(r){var i=n.cache,o=""+(t?t.apply(this,arguments):r);return C(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return n.cache={},n},m.delay=b(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),m.defer=m.partial(m.delay,m,1),m.throttle=function(e,t,n){var r,i,o,s,a=0;n||(n={});var c=function(){a=!1===n.leading?0:m.now(),r=null,s=e.apply(i,o),r||(i=o=null)},u=function(){var u=m.now();a||!1!==n.leading||(a=u);var l=t-(u-a);return i=this,o=arguments,l<=0||l>t?(r&&(clearTimeout(r),r=null),a=u,s=e.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(c,l)),s};return u.cancel=function(){clearTimeout(r),a=0,r=i=o=null},u},m.debounce=function(e,t,n){var r,i,o=function(t,n){r=null,n&&(i=e.apply(t,n))},s=b(function(s){if(r&&clearTimeout(r),n){var a=!r;r=setTimeout(o,t),a&&(i=e.apply(this,s))}else r=m.delay(o,t,this,s);return i});return s.cancel=function(){clearTimeout(r),r=null},s},m.wrap=function(e,t){return m.partial(t,e)},m.negate=function(e){return function(){return!e.apply(this,arguments)}},m.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},m.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},m.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},m.once=m.partial(m.before,2),m.restArguments=b;var q=!{toString:null}.propertyIsEnumerable("toString"),N=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],j=function(e,t){var n=N.length,r=e.constructor,i=m.isFunction(r)&&r.prototype||s,o="constructor";for(C(e,o)&&!m.contains(t,o)&&t.push(o);n--;)(o=N[n])in e&&e[o]!==i[o]&&!m.contains(t,o)&&t.push(o)};m.keys=function(e){if(!m.isObject(e))return[];if(f)return f(e);var t=[];for(var n in e)C(e,n)&&t.push(n);return q&&j(e,t),t},m.allKeys=function(e){if(!m.isObject(e))return[];var t=[];for(var n in e)t.push(n);return q&&j(e,t),t},m.values=function(e){for(var t=m.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},m.mapObject=function(e,t,n){t=w(t,n);for(var r=m.keys(e),i=r.length,o={},s=0;s<i;s++){var a=r[s];o[a]=t(e[a],a,e)}return o},m.pairs=function(e){for(var t=m.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},m.invert=function(e){for(var t={},n=m.keys(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},m.functions=m.methods=function(e){var t=[];for(var n in e)m.isFunction(e[n])&&t.push(n);return t.sort()};var L=function(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],s=e(o),a=s.length,c=0;c<a;c++){var u=s[c];t&&void 0!==n[u]||(n[u]=o[u])}return n}};m.extend=L(m.allKeys),m.extendOwn=m.assign=L(m.keys),m.findKey=function(e,t,n){t=w(t,n);for(var r,i=m.keys(e),o=0,s=i.length;o<s;o++)if(t(e[r=i[o]],r,e))return r};var F,$,W=function(e,t,n){return t in n};m.pick=b(function(e,t){var n={},r=t[0];if(null==e)return n;m.isFunction(r)?(t.length>1&&(r=y(r,t[1])),t=m.allKeys(e)):(r=W,t=A(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var s=t[i],a=e[s];r(a,s,e)&&(n[s]=a)}return n}),m.omit=b(function(e,t){var n,r=t[0];return m.isFunction(r)?(r=m.negate(r),t.length>1&&(n=t[1])):(t=m.map(A(t,!1,!1),String),r=function(e,n){return!m.contains(t,n)}),m.pick(e,r,n)}),m.defaults=L(m.allKeys,!0),m.create=function(e,t){var n=_(e);return t&&m.extendOwn(n,t),n},m.clone=function(e){return m.isObject(e)?m.isArray(e)?e.slice():m.extend({},e):e},m.tap=function(e,t){return t(e),e},m.isMatch=function(e,t){var n=m.keys(t),r=n.length;if(null==e)return!r;for(var i=Object(e),o=0;o<r;o++){var s=n[o];if(t[s]!==i[s]||!(s in i))return!1}return!0},F=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var i=typeof e;return("function"===i||"object"===i||"object"==typeof t)&&$(e,t,n,r)},$=function(e,t,n,r){e instanceof m&&(e=e._wrapped),t instanceof m&&(t=t._wrapped);var i=l.call(e);if(i!==l.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return a.valueOf.call(e)===a.valueOf.call(t)}var o="[object Array]"===i;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,c=t.constructor;if(s!==c&&!(m.isFunction(s)&&s instanceof s&&m.isFunction(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var u=(n=n||[]).length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),o){if((u=e.length)!==t.length)return!1;for(;u--;)if(!F(e[u],t[u],n,r))return!1}else{var d,h=m.keys(e);if(u=h.length,m.keys(t).length!==u)return!1;for(;u--;)if(d=h[u],!C(t,d)||!F(e[d],t[d],n,r))return!1}return n.pop(),r.pop(),!0},m.isEqual=function(e,t){return F(e,t)},m.isEmpty=function(e){return null==e||(E(e)&&(m.isArray(e)||m.isString(e)||m.isArguments(e))?0===e.length:0===m.keys(e).length)},m.isElement=function(e){return!(!e||1!==e.nodeType)},m.isArray=h||function(e){return"[object Array]"===l.call(e)},m.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},m.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){m["is"+e]=function(t){return l.call(t)==="[object "+e+"]"}}),m.isArguments(arguments)||(m.isArguments=function(e){return C(e,"callee")});var U=r.document&&r.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof U&&(m.isFunction=function(e){return"function"==typeof e||!1}),m.isFinite=function(e){return!m.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},m.isNaN=function(e){return m.isNumber(e)&&isNaN(e)},m.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===l.call(e)},m.isNull=function(e){return null===e},m.isUndefined=function(e){return void 0===e},m.has=function(e,t){if(!m.isArray(t))return C(e,t);for(var n=t.length,r=0;r<n;r++){var i=t[r];if(null==e||!d.call(e,i))return!1;e=e[i]}return!!n},m.noConflict=function(){return r._=i,this},m.identity=function(e){return e},m.constant=function(e){return function(){return e}},m.noop=function(){},m.property=function(e){return m.isArray(e)?function(t){return T(t,e)}:S(e)},m.propertyOf=function(e){return null==e?function(){}:function(t){return m.isArray(t)?T(e,t):e[t]}},m.matcher=m.matches=function(e){return e=m.extendOwn({},e),function(t){return m.isMatch(t,e)}},m.times=function(e,t,n){var r=Array(Math.max(0,e));t=y(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},m.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},m.now=Date.now||function(){return(new Date).getTime()};var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},V=m.invert(z),B=function(e){var t=function(t){return e[t]},n="(?:"+m.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}};m.escape=B(z),m.unescape=B(V),m.result=function(e,t,n){m.isArray(t)||(t=[t]);var r=t.length;if(!r)return m.isFunction(n)?n.call(e):n;for(var i=0;i<r;i++){var o=null==e?void 0:e[t[i]];void 0===o&&(o=n,i=r),e=m.isFunction(o)?o.call(e):o}return e};var K=0;m.uniqueId=function(e){var t=++K+"";return e?e+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,J=function(e){return"\\"+G[e]};m.template=function(e,t,n){!t&&n&&(t=n),t=m.defaults({},t,m.templateSettings);var r,i=RegExp([(t.escape||H).source,(t.interpolate||H).source,(t.evaluate||H).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(i,function(t,n,r,i,a){return s+=e.slice(o,a).replace(Q,J),o=a+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var a=function(e){return r.call(this,e,m)},c=t.variable||"obj";return a.source="function("+c+"){\n"+s+"}",a},m.chain=function(e){var t=m(e);return t._chain=!0,t};var Z=function(e,t){return e._chain?m(t).chain():t};m.mixin=function(e){return m.each(m.functions(e),function(t){var n=m[t]=e[t];m.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),Z(this,n.apply(m,e))}}),m},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];m.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],Z(this,n)}}),m.each(["concat","join","slice"],function(e){var t=o[e];m.prototype[e]=function(){return Z(this,t.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return String(this._wrapped)},void 0===(n=function(){return m}.apply(t,[]))||(e.exports=n)}()}).call(this,n(33)(e))},function(e,t,n){var r;
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
!function(){var n,i={};function o(){}function s(e){return e}function a(e){return!!e}function c(e){return!e}var u="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;function l(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function d(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=u&&(n=u.async),i.noConflict=function(){return u.async=n,i};var h=Object.prototype.toString,f=Array.isArray||function(e){return"[object Array]"===h.call(e)};function p(e){return f(e)||"number"==typeof e.length&&e.length>=0&&e.length%1==0}function g(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function m(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function v(e){return m(Array(e),function(e,t){return t})}function y(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var w=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function b(e){var t,n,r=-1;return p(e)?(t=e.length,function(){return++r<t?r:null}):(n=w(e),t=n.length,function(){return++r<t?n[r]:null})}function _(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function S(e){return function(t,n,r){return e(t,r)}}var C="function"==typeof setImmediate&&setImmediate,T=C?function(e){C(e)}:function(e){setTimeout(e,0)};function R(e){return function(t,n,r){r=d(r||o);var i=b(t=t||[]);if(e<=0)return r(null);var s=!1,a=0,c=!1;!function o(){if(s&&a<=0)return r(null);for(;a<e&&!c;){var u=i();if(null===u)return s=!0,void(a<=0&&r(null));a+=1,n(t[u],u,l(function(e){a-=1,e?(r(e),c=!0):o()}))}}()}}function k(e){return function(t,n,r){return e(i.eachOf,t,n,r)}}function E(e){return function(t,n,r,i){return e(R(n),t,r,i)}}function x(e){return function(t,n,r){return e(i.eachOfSeries,t,n,r)}}function D(e,t,n,r){r=d(r||o);var i=p(t=t||[])?[]:{};e(t,function(e,t,r){n(e,function(e,n){i[t]=n,r(e)})},function(e){r(e,i)})}function P(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n){n&&i.push({index:t,value:e}),r()})},function(){r(m(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function A(e,t,n,r){P(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function O(e,t,n){return function(r,i,o,s){function a(){s&&s(n(!1,void 0))}function c(e,r,i){if(!s)return i();o(e,function(r){s&&t(r)&&(s(n(!0,e)),s=o=!1),i()})}arguments.length>3?e(r,i,c,a):(s=o,o=i,e(r,c,a))}}function M(e,t){return t}function I(e,t,n){n=n||o;var r=p(t)?[]:{};e(t,function(e,t,n){e(_(function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)}))},function(e){n(e,r)})}function q(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(e,t){i=i.concat(t||[]),r(e)})},function(e){r(e,i)})}function N(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function r(e,t,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(e.started=!0,f(t)||(t=[t]),0===t.length&&e.idle())return i.setImmediate(function(){e.drain()});g(t,function(t){var i={data:t,callback:r||o};n?e.tasks.unshift(i):e.tasks.push(i),e.tasks.length===e.concurrency&&e.saturated()}),i.setImmediate(e.process)}function s(e,t){return function(){a-=1;var n=!1,r=arguments;g(t,function(e){g(c,function(t,r){t!==e||n||(c.splice(r,1),n=!0)}),e.callback.apply(e,r)}),e.tasks.length+a===0&&e.drain(),e.process()}}var a=0,c=[],u={tasks:[],concurrency:t,payload:n,saturated:o,empty:o,drain:o,started:!1,paused:!1,push:function(e,t){r(u,e,!1,t)},kill:function(){u.drain=o,u.tasks=[]},unshift:function(e,t){r(u,e,!0,t)},process:function(){for(;!u.paused&&a<u.concurrency&&u.tasks.length;){var t=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),n=m(t,function(e){return e.data});0===u.tasks.length&&u.empty(),a+=1,c.push(t[0]);var r=l(s(u,t));e(n,r)}},length:function(){return u.tasks.length},running:function(){return a},workersList:function(){return c},idle:function(){return u.tasks.length+a===0},pause:function(){u.paused=!0},resume:function(){if(!1!==u.paused){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;t<=e;t++)i.setImmediate(u.process)}}};return u}function j(e){return _(function(t,n){t.apply(null,n.concat([_(function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&g(n,function(t){console[e](t)}))})]))})}function L(e){return function(t,n,r){e(v(t),n,r)}}function F(e){return _(function(t,n){var r=_(function(n){var r=this,i=n.pop();return e(t,function(e,t,i){e.apply(r,n.concat([i]))},i)});return n.length?r.apply(this,n):r})}function $(e){return _(function(t){var n=t.pop();t.push(function(){var e=arguments;r?i.setImmediate(function(){n.apply(null,e)}):n.apply(null,e)});var r=!0;e.apply(this,t),r=!1})}"object"==typeof process&&"function"==typeof process.nextTick?i.nextTick=process.nextTick:i.nextTick=T,i.setImmediate=C?T:i.nextTick,i.forEach=i.each=function(e,t,n){return i.eachOf(e,S(t),n)},i.forEachSeries=i.eachSeries=function(e,t,n){return i.eachOfSeries(e,S(t),n)},i.forEachLimit=i.eachLimit=function(e,t,n,r){return R(t)(e,S(n),r)},i.forEachOf=i.eachOf=function(e,t,n){n=d(n||o);for(var r,i=b(e=e||[]),s=0;null!=(r=i());)s+=1,t(e[r],r,l(a));function a(e){s--,e?n(e):null===r&&s<=0&&n(null)}0===s&&n(null)},i.forEachOfSeries=i.eachOfSeries=function(e,t,n){n=d(n||o);var r=b(e=e||[]),s=r();!function o(){var a=!0;if(null===s)return n(null);t(e[s],s,l(function(e){if(e)n(e);else{if(null===(s=r()))return n(null);a?i.setImmediate(o):o()}})),a=!1}()},i.forEachOfLimit=i.eachOfLimit=function(e,t,n,r){R(t)(e,n,r)},i.map=k(D),i.mapSeries=x(D),i.mapLimit=E(D),i.inject=i.foldl=i.reduce=function(e,t,n,r){i.eachOfSeries(e,function(e,r,i){n(t,e,function(e,n){t=n,i(e)})},function(e){r(e,t)})},i.foldr=i.reduceRight=function(e,t,n,r){var o=m(e,s).reverse();i.reduce(o,t,n,r)},i.transform=function(e,t,n,r){3===arguments.length&&(r=n,n=t,t=f(e)?[]:{}),i.eachOf(e,function(e,r,i){n(t,e,r,i)},function(e){r(e,t)})},i.select=i.filter=k(P),i.selectLimit=i.filterLimit=E(P),i.selectSeries=i.filterSeries=x(P),i.reject=k(A),i.rejectLimit=E(A),i.rejectSeries=x(A),i.any=i.some=O(i.eachOf,a,s),i.someLimit=O(i.eachOfLimit,a,s),i.all=i.every=O(i.eachOf,c,c),i.everyLimit=O(i.eachOfLimit,c,c),i.detect=O(i.eachOf,s,M),i.detectSeries=O(i.eachOfSeries,s,M),i.detectLimit=O(i.eachOfLimit,s,M),i.sortBy=function(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}i.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,m(t.sort(r),function(e){return e.value}))})},i.auto=function(e,t,n){"function"==typeof arguments[1]&&(n=t,t=null),n=d(n||o);var r=w(e),s=r.length;if(!s)return n(null);t||(t=s);var a={},c=0,u=!1,l=[];function h(e){l.unshift(e)}function p(){s--,g(l.slice(0),function(e){e()})}h(function(){s||n(null,a)}),g(r,function(r){if(!u){for(var o,s=f(e[r])?e[r]:[e[r]],d=_(function(e,t){if(c--,t.length<=1&&(t=t[0]),e){var o={};l=function(e,t){o[t]=e},g(w(s=a),function(e){l(s[e],e)}),o[r]=t,u=!0,n(e,o)}else a[r]=t,i.setImmediate(p);var s,l}),m=s.slice(0,s.length-1),v=m.length;v--;){if(!(o=e[m[v]]))throw new Error("Has nonexistent dependency in "+m.join(", "));if(f(o)&&y(o,r)>=0)throw new Error("Has cyclic dependencies")}b()?(c++,s[s.length-1](d,a)):h(function e(){b()&&(c++,(t=y(l,e))>=0&&l.splice(t,1),s[s.length-1](d,a));var t})}function b(){return c<t&&(e=function(e,t){return e&&a.hasOwnProperty(t)},n=!0,g(m,function(t,r,i){n=e(n,t,r,i)}),n)&&!a.hasOwnProperty(r);var e,n}})},i.retry=function(e,t,n){var r=5,o=0,s=[],a={times:r,interval:o};var c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function u(e,t){function n(e,n){return function(r){e(function(e,t){r(!e||n,{err:e,result:t})},t)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;a.times;){var o=!(a.times-=1);s.push(n(a.task,o)),!o&&a.interval>0&&s.push(r(a.interval))}i.series(s,function(t,n){n=n[n.length-1],(e||a.callback)(n.err,n.result)})}return c<=2&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&function(e,t){if("number"==typeof t)e.times=parseInt(t,10)||r;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||r,e.interval=parseInt(t.interval,10)||o}}(a,e),a.callback=n,a.task=t,a.callback?u():u},i.waterfall=function(e,t){if(t=d(t||o),!f(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();!function e(n){return _(function(r,i){if(r)t.apply(null,[r].concat(i));else{var o=n.next();o?i.push(e(o)):i.push(t),$(n).apply(null,i)}})}(i.iterator(e))()},i.parallel=function(e,t){I(i.eachOf,e,t)},i.parallelLimit=function(e,t,n){I(R(t),e,n)},i.series=function(e,t){I(i.eachOfSeries,e,t)},i.iterator=function(e){return function t(n){function r(){return e.length&&e[n].apply(null,arguments),r.next()}return r.next=function(){return n<e.length-1?t(n+1):null},r}(0)},i.apply=_(function(e,t){return _(function(n){return e.apply(null,t.concat(n))})}),i.concat=k(q),i.concatSeries=x(q),i.whilst=function(e,t,n){if(n=n||o,e()){var r=_(function(i,o){i?n(i):e.apply(this,o)?t(r):n.apply(null,[null].concat(o))});t(r)}else n(null)},i.doWhilst=function(e,t,n){var r=0;return i.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},i.until=function(e,t,n){return i.whilst(function(){return!e.apply(this,arguments)},t,n)},i.doUntil=function(e,t,n){return i.doWhilst(e,function(){return!t.apply(this,arguments)},n)},i.during=function(e,t,n){n=n||o;var r=_(function(t,r){t?n(t):(r.push(i),e.apply(this,r))}),i=function(e,i){e?n(e):i?t(r):n(null)};e(i)},i.doDuring=function(e,t,n){var r=0;i.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},i.queue=function(e,t){return N(function(t,n){e(t[0],n)},t,1)},i.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}var r=i.queue(e,t);return r.push=function(e,t,s){!function(e,t,r,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");if(e.started=!0,f(t)||(t=[t]),0===t.length)return i.setImmediate(function(){e.drain()});g(t,function(t){var a={data:t,priority:r,callback:"function"==typeof s?s:o};e.tasks.splice(function(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}(e.tasks,a,n)+1,0,a),e.tasks.length===e.concurrency&&e.saturated(),i.setImmediate(e.process)})}(r,e,t,s)},delete r.unshift,r},i.cargo=function(e,t){return N(e,1,t)},i.log=j("log"),i.dir=j("dir"),i.memoize=function(e,t){var n={},r={},o=Object.prototype.hasOwnProperty;t=t||s;var a=_(function(s){var a=s.pop(),c=t.apply(null,s);o.call(n,c)?i.setImmediate(function(){a.apply(null,n[c])}):o.call(r,c)?r[c].push(a):(r[c]=[a],e.apply(null,s.concat([_(function(e){n[c]=e;var t=r[c];delete r[c];for(var i=0,o=t.length;i<o;i++)t[i].apply(null,e)})])))});return a.memo=n,a.unmemoized=e,a},i.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},i.times=L(i.map),i.timesSeries=L(i.mapSeries),i.timesLimit=function(e,t,n,r){return i.mapLimit(v(e),t,n,r)},i.seq=function(){var e=arguments;return _(function(t){var n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=o,i.reduce(e,t,function(e,t,r){t.apply(n,e.concat([_(function(e,t){r(e,t)})]))},function(e,t){r.apply(n,[e].concat(t))})})},i.compose=function(){return i.seq.apply(null,Array.prototype.reverse.call(arguments))},i.applyEach=F(i.eachOf),i.applyEachSeries=F(i.eachOfSeries),i.forever=function(e,t){var n=l(t||o),r=$(e);!function e(t){if(t)return n(t);r(e)}()},i.ensureAsync=$,i.constant=_(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),i.wrapSync=i.asyncify=function(e){return _(function(t){var n,r,i,o=t.pop();try{n=e.apply(this,t)}catch(e){return o(e)}("function"===(i=typeof(r=n))||"object"===i&&r)&&"function"==typeof n.then?n.then(function(e){o(null,e)}).catch(function(e){o(e.message?e:new Error(e))}):o(null,n)})},e.exports?e.exports=i:void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){var r=n(4),i=n(8),o=parseInt("0777",8);function s(e,t,n,a){"function"==typeof t?(n=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,u=t.fs||i;void 0===c&&(c=o&~process.umask()),a||(a=null);var l=n||function(){};e=r.resolve(e),u.mkdir(e,c,function(n){if(!n)return l(null,a=a||e);switch(n.code){case"ENOENT":s(r.dirname(e),t,function(n,r){n?l(n,r):s(e,t,l,r)});break;default:u.stat(e,function(e,t){e||!t.isDirectory()?l(n,a):l(null,a)})}})}e.exports=s.mkdirp=s.mkdirP=s,s.sync=function e(t,n,s){n&&"object"==typeof n||(n={mode:n});var a=n.mode,c=n.fs||i;void 0===a&&(a=o&~process.umask()),s||(s=null),t=r.resolve(t);try{c.mkdirSync(t,a),s=s||t}catch(i){switch(i.code){case"ENOENT":s=e(r.dirname(t),n,s),e(t,n,s);break;default:var u;try{u=c.statSync(t)}catch(e){throw i}if(!u.isDirectory())throw i}}return s}},function(e,t,n){e.exports=h,h.sync=v;var r=n(9),i=n(4),o=n(8),s=n(34),a=parseInt("666",8),c={nosort:!0,silent:!0},u=0,l="win32"===process.platform;function d(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(function(t){e[t]=e[t]||o[t],e[t+="Sync"]=e[t]||o[t]}),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),e.disableGlob=e.disableGlob||!1,e.glob=e.glob||c}function h(e,t,n){"function"==typeof t&&(n=t,t={}),r(e,"rimraf: missing path"),r.equal(typeof e,"string","rimraf: path should be a string"),r.equal(typeof n,"function","rimraf: callback function required"),r(t,"rimraf: invalid options argument provided"),r.equal(typeof t,"object","rimraf: options should be object"),d(t);var i=0,o=null,a=0;if(t.disableGlob||!s.hasMagic(e))return c(null,[e]);function c(e,r){return e?n(e):0===(a=r.length)?n():void r.forEach(function(e){f(e,t,function r(s){if(s){if(("EBUSY"===s.code||"ENOTEMPTY"===s.code||"EPERM"===s.code)&&i<t.maxBusyTries)return i++,setTimeout(function(){f(e,t,r)},100*i);if("EMFILE"===s.code&&u<t.emfileWait)return setTimeout(function(){f(e,t,r)},u++);"ENOENT"===s.code&&(s=null)}u=0,function(e){o=o||e,0==--a&&n(o)}(s)})})}t.lstat(e,function(n,r){if(!n)return c(null,[e]);s(e,t.glob,c)})}function f(e,t,n){r(e),r(t),r("function"==typeof n),t.lstat(e,function(r,i){return r&&"ENOENT"===r.code?n(null):(r&&"EPERM"===r.code&&l&&p(e,t,r,n),i&&i.isDirectory()?m(e,t,r,n):void t.unlink(e,function(r){if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return l?p(e,t,r,n):m(e,t,r,n);if("EISDIR"===r.code)return m(e,t,r,n)}return n(r)}))})}function p(e,t,n,i){r(e),r(t),r("function"==typeof i),n&&r(n instanceof Error),t.chmod(e,a,function(r){r?i("ENOENT"===r.code?null:n):t.stat(e,function(r,o){r?i("ENOENT"===r.code?null:n):o.isDirectory()?m(e,t,n,i):t.unlink(e,i)})})}function g(e,t,n){r(e),r(t),n&&r(n instanceof Error);try{t.chmodSync(e,a)}catch(e){if("ENOENT"===e.code)return;throw n}try{var i=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw n}i.isDirectory()?y(e,t,n):t.unlinkSync(e)}function m(e,t,n,o){r(e),r(t),n&&r(n instanceof Error),r("function"==typeof o),t.rmdir(e,function(s){!s||"ENOTEMPTY"!==s.code&&"EEXIST"!==s.code&&"EPERM"!==s.code?s&&"ENOTDIR"===s.code?o(n):o(s):function(e,t,n){r(e),r(t),r("function"==typeof n),t.readdir(e,function(r,o){if(r)return n(r);var s,a=o.length;if(0===a)return t.rmdir(e,n);o.forEach(function(r){h(i.join(e,r),t,function(r){if(!s)return r?n(s=r):void(0==--a&&t.rmdir(e,n))})})})}(e,t,o)})}function v(e,t){var n;if(d(t=t||{}),r(e,"rimraf: missing path"),r.equal(typeof e,"string","rimraf: path should be a string"),r(t,"rimraf: missing options"),r.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!s.hasMagic(e))n=[e];else try{t.lstatSync(e),n=[e]}catch(r){n=s.sync(e,t.glob)}if(n.length)for(var i=0;i<n.length;i++){e=n[i];try{var o=t.lstatSync(e)}catch(n){if("ENOENT"===n.code)return;"EPERM"===n.code&&l&&g(e,t,n)}try{o&&o.isDirectory()?y(e,t,null):t.unlinkSync(e)}catch(n){if("ENOENT"===n.code)return;if("EPERM"===n.code)return l?g(e,t,n):y(e,t,n);if("EISDIR"!==n.code)throw n;y(e,t,n)}}}function y(e,t,n){r(e),r(t),n&&r(n instanceof Error);try{t.rmdirSync(e)}catch(o){if("ENOENT"===o.code)return;if("ENOTDIR"===o.code)throw n;"ENOTEMPTY"!==o.code&&"EEXIST"!==o.code&&"EPERM"!==o.code||function(e,t){r(e),r(t),t.readdirSync(e).forEach(function(n){v(i.join(e,n),t)});var n=l?100:1,o=0;for(;;){var s=!0;try{var a=t.rmdirSync(e,t);return s=!1,a}finally{if(++o<n&&s)continue}}}(e,t)}}},function(e,t,n){var r=n(4),i="win32"===process.platform,o=n(8),s=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function a(e){return"function"==typeof e?e:function(){var e;if(s){var t=new Error;e=function(e){e&&(t.message=e.message,n(e=t))}}else e=n;return e;function n(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}r.normalize;if(i)var c=/(.*?)(?:[\/\\]+|$)/g;else c=/(.*?)(?:[\/]+|$)/g;if(i)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else u=/^[\/]*/;t.realpathSync=function(e,t){if(e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var n,s,a,l,d=e,h={},f={};function p(){var t=u.exec(e);n=t[0].length,s=t[0],a=t[0],l="",i&&!f[a]&&(o.lstatSync(a),f[a]=!0)}for(p();n<e.length;){c.lastIndex=n;var g=c.exec(e);if(l=s,s+=g[0],a=l+g[1],n=c.lastIndex,!(f[a]||t&&t[a]===a)){var m;if(t&&Object.prototype.hasOwnProperty.call(t,a))m=t[a];else{var v=o.lstatSync(a);if(!v.isSymbolicLink()){f[a]=!0,t&&(t[a]=a);continue}var y=null;if(!i){var w=v.dev.toString(32)+":"+v.ino.toString(32);h.hasOwnProperty(w)&&(y=h[w])}null===y&&(o.statSync(a),y=o.readlinkSync(a)),m=r.resolve(l,y),t&&(t[a]=m),i||(h[w]=y)}e=r.resolve(m,e.slice(n)),p()}}return t&&(t[d]=e),e},t.realpath=function(e,t,n){if("function"!=typeof n&&(n=a(t),t=null),e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(n.bind(null,null,t[e]));var s,l,d,h,f=e,p={},g={};function m(){var t=u.exec(e);s=t[0].length,l=t[0],d=t[0],h="",i&&!g[d]?o.lstat(d,function(e){if(e)return n(e);g[d]=!0,v()}):process.nextTick(v)}function v(){if(s>=e.length)return t&&(t[f]=e),n(null,e);c.lastIndex=s;var r=c.exec(e);return h=l,l+=r[0],d=h+r[1],s=c.lastIndex,g[d]||t&&t[d]===d?process.nextTick(v):t&&Object.prototype.hasOwnProperty.call(t,d)?b(t[d]):o.lstat(d,y)}function y(e,r){if(e)return n(e);if(!r.isSymbolicLink())return g[d]=!0,t&&(t[d]=d),process.nextTick(v);if(!i){var s=r.dev.toString(32)+":"+r.ino.toString(32);if(p.hasOwnProperty(s))return w(null,p[s],d)}o.stat(d,function(e){if(e)return n(e);o.readlink(d,function(e,t){i||(p[s]=t),w(e,t)})})}function w(e,i,o){if(e)return n(e);var s=r.resolve(h,i);t&&(t[o]=s),b(s)}function b(t){e=r.resolve(t,e.slice(s)),m()}m()}},function(e,t,n){var r=n(79),i=n(80);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,n){var o=[];var s=i("{","}",t);if(!s||/\$$/.test(s.pre))return[t];var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body);var u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body);var d=c||u;var m=s.body.indexOf(",")>=0;if(!d&&!m)return s.post.match(/,.*\}/)?(t=s.pre+"{"+s.body+a+s.post,e(t)):[t];var v;if(d)v=s.body.split(/\.\./);else if(1===(v=function e(t){if(!t)return[""];var n=[];var r=i("{","}",t);if(!r)return t.split(",");var o=r.pre;var s=r.body;var a=r.post;var c=o.split(",");c[c.length-1]+="{"+s+"}";var u=e(a);a.length&&(c[c.length-1]+=u.shift(),c.push.apply(c,u));n.push.apply(n,c);return n}(s.body)).length&&1===(v=e(v[0],!1).map(h)).length){var y=s.post.length?e(s.post,!1):[""];return y.map(function(e){return s.pre+v[0]+e})}var w=s.pre;var y=s.post.length?e(s.post,!1):[""];var b;if(d){var _=l(v[0]),S=l(v[1]),C=Math.max(v[0].length,v[1].length),T=3==v.length?Math.abs(l(v[2])):1,R=p,k=S<_;k&&(T*=-1,R=g);var E=v.some(f);b=[];for(var x=_;R(x,S);x+=T){var D;if(u)"\\"===(D=String.fromCharCode(x))&&(D="");else if(D=String(x),E){var P=C-D.length;if(P>0){var A=new Array(P+1).join("0");D=x<0?"-"+A+D.slice(1):A+D}}b.push(D)}}else b=r(v,function(t){return e(t,!1)});for(var O=0;O<b.length;O++)for(var M=0;M<y.length;M++){var I=w+b[O]+y[M];(!n||d||I)&&o.push(I)}return o}(function(e){return e.split("\\\\").join(o).split("\\{").join(s).split("\\}").join(a).split("\\,").join(c).split("\\.").join(u)}(e),!0).map(d)};var o="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(o).join("\\").split(s).join("{").split(a).join("}").split(c).join(",").split(u).join(".")}function h(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function p(e,t){return e<=t}function g(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var r=[],i=0;i<e.length;i++){var o=t(e[i],i);n(o)?r.push.apply(r,o):r.push(o)}return r};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){function r(e,t,n){e instanceof RegExp&&(e=i(e,n)),t instanceof RegExp&&(t=i(t,n));var r=o(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function i(e,t){var n=t.match(e);return n?n[0]:null}function o(e,t,n){var r,i,o,s,a,c=n.indexOf(e),u=n.indexOf(t,c+1),l=c;if(c>=0&&u>0){for(r=[],o=n.length;l>=0&&!a;)l==c?(r.push(l),c=n.indexOf(e,l+1)):1==r.length?a=[r.pop(),u]:((i=r.pop())<o&&(o=i,s=u),u=n.indexOf(t,l+1)),l=c<u&&c>=0?c:u;r.length&&(a=[o,s])}return a}e.exports=r,r.range=o},function(e,t,n){try{var r=n(16);if("function"!=typeof r.inherits)throw"";e.exports=r.inherits}catch(t){e.exports=n(82)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){e.exports=p,p.GlobSync=g;var r=n(8),i=n(35),o=n(24),s=(o.Minimatch,n(34).Glob,n(16),n(4)),a=n(9),c=n(25),u=n(36),l=(u.alphasort,u.alphasorti,u.setopts),d=u.ownProp,h=u.childrenIgnored,f=u.isIgnored;function p(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new g(e,t).found}function g(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof g))return new g(e,t);if(l(this,e,t),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var r=0;r<n;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}g.prototype._finish=function(){if(a(this instanceof g),this.realpath){var e=this;this.matches.forEach(function(t,n){var r=e.matches[n]=Object.create(null);for(var o in t)try{o=e._makeAbs(o),r[i.realpathSync(o,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;r[e._makeAbs(o)]=!0}})}u.finish(this)},g.prototype._process=function(e,t,n){a(this instanceof g);for(var r,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:r=null;break;default:r=e.slice(0,i).join("/")}var s,u=e.slice(i);null===r?s=".":c(r)||c(e.join("/"))?(r&&c(r)||(r="/"+r),s=r):s=r;var l=this._makeAbs(s);h(this,s)||(u[0]===o.GLOBSTAR?this._processGlobStar(r,s,l,u,t,n):this._processReaddir(r,s,l,u,t,n))},g.prototype._processReaddir=function(e,t,n,r,i,o){var a=this._readdir(n,o);if(a){for(var c=r[0],u=!!this.minimatch.negate,l=c._glob,d=this.dot||"."===l.charAt(0),h=[],f=0;f<a.length;f++){if("."!==(m=a[f]).charAt(0)||d)(u&&!e?!m.match(c):m.match(c))&&h.push(m)}var p=h.length;if(0!==p)if(1!==r.length||this.mark||this.stat){r.shift();for(f=0;f<p;f++){var g;m=h[f];g=e?[e,m]:[m],this._process(g.concat(r),i,o)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var f=0;f<p;f++){var m=h[f];e&&(m="/"!==e.slice(-1)?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=s.join(this.root,m)),this._emitMatch(i,m)}}}},g.prototype._emitMatch=function(e,t){if(!f(this,t)){var n=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},g.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,n;try{n=r.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var i=n&&n.isSymbolicLink();return this.symlinks[e]=i,i||!n||n.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},g.prototype._readdir=function(e,t){if(t&&!d(this.symlinks,e))return this._readdirInGlobStar(e);if(d(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,r.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},g.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var r=t[n];r="/"===e?e+r:e+"/"+r,this.cache[r]=!0}return this.cache[e]=t,t},g.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var r=new Error(t.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=t.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},g.prototype._processGlobStar=function(e,t,n,r,i,o){var s=this._readdir(n,o);if(s){var a=r.slice(1),c=e?[e]:[],u=c.concat(a);this._process(u,i,!1);var l=s.length;if(!this.symlinks[n]||!o)for(var d=0;d<l;d++){if("."!==s[d].charAt(0)||this.dot){var h=c.concat(s[d],a);this._process(h,i,!0);var f=c.concat(s[d],r);this._process(f,i,!0)}}}},g.prototype._processSimple=function(e,t){var n=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),n){if(e&&c(e)&&!this.nomount){var r=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=s.join(this.root,e):(e=s.resolve(this.root,e),r&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},g.prototype._stat=function(e){var t=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&d(this.cache,t)){var i=this.cache[t];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return i;if(n&&"FILE"===i)return!1}var o=this.statCache[t];if(!o){var s;try{s=r.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{o=r.statSync(t)}catch(e){o=s}else o=s}this.statCache[t]=o;i=!0;return o&&(i=o.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||i,(!n||"FILE"!==i)&&i},g.prototype._mark=function(e){return u.mark(this,e)},g.prototype._makeAbs=function(e){return u.makeAbs(this,e)}},function(e,t,n){var r=n(37),i=Object.create(null),o=n(38);e.exports=r(function(e,t){return i[e]?(i[e].push(t),null):(i[e]=[t],function(e){return o(function t(){var n=i[e],r=n.length,o=function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r]=e[r];return n}(arguments);try{for(var s=0;s<r;s++)n[s].apply(null,o)}finally{n.length>r?(n.splice(0,r),process.nextTick(function(){t.apply(null,o)})):delete i[e]}})}(e))})},function(e,t,n){var r=n(20);e.exports=function(){return r.randomBytes(16)}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.apmInstall=function(e,t){const n=new Map;return Promise.all(e.map(function(e){return(r=atom.packages.getApmPath(),i=["install",e.url||e.name,"--production","--color","false"],new Promise(function(e){const t={stdout:[],stderr:[]},n=new s.BufferedProcess({command:r,args:i,stdout(e){t.stdout.push(e)},stderr(e){t.stderr.push(e)},exit(){e({stdout:t.stdout.join(""),stderr:t.stderr.join("")})},autoStart:!1});n.start()})).then(function(n){let r=l.test(n.stdout);if(r){const e=l.exec(n.stdout);r=e&&u.has(e[2])}if(t(e.name,!!r),!r){const t=new Error(`Error installing dependency: ${e.name}`);throw t.stack=n.stderr,t}}).catch(function(t){n.set(e.name,t)});var r,i})).then(function(){return n})},t.getDependencies=async function(e){const t=atom.packages.getLoadedPackage(e),n=t&&t.metadata["package-deps"];if(!Array.isArray(n))return console.error(`[Package-Deps] Unable to get loaded package '${e}'`),[];return(await Promise.all(n.map(async function(e){let t=null,n=e,s=null;const a=d.exec(e),c=h.exec(e);if(a?[,n,s]=a:c?[,n,t]=c:n=e,__steelbrain_package_deps.has(n))return null;const u=atom.packages.resolvePackagePath(n);if(u){if(!s)return null;const e=JSON.parse(await r.default.readFile(i.default.join(u,"package.json")));if(o.default.satisfies(e.version,`>=${s}`))return null}return __steelbrain_package_deps.add(n),{name:n,url:t}}))).filter(Boolean)},t.promptUser=async function(e,t){const n=i.default.join(atom.getConfigDirPath(),"package-deps-state.json");let o=atom.config.get("atom-package-deps.ignored")||[];if(await r.default.exists(n)){const e=JSON.parse(await r.default.readFile(n,"utf8"));atom.config.set("atom-package-deps.ignored",o=e.ignored),await r.default.unlink(n)}if(o.includes(e))return"No";atom.packages.isPackageDisabled("notifications")&&console.warn(`Enable notifications to install dependencies for ${e}`);return new Promise(function(n){const r=atom.notifications.addInfo(`${e} needs to install dependencies`,{dismissable:!0,icon:"cloud-download",detail:t.map(e=>e.name).join(", "),description:`Install dependenc${1===t.length?"y":"ies"}?`,buttons:[{text:"Yes",onDidClick:()=>{n("Yes"),r.dismiss()}},{text:"No Thanks",onDidClick:()=>{n("No"),r.dismiss()}},{text:"Never",onDidClick:()=>{o.push(e),atom.config.set("atom-package-deps.ignored",o),c||(c=!0,atom.notifications.addInfo("How to reset package-deps memory",{dismissable:!0,description:"To modify the list of ignored files invoke 'Application: Open Your Config' and change the 'atom-package-deps' section"})),n("Never"),r.dismiss()}}]});r.onDidDismiss(()=>n("No"))})};var r=a(n(88)),i=a(n(4)),o=a(n(91)),s=n(1);function a(e){return e&&e.__esModule?e:{default:e}}let c=!1;const u=new Set(["✓","done"]),l=/(?:Installing|Moving) (.*?) to .* (.*)/;const d=/(.*?):.*/,h=/(.*?)#.*/},function(e,t,n){var r=s(n(8)),i=n(16),o=s(n(89));function s(e){return e&&e.__esModule?e:{default:e}}const a={},c=["Stats","_toUnixTimestamp","watch","watchFile","unwatchFile"];Object.keys(r.default).forEach(function(e){const t=r.default[e];"function"!=typeof t||e.includes("Sync")||e.includes("Stream")||c.includes(e)?a[e]=t:a[e]=(0,i.promisify)(t)}),a.exists=function(e){return new Promise(function(t){r.default.access(e,r.default.R_OK,function(e){t(null===e)})})},a.readFile=function(e,t){return new Promise(function(n,i){r.default.readFile(e,function(e,r){if(e)return void i(e);let s=(0,o.default)(r);t&&(s=s.toString(t)),n(s)})})},e.exports=a},function(e,t,n){const r=n(90);e.exports=(e=>{if(!Buffer.isBuffer(e))throw new TypeError("Expected a Buffer, got "+typeof e);return 239===e[0]&&187===e[1]&&191===e[2]&&r(e)?e.slice(3):e})},function(e,t){e.exports=function(e){for(var t=0;t<e.length;)if(9==e[t]||10==e[t]||13==e[t]||32<=e[t]&&e[t]<=126)t+=1;else if(194<=e[t]&&e[t]<=223&&128<=e[t+1]&&e[t+1]<=191)t+=2;else if(224==e[t]&&160<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191||(225<=e[t]&&e[t]<=236||238==e[t]||239==e[t])&&128<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191||237==e[t]&&128<=e[t+1]&&e[t+1]<=159&&128<=e[t+2]&&e[t+2]<=191)t+=3;else{if(!(240==e[t]&&144<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191&&128<=e[t+3]&&e[t+3]<=191||241<=e[t]&&e[t]<=243&&128<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191&&128<=e[t+3]&&e[t+3]<=191||244==e[t]&&128<=e[t+1]&&e[t+1]<=143&&128<=e[t+2]&&e[t+2]<=191&&128<=e[t+3]&&e[t+3]<=191))return!1;t+=4}return!0}},function(e,t){var n;t=e.exports=H,n="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var r=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],s=t.src=[],a=0,c=a++;s[c]="0|[1-9]\\d*";var u=a++;s[u]="[0-9]+";var l=a++;s[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var d=a++;s[d]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var h=a++;s[h]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var f=a++;s[f]="(?:"+s[c]+"|"+s[l]+")";var p=a++;s[p]="(?:"+s[u]+"|"+s[l]+")";var g=a++;s[g]="(?:-("+s[f]+"(?:\\."+s[f]+")*))";var m=a++;s[m]="(?:-?("+s[p]+"(?:\\."+s[p]+")*))";var v=a++;s[v]="[0-9A-Za-z-]+";var y=a++;s[y]="(?:\\+("+s[v]+"(?:\\."+s[v]+")*))";var w=a++,b="v?"+s[d]+s[g]+"?"+s[y]+"?";s[w]="^"+b+"$";var _="[v=\\s]*"+s[h]+s[m]+"?"+s[y]+"?",S=a++;s[S]="^"+_+"$";var C=a++;s[C]="((?:<|>)?=?)";var T=a++;s[T]=s[u]+"|x|X|\\*";var R=a++;s[R]=s[c]+"|x|X|\\*";var k=a++;s[k]="[v=\\s]*("+s[R]+")(?:\\.("+s[R]+")(?:\\.("+s[R]+")(?:"+s[g]+")?"+s[y]+"?)?)?";var E=a++;s[E]="[v=\\s]*("+s[T]+")(?:\\.("+s[T]+")(?:\\.("+s[T]+")(?:"+s[m]+")?"+s[y]+"?)?)?";var x=a++;s[x]="^"+s[C]+"\\s*"+s[k]+"$";var D=a++;s[D]="^"+s[C]+"\\s*"+s[E]+"$";var P=a++;s[P]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var A=a++;s[A]="(?:~>?)";var O=a++;s[O]="(\\s*)"+s[A]+"\\s+",o[O]=new RegExp(s[O],"g");var M=a++;s[M]="^"+s[A]+s[k]+"$";var I=a++;s[I]="^"+s[A]+s[E]+"$";var q=a++;s[q]="(?:\\^)";var N=a++;s[N]="(\\s*)"+s[q]+"\\s+",o[N]=new RegExp(s[N],"g");var j=a++;s[j]="^"+s[q]+s[k]+"$";var L=a++;s[L]="^"+s[q]+s[E]+"$";var F=a++;s[F]="^"+s[C]+"\\s*("+_+")$|^$";var $=a++;s[$]="^"+s[C]+"\\s*("+b+")$|^$";var W=a++;s[W]="(\\s*)"+s[C]+"\\s*("+_+"|"+s[k]+")",o[W]=new RegExp(s[W],"g");var U=a++;s[U]="^\\s*("+s[k]+")\\s+-\\s+("+s[k]+")\\s*$";var z=a++;s[z]="^\\s*("+s[E]+")\\s+-\\s+("+s[E]+")\\s*$";var V=a++;s[V]="(<|>)?=?\\s*\\*";for(var B=0;B<35;B++)n(B,s[B]),o[B]||(o[B]=new RegExp(s[B]));function K(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof H)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?o[S]:o[w]).test(e))return null;try{return new H(e,t)}catch(e){return null}}function H(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof H){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>r)throw new TypeError("version is longer than "+r+" characters");if(!(this instanceof H))return new H(e,t);n("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?o[S]:o[w]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}t.parse=K,t.valid=function(e,t){var n=K(e,t);return n?n.version:null},t.clean=function(e,t){var n=K(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=H,H.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},H.prototype.toString=function(){return this.version},H.prototype.compare=function(e){return n("SemVer.compare",this.version,this.options,e),e instanceof H||(e=new H(e,this.options)),this.compareMain(e)||this.comparePre(e)},H.prototype.compareMain=function(e){return e instanceof H||(e=new H(e,this.options)),Q(this.major,e.major)||Q(this.minor,e.minor)||Q(this.patch,e.patch)},H.prototype.comparePre=function(e){if(e instanceof H||(e=new H(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return Q(r,i)}while(++t)},H.prototype.compareBuild=function(e){e instanceof H||(e=new H(e,this.options));var t=0;do{var r=this.build[t],i=e.build[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return Q(r,i)}while(++t)},H.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new H(e,n).inc(t,r).version}catch(e){return null}},t.diff=function(e,t){if(Y(e,t))return null;var n=K(e),r=K(t),i="";if(n.prerelease.length||r.prerelease.length){i="pre";var o="prerelease"}for(var s in n)if(("major"===s||"minor"===s||"patch"===s)&&n[s]!==r[s])return i+s;return o},t.compareIdentifiers=Q;var G=/^[0-9]+$/;function Q(e,t){var n=G.test(e),r=G.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}function J(e,t,n){return new H(e,n).compare(new H(t,n))}function Z(e,t,n){return J(e,t,n)>0}function X(e,t,n){return J(e,t,n)<0}function Y(e,t,n){return 0===J(e,t,n)}function ee(e,t,n){return 0!==J(e,t,n)}function te(e,t,n){return J(e,t,n)>=0}function ne(e,t,n){return J(e,t,n)<=0}function re(e,t,n,r){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return Y(e,n,r);case"!=":return ee(e,n,r);case">":return Z(e,n,r);case">=":return te(e,n,r);case"<":return X(e,n,r);case"<=":return ne(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);n("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,n("comp",this)}t.rcompareIdentifiers=function(e,t){return Q(t,e)},t.major=function(e,t){return new H(e,t).major},t.minor=function(e,t){return new H(e,t).minor},t.patch=function(e,t){return new H(e,t).patch},t.compare=J,t.compareLoose=function(e,t){return J(e,t,!0)},t.compareBuild=function(e,t,n){var r=new H(e,n),i=new H(t,n);return r.compare(i)||r.compareBuild(i)},t.rcompare=function(e,t,n){return J(t,e,n)},t.sort=function(e,n){return e.sort(function(e,r){return t.compareBuild(e,r,n)})},t.rsort=function(e,n){return e.sort(function(e,r){return t.compareBuild(r,e,n)})},t.gt=Z,t.lt=X,t.eq=Y,t.neq=ee,t.gte=te,t.lte=ne,t.cmp=re,t.Comparator=ie;var oe={};function se(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new se(e.raw,t);if(e instanceof ie)return new se(e.value,t);if(!(this instanceof se))return new se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e,t){for(var n=!0,r=e.slice(),i=r.pop();n&&r.length;)n=r.every(function(e){return i.intersects(e,t)}),i=r.pop();return n}function ce(e){return!e||"x"===e.toLowerCase()||"*"===e}function ue(e,t,n,r,i,o,s,a,c,u,l,d,h){return((t=ce(n)?"":ce(r)?">="+n+".0.0":ce(i)?">="+n+"."+r+".0":">="+t)+" "+(a=ce(c)?"":ce(u)?"<"+(+c+1)+".0.0":ce(l)?"<"+c+"."+(+u+1)+".0":d?"<="+c+"."+u+"."+l+"-"+d:"<="+a)).trim()}function le(e,t,r){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(i=0;i<e.length;i++)if(n(e[i].semver),e[i].semver!==oe&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function de(e,t,n){try{t=new se(t,n)}catch(e){return!1}return t.test(e)}function he(e,t,n,r){var i,o,s,a,c;switch(e=new H(e,r),t=new se(t,r),n){case">":i=Z,o=ne,s=X,a=">",c=">=";break;case"<":i=X,o=te,s=Z,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(de(e,t,r))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],d=null,h=null;if(l.forEach(function(e){e.semver===oe&&(e=new ie(">=0.0.0")),d=d||e,h=h||e,i(e.semver,d.semver,r)?d=e:s(e.semver,h.semver,r)&&(h=e)}),d.operator===a||d.operator===c)return!1;if((!h.operator||h.operator===a)&&o(e,h.semver))return!1;if(h.operator===c&&s(e,h.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?o[F]:o[$],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new H(n[2],this.options.loose):this.semver=oe},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return n("Comparator.test",e,this.options.loose),this.semver===oe||e===oe||("string"==typeof e&&(e=new H(e,this.options)),re(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(n=new se(e.value,t),de(this.value,n,t));if(""===e.operator)return""===e.value||(n=new se(this.value,t),de(e.semver,n,t));var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||i||o&&s||a||c},t.Range=se,se.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?o[z]:o[U];e=e.replace(r,ue),n("hyphen replace",e),e=e.replace(o[W],"$1$2$3"),n("comparator trim",e,o[W]),e=(e=(e=e.replace(o[O],"$1~")).replace(o[N],"$1^")).split(/\s+/).join(" ");var i=t?o[F]:o[$],s=e.split(" ").map(function(e){return function(e,t){return n("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){n("caret",e,t);var r=t.loose?o[L]:o[j];return e.replace(r,function(t,r,i,o,s){var a;return n("caret",e,t,r,i,o,s),ce(r)?a="":ce(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":ce(o)?a="0"===r?">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":">="+r+"."+i+".0 <"+(+r+1)+".0.0":s?(n("replaceCaret pr",s),a="0"===r?"0"===i?">="+r+"."+i+"."+o+"-"+s+" <"+r+"."+i+"."+(+o+1):">="+r+"."+i+"."+o+"-"+s+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+o+"-"+s+" <"+(+r+1)+".0.0"):(n("no pr"),a="0"===r?"0"===i?">="+r+"."+i+"."+o+" <"+r+"."+i+"."+(+o+1):">="+r+"."+i+"."+o+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+o+" <"+(+r+1)+".0.0"),n("caret return",a),a})}(e,t)}).join(" ")}(e,t),n("caret",e),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){var r=t.loose?o[I]:o[M];return e.replace(r,function(t,r,i,o,s){var a;return n("tilde",e,t,r,i,o,s),ce(r)?a="":ce(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":ce(o)?a=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":s?(n("replaceTilde pr",s),a=">="+r+"."+i+"."+o+"-"+s+" <"+r+"."+(+i+1)+".0"):a=">="+r+"."+i+"."+o+" <"+r+"."+(+i+1)+".0",n("tilde return",a),a})}(e,t)}).join(" ")}(e,t),n("tildes",e),e=function(e,t){return n("replaceXRanges",e,t),e.split(/\s+/).map(function(e){return function(e,t){e=e.trim();var r=t.loose?o[D]:o[x];return e.replace(r,function(t,r,i,o,s,a){n("xRange",e,t,r,i,o,s,a);var c=ce(i),u=c||ce(o),l=u||ce(s),d=l;return"="===r&&d&&(r=""),c?t=">"===r||"<"===r?"<0.0.0":"*":r&&d?(u&&(o=0),s=0,">"===r?(r=">=",u?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===r&&(r="<",u?i=+i+1:o=+o+1),t=r+i+"."+o+"."+s):u?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),n("xRange return",t),t})}(e,t)}).join(" ")}(e,t),n("xrange",e),e=function(e,t){return n("replaceStars",e,t),e.trim().replace(o[V],"")}(e,t),n("stars",e),e}(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter(function(e){return!!e.match(i)})),s=s.map(function(e){return new ie(e,this.options)},this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some(function(n){return ae(n,t)&&e.set.some(function(e){return ae(e,t)&&n.every(function(n){return e.every(function(e){return n.intersects(e,t)})})})})},t.toComparators=function(e,t){return new se(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new H(e,this.options));for(var t=0;t<this.set.length;t++)if(le(this.set[t],e,this.options))return!0;return!1},t.satisfies=de,t.maxSatisfying=function(e,t,n){var r=null,i=null;try{var o=new se(t,n)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(r&&-1!==i.compare(e)||(i=new H(r=e,n)))}),r},t.minSatisfying=function(e,t,n){var r=null,i=null;try{var o=new se(t,n)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(r&&1!==i.compare(e)||(i=new H(r=e,n)))}),r},t.minVersion=function(e,t){e=new se(e,t);var n=new H("0.0.0");if(e.test(n))return n;if(n=new H("0.0.0-0"),e.test(n))return n;n=null;for(var r=0;r<e.set.length;++r){var i=e.set[r];i.forEach(function(e){var t=new H(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!Z(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}if(n&&e.test(n))return n;return null},t.validRange=function(e,t){try{return new se(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return he(e,t,"<",n)},t.gtr=function(e,t,n){return he(e,t,">",n)},t.outside=he,t.prerelease=function(e,t){var n=K(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new se(e,n),t=new se(t,n),e.intersects(t)},t.coerce=function(e,t){if(e instanceof H)return e;if("string"!=typeof e)return null;var n=e.match(o[P]);if(null==n)return null;return K(n[1]+"."+(n[2]||"0")+"."+(n[3]||"0"),t)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class View{constructor(e,t){this.name=e,this.dependencies=t;const n=atom.notifications.addInfo(`Installing ${e} dependencies`,{detail:`Installing ${t.map(e=>e.name).join(", ")}`,dismissable:!0}),r=document.createElement("progress");this.dispose=function(){n.dismiss()},this.advance=function(){r.value++},r.max=t.length,r.style.width="100%";try{const e=atom.views.getView(n),t=e.querySelector(".detail-content")||e.querySelector(".content");t&&t.appendChild(r)}catch(e){}}complete(e){if(this.dispose(),!e.size)return void atom.notifications.addSuccess(`Installed ${this.name} dependencies`,{detail:`Installed ${this.dependencies.map(e=>e.name).join(", ")}`});const t=[];for(const[n,r]of e)t.push(`  • ${n}`),console.error(`[Package-Deps] Unable to install ${n}, Error:`,r&&r.stack||r);atom.notifications.addWarning(`Failed to install ${this.name} dependencies`,{detail:`These packages were not installed, check your console\nfor more info.\n${t.join("\n")}`,dismissable:!0})}}},function(e,t,n){n.r(t);var r,i=n(0);!function(e){e.Disconnected="disconnected",e.Reconnected="reconnected",e.Reconnecting="reconnecting"}(r||(r={}));const o=new i.NotificationType("codestream/didChangeConnectionStatus");var s;!function(e){e.Codemarks="codemarks",e.MarkerLocations="markerLocations",e.Markers="markers",e.Posts="posts",e.Preferences="preferences",e.Repositories="repos",e.Streams="streams",e.Teams="teams",e.Unreads="unreads",e.Users="users"}(s||(s={}));const a=new i.NotificationType("codestream/didChangeData"),c=new i.NotificationType("codestream/didChangeDocumentMarkers");var u;!function(e){e.Compatible="ok",e.CompatibleUpgradeAvailable="outdated",e.CompatibleUpgradeRecommended="deprecated",e.UnsupportedUpgradeRequired="incompatible",e.Unknown="unknownVersion"}(u||(u={}));new i.NotificationType("codestream/didChangeVersionCompatibility");var l;!function(e){e.Token="token",e.Unknown="unknown"}(l||(l={}));new i.NotificationType("codestream/didLogout"),new i.NotificationType("codestream/didUpdateProviders");const d=new i.RequestType("codestream/login/password"),h=new i.RequestType("codestream/login/token"),f=new i.RequestType("codestream/login/otc"),p=(new i.RequestType("codestream/registration"),new i.RequestType("codestream/registration/confirm"),new i.RequestType("codestream/registration/invite-info"),new i.RequestType("codestream/sendPasswordResetEmail"),new i.RequestType("codestream/textDocument/markers/create/link"));var g;!function(e){e.MISSING_ORIGINAL_LOCATION="missing original location",e.MISSING_ORIGINAL_COMMIT="missing original commit",e.CODEBLOCK_DELETED="code block deleted",e.UNKNOWN="unknown"}(g||(g={}));const m=new i.RequestType("codestream/textDocument/markers"),v=new i.RequestType("codestream/textDocument/fromKey"),y=new i.RequestType("codestream/textDocument/fromMarker"),w=(new i.RequestType("codestream/codemarks/create"),new i.RequestType("codestream/codemark/permalink"),new i.RequestType("codestream/codemarks"),new i.RequestType("codestream/codemark/delete"),new i.RequestType("codestream/codemark"),new i.RequestType("codestream/codemark/setPinned"),new i.RequestType("codestream/codemark/setStatus"),new i.RequestType("codestream/codemark/update"),new i.RequestType("codestream/codemark/sha1"),new i.RequestType("codestream/codemark/pinReply"),new i.RequestType("codestream/markerLocations/create"),new i.RequestType("codestream/marker/locations"),new i.RequestType("codestream/markers"),new i.RequestType("codestream/marker"),new i.RequestType("codestream/marker/update"),new i.RequestType("codestream/posts/create"),new i.RequestType("codestream/posts/createWithCodemark"),new i.RequestType("codestream/post/replies"),new i.RequestType("codestream/posts"),new i.RequestType("codestream/post/delete"),new i.RequestType("codestream/post/edit"),new i.RequestType("codestream/post"),new i.RequestType("codestream/posts/byIds"),new i.RequestType("codestream/post/markUnread"),new i.RequestType("codestream/post/react"),new i.RequestType("codestream/repos/create"),new i.RequestType("codestream/repos"),new i.RequestType("codestream/repo"),new i.RequestType("codestream/streams/createChannel"),new i.RequestType("codestream/streams/createDirect"),new i.RequestType("codestream/streams"),new i.RequestType("codestream/streams/file"),new i.RequestType("codestream/streams/unread"),new i.RequestType("codestream/stream/archive"),new i.RequestType("codestream/stream/close"),new i.RequestType("codestream/stream"),new i.RequestType("codestream/streams/fileStream"),new i.RequestType("codestream/stream/join"),new i.RequestType("codestream/stream/leave"),new i.RequestType("codestream/stream/markRead"),new i.RequestType("codestream/stream/mute"),new i.RequestType("codestream/stream/open"),new i.RequestType("codestream/stream/rename"),new i.RequestType("codestream/stream/setPurpose"),new i.RequestType("codestream/stream/unarchive"),new i.RequestType("codestream/stream/updateMembership"),new i.RequestType("codestream/teams"),new i.RequestType("codestream/team"),new i.RequestType("codestream/team/create"),new i.RequestType("codestream/users"),new i.RequestType("codestream/user"),new i.RequestType("codestream/user/invite"),new i.RequestType("codestream/user/updatePresence"),new i.RequestType("codestream/user/updatePreferences"),new i.RequestType("codestream/users/me"),new i.RequestType("codestream/users/me/unreads"),new i.RequestType("codestream/users/me/preferences"),new i.RequestType("codestream/scm/file/info"));new i.RequestType("codestream/scm/range/info"),new i.RequestType("codestream/scm/range/sha1"),new i.RequestType("codestream/provider/connect"),new i.RequestType("codestream/provider/configure"),new i.RequestType("codestream/provider/disconnect"),new i.RequestType("codestream/provider/boards"),new i.RequestType("codestream/provider/cards/users"),new i.RequestType("codestream/provider/cards/create");var b,_;!function(e){e.Local="local",e.Production="prod",e.Unknown="unknown"}(b||(b={})),function(e){e.Silent="silent",e.Errors="errors",e.Verbose="verbose",e.Debug="debug"}(_||(_={}));new i.RequestType("codestream/api");const S=new i.RequestType("codestream/bootstrap");var C;!function(e){e.Error="error",e.Warning="warning",e.Info="info",e.Debug="debug",e.Fatal="fatal"}(C||(C={}));const T=new i.RequestType("codestream/reporting/message"),R=new i.RequestType("codestream/telemetry");new i.RequestType("codestream/url/open");var k,E,x,D,P,A,O,M;!function(e){e.MSTeams="msteams",e.Slack="slack"}(k||(k={})),function(e){e.Comment="comment",e.Issue="issue",e.Bookmark="bookmark",e.Question="question",e.Trap="trap",e.Link="link"}(E||(E={})),function(e){e.Open="open",e.Closed="closed"}(x||(x={})),function(e){e.Channel="channel",e.Direct="direct",e.File="file"}(D||(D={})),function(e){e.Vsls="vsls"}(P||(P={})),function(e){e.InvalidCredentials="INVALID_CREDENTIALS",e.InvalidToken="TOKEN_INVALID",e.NotConfirmed="NOT_CONFIRMED",e.NotOnTeam="USER_NOT_ON_TEAM",e.NotFound="NOT_FOUND",e.Unknown="UNKNOWN",e.VersionUnsupported="VERSION_UNSUPPORTED"}(A||(A={})),function(e){e.Success="SUCCESS",e.InvalidCredentials="INVALID_CREDENTIALS",e.InvalidToken="TOKEN_INVALID",e.ExpiredToken="TOKEN_EXPIRED",e.NotConfirmed="NOT_CONFIRMED",e.NotOnTeam="USER_NOT_ON_TEAM",e.Unknown="UNKNOWN",e.VersionUnsupported="VERSION_UNSUPPORTED",e.ProviderConnectFailed="PROVIDER_CONNECT_FAILED",e.MultipleWorkspaces="MULTIPLE_WORKSPACES",e.AlreadyConfirmed="ALREADY_CONFIRMED",e.InviteConflict="INVITE_CONFLICT"}(O||(O={})),function(e){e.Online="online",e.Away="away"}(M||(M={}));var I=n(1),q=n(3),N=n(6),j=n(12),L=n(4),F=n(13);const $=["avatars","showMarkers"],W=e=>"avatars"===e?"showHeadshots":e;class ConfigManager{constructor(e){this.inMemory={debug:!1},this.inMemory.debug=void 0!==e.debug&&e.debug}get(e){return atom.config.get(`codestream.${e}`)}getForWebview(e,t){return{showHeadshots:this.get("avatars"),debug:atom.inDevMode(),serverUrl:e,email:t}}onDidChangeWebviewConfig(e){return atom.config.onDidChange("codestream",({newValue:t,oldValue:n})=>{const r={};Object.entries(t).forEach(([e,t])=>{$.includes(e)&&t!==n[e]&&(r[W(e)]=t)}),Object.keys(r).length>0&&e(r)})}onDidChange(e,t){return atom.config.onDidChange(`codestream.${e}`,t)}isUserSetting(e){const t=atom.config.getSchema(`codestream.${e}`);return null!==t&&"any"!==t.type}set(e,t){atom.config.set(`codestream.${e}`,t)}dispose(){}}var U=n(2);var z,V;!function(e){e.Pixels="pixels",e.Lines="lines"}(z||(z={})),function(e){e.Codemarks="knowledge",e.CodemarksForFile="codemarks-for-file"}(V||(V={}));var B;!function(e){e.Agent="codestream",e.Host="host",e.Webview="webview"}(B||(B={}));const K=new U.RequestType(`${B.Host}/bootstrap`);const H=new U.RequestType(`${B.Host}/login`),G=new U.RequestType(`${B.Host}/logout`),Q=new U.RequestType(`${B.Host}/login/sso`),J=new U.RequestType(`${B.Host}/validateThirdPartyAuth`),Z=new U.RequestType(`${B.Host}/signup/complete`),X=new U.RequestType(`${B.Host}/webview/reload`),Y=new U.RequestType(`${B.Host}/marker/compare`),ee=new U.RequestType(`${B.Host}/marker/apply`),te=new U.RequestType(`${B.Host}/configuration/update`),ne=new U.RequestType(`${B.Host}/editor/range/highlight`),re=new U.RequestType(`${B.Host}/editor/range/reveal`),ie=new U.RequestType(`${B.Host}/editor/range/select`),oe=new i.NotificationType(`${B.Host}/editor/scrollTo`),se=new U.NotificationType(`${B.Webview}/editor/didChangeActive`),ae=new U.NotificationType(`${B.Webview}/config/didChange`),ce=new U.NotificationType(`${B.Webview}/editor/didChangeSelection`),ue=new U.NotificationType(`${B.Webview}/editor/didChangeVisibleRanges`),le=new U.NotificationType(`${B.Webview}/focus/didChange`),de=new U.NotificationType(`${B.Webview}/didLogout`),he=(new U.RequestType(`${B.Host}/vsls/invite`),new U.RequestType(`${B.Host}/vsls/join`),new U.RequestType(`${B.Host}/vsls/start`),new U.NotificationType(`${B.Host}/didInitialize`)),fe=new U.NotificationType(`${B.Host}/context/didChange`),pe=new U.NotificationType(`${B.Webview}/codemark/show`),ge=new U.NotificationType(`${B.Webview}/stream/show`),me=new U.NotificationType(`${B.Webview}/codemark/new`);var ve=n(17);const ye="did-change-selection",we="did-change-editor",be="did-change-visible-ranges";class editor_observer_EditorObserver{constructor(){this.emitter=new I.Emitter,this.subscriptions=new I.CompositeDisposable,this.subscriptions.add(atom.workspace.observeActiveTextEditor(e=>{if(this.emitter.emit(we,e),e){const t=new I.CompositeDisposable(e.observeSelections(t=>{const n=function(e,t=500){let n,r=[];const i=function(...i){r=i,n||(n=setTimeout(()=>{n=void 0,e(...r)},t))};return i.cancel=(()=>{n&&clearTimeout(n)}),i}(t=>{t.newBufferRange.isEqual(t.oldBufferRange)||t.newBufferRange.isEmpty()||this.emitter.emit(ye,{editor:e,range:t.selection.getBufferRange(),cursor:e.getCursorBufferPosition()})});t.onDidChangeRange(n),t.onDidDestroy(()=>{n.cancel()})}),e.onDidDestroy(()=>t.dispose()),e.displayLayer.onDidChange(()=>{this.emitter.emit(be,e)})),n=atom.views.getView(e);n&&t.add(e.onDidRequestAutoscroll(async t=>{await n.getNextUpdatePromise(),window.requestIdleCallback(()=>{this.emitter.emit(be,e)})}),n.onDidChangeScrollTop(async()=>{await n.getNextUpdatePromise(),this.emitter.emit(be,e)})),this.subscriptions.add(t)}}))}onDidChangeSelection(e){return this.emitter.on(ye,e)}onDidChangeActiveEditor(e){return this.emitter.on(we,e)}onDidChangeVisibleRanges(e){return this.emitter.on(be,e)}dispose(){this.subscriptions.dispose(),this.emitter.dispose()}}var _e,Se=n(39),Ce=n.n(Se);!function(e){e.Production="Production",e.PD="PD",e.QA="QA"}(_e||(_e={}));const Te={name:_e.Production,serverUrl:"https://api.codestream.com"},Re={name:_e.PD,serverUrl:"https://pd-api.codestream.us:9443"},ke={name:_e.QA,serverUrl:"https://qa-api.codestream.us"};var Ee=n(26);const xe={workspace:{applyEdit:!0,configuration:!0,workspaceEdit:{documentChanges:!0},workspaceFolders:!0,didChangeConfiguration:{dynamicRegistration:!1},didChangeWatchedFiles:{dynamicRegistration:!1},symbol:{dynamicRegistration:!1},executeCommand:{dynamicRegistration:!1}},textDocument:{synchronization:{dynamicRegistration:!1,willSave:!0,willSaveWaitUntil:!0,didSave:!0},completion:{dynamicRegistration:!1,completionItem:{snippetSupport:!0,commitCharactersSupport:!1},contextSupport:!0},hover:{dynamicRegistration:!1},signatureHelp:{dynamicRegistration:!1},references:{dynamicRegistration:!1},documentHighlight:{dynamicRegistration:!1},documentSymbol:{dynamicRegistration:!1,hierarchicalDocumentSymbolSupport:!0},formatting:{dynamicRegistration:!1},rangeFormatting:{dynamicRegistration:!1},onTypeFormatting:{dynamicRegistration:!1},definition:{dynamicRegistration:!1},codeAction:{dynamicRegistration:!1},codeLens:{dynamicRegistration:!1},documentLink:{dynamicRegistration:!1},rename:{dynamicRegistration:!1},implementation:void 0,typeDefinition:void 0,colorProvider:void 0,foldingRange:void 0},experimental:{}};var De,Pe=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ae=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Oe=function(){const e={};return Object.entries(i.MessageType).forEach(([t,n])=>{e[n]=t.toLowerCase()}),e}();class agent_AgentConnection{constructor(){this._initializedEvent=new utils_Echo,this._terminatedEvent=new utils_Echo,this._initialized=!1}get initialized(){return this._initialized}get connection(){return this._connection}onDidInitialize(e){return this._initializedEvent.add(e)}onDidTerminate(e){return this._terminatedEvent.add(e)}getInitializationOptions(){return{}}async start(){this._agentProcess=await this.startServer();const e=Object(U.createMessageConnection)(new U.IPCMessageReader(this._agentProcess),new U.IPCMessageWriter(this._agentProcess));this._connection=new q.LanguageClientConnection(e),this.preInitialization(this._connection,e);const t=Object.assign({extension:{build:"",buildEnv:"dev",version:Xe(),versionFormatted:`${Xe()}${atom.inDevMode()?"(dev)":""}`},ide:{name:"Atom",version:atom.getVersion()},isDebugging:atom.inDevMode(),traceLevel:container_Container.configs.get("traceLevel"),gitPath:"git"},this.getInitializationOptions()),n=container_Container.configs,r=n.get("proxySupport");if("override"===r){const e=n.get("proxyUrl");""!==e?(t.proxy={url:e,strictSSL:n.get("proxyStrictSSL")},t.proxySupport="override"):(atom.notifications.addWarning("CodeStream: Invalid Proxy Settings",{dismissable:!0,detail:"We'll attempt to detect proxy settings from the shell environment.",description:"Proxy Support set to `override` but a Proxy Url was not provided."}),t.proxySupport="on")}else t.proxySupport=r;const i=atom.project.getPaths()[0],o=await this._connection.initialize({processId:this._agentProcess.pid,workspaceFolders:[],rootUri:i?q.Convert.pathToUri(i):null,capabilities:xe,initializationOptions:t});return o.result.error?await this.stop():(this._connection.initialized(),this._initialized=!0,this._initializedEvent.push()),o.result}buildSpawnArgs(){return Ye.isDebugging()?["node",["--no-lazy","--inspect=6012",Ze("dist/agent/agent.js"),"--node-ipc"]]:[process.execPath,["--no-lazy",Ze("dist/agent/agent.js"),"--node-ipc"]]}startServer(){const e={};e.env=Object.create(process.env),e.env.ELECTRON_RUN_AS_NODE="1",e.env.ELECTRON_NO_ATTACH_CONSOLE="1",e.stdio=[null,null,null,"ipc"];const[t,n]=this.buildSpawnArgs(),r=Object(Ee.spawn)(t,n,e);return Ye.isDebugging()&&(console.debug("CodeStream agent pid",r.pid),console.debug("spawned with",t,n)),r.on("error",e=>{console.error(e)}),r.on("disconnect",()=>{Ye.isDebugging()&&this._connection&&this._connection.isConnected&&console.warn("CodeStream agent process disconnected prematurely"),this.stop()}),r.on("exit",e=>{0!==Number(e)&&console.error(`CodeStream agent process exited with non-zero exit code ${e}`),this.stop()}),r}async stop(){this._connection.dispose(),this._agentProcess.kill(),this._terminatedEvent.push(),this._terminatedEvent.dispose()}}const Me="data-changed";class agent_CodeStreamAgent extends agent_AgentConnection{constructor(e){super(),this.environment=e,this.emitter=new I.Emitter,this.subscriptions=new I.CompositeDisposable,this.logger=new logger_FileLogger("agent"),this.onLogMessage=(e=>{this.logger.log(Oe[e.type],e.message)})}getInitializationOptions(){return{serverUrl:this.environment.serverUrl}}preInitialization(e,t){t.onRequest("client/registerCapability",t=>{t.registrations.forEach(t=>{t.method===i.DidChangeWorkspaceFoldersNotification.type.method&&this.subscriptions.add(atom.project.onDidChangePaths(()=>{e.sendCustomNotification(i.DidChangeWorkspaceFoldersNotification.type.method,{event:{added:atom.project.getDirectories().map(e=>({uri:q.Convert.pathToUri(e.getPath()),name:e.getBaseName()})),removed:[]}})}))})}),t.onRequest("workspace/configuration",e=>e.items.map(({section:e})=>{const t={};if("files.exclude"===e||"search.exclude"===e){const e=atom.config.get("core.ignoredNames");for(const n of e)t[n]=!0;return t}})),t.onRequest("workspace/workspaceFolders",()=>atom.project.getDirectories().map(e=>({uri:q.Convert.pathToUri(e.getPath()),name:e.getBaseName()}))),this.subscriptions.add(atom.workspace.observeTextEditors(t=>{const n=t.getPath();n&&(e.didOpenTextDocument({textDocument:{uri:et.getUri(t),languageId:"",version:t.getBuffer().createCheckpoint(),text:t.getText()}}),this.subscriptions.add(t.onDidDestroy(()=>e.didCloseTextDocument({textDocument:{uri:et.getUri(t)}})),t.onDidChange(()=>{e.didChangeTextDocument({textDocument:{uri:et.getUri(t),version:t.createCheckpoint()},contentChanges:[{text:t.getText()}]})}),t.onDidChangePath(r=>{e.didCloseTextDocument({textDocument:{uri:q.Convert.pathToUri(n)}}),e.didOpenTextDocument({textDocument:{uri:q.Convert.pathToUri(r),languageId:"",version:t.getBuffer().createCheckpoint(),text:t.getText()}})})))})),e.onLogMessage(this.onLogMessage),e.onCustom(a.method,e=>{this.emitter.emit(Me,e)}),e.onCustom(c.method,e=>{this.emitter.emit(c.method,e)}),e.onCustom(o.method,e=>this.emitter.emit(o.method,e))}onDidChangeData(e){return this.emitter.on(Me,e)}onDidChangeDocumentMarkers(e){return this.emitter.on(c.method,e)}onDidChangeConnectionStatus(e){return this.emitter.on(o.method,e)}telemetry(e){this.request(R,e)}request(e,t){return this.connection.sendCustomRequest(e.method,t)}sendRequest(e,t){return this.connection.sendCustomRequest(e,t)}dispose(){this.logger.dispose(),this.emitter.dispose(),this.subscriptions.dispose(),this.stop()}}function Ie(e,t,n){const r=n.value;return n.value=async function(...e){return this.initialized||await this.start(),r.apply(this,e)},n}Pe([Ie,Ae("design:type",Function),Ae("design:paramtypes",[Object]),Ae("design:returntype",void 0)],agent_CodeStreamAgent.prototype,"telemetry",null),Pe([Ie,Ae("design:type",Function),Ae("design:paramtypes",["function"==typeof(De="undefined"!=typeof RT&&RT)?De:Object,Object]),Ae("design:returntype",Promise)],agent_CodeStreamAgent.prototype,"request",null),Pe([Ie,Ae("design:type",Function),Ae("design:paramtypes",[String,Object]),Ae("design:returntype",Promise)],agent_CodeStreamAgent.prototype,"sendRequest",null);var qe,Ne,je=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Le=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e[e.SignedOut=0]="SignedOut",e[e.SigningIn=1]="SigningIn",e[e.SignedIn=2]="SignedIn"}(Ne||(Ne={}));const Fe="session-status-changed";class workspace_session_WorkspaceSession{constructor(e,t,n=Te){this.subscriptions=new I.CompositeDisposable,this._sessionStatus=Ne.SignedOut,this.emitter=new I.Emitter,this._agent=new agent_CodeStreamAgent(n),this.session=e,this.lastUsedEmail=t,this.envConfig=n,this.initialize()}get agent(){return this._agent}get ready(){return this._isReady}static create(e){return new workspace_session_WorkspaceSession(e.session,e.lastUsedEmail,e.environment)}initialize(){this._isReady=new Promise(async(e,t)=>{try{if(await this.initializeAgent(),container_Container.configs.get("autoSignIn")&&this.session){await this.login(h,{token:this.session.token})!==O.Success&&(this.session=void 0)}e()}catch(e){t()}})}async initializeAgent(){this._agent.initialized||(await this.agent.start(),this.subscriptions.add(this._agent.onDidTerminate(()=>{this._agent=new agent_CodeStreamAgent(this.environment),this.initialize()})))}get isSignedIn(){return this._sessionStatus===Ne.SignedIn}serialize(){return{session:this.session,lastUsedEmail:this.session?this.session.user.email:this.lastUsedEmail,environment:this.envConfig}}dispose(){this.subscriptions.dispose(),this.signOut()}observeSessionStatus(e){return e(this.status),this.onDidChangeSessionStatus(t=>e(t.current))}onDidChangeSessionStatus(e){return this.emitter.on(Fe,e)}set sessionStatus(e){if(this._sessionStatus!==e){const t=this._sessionStatus;this._sessionStatus=e,this.emitter.emit(Fe,{current:e,previous:t})}}get status(){return this._sessionStatus}get user(){return this.session&&this.session.user}get teamId(){return this.session&&this.session.teamId}get environment(){return this.envConfig}get capabilities(){const e={codemarkApply:!0,codemarkCompare:!0,editorTrackVisibleRange:!0,openLink:!0,services:{}};return this.agentCapabilities?Object.assign({},e,this.agentCapabilities):e}getBootstrapInfo(){return{capabilities:this.capabilities,configs:container_Container.configs.getForWebview(this.environment.serverUrl,this.lastUsedEmail),version:Xe(),loginToken:this.getLoginToken()}}getTeamPreference(){if(this.session)return{teamId:this.session.teamId};const e=container_Container.configs.get("team");return e.length>0?{team:e}:{}}getLoginToken(){return this.loginToken||(this.loginToken=Ce()()),this.loginToken}async login(e,t){this.sessionStatus=Ne.SigningIn;try{const n=await this._agent.request(e,Object.assign({},t,this.getTeamPreference()));return function(e){return void 0!==e.error}(n)?(this.sessionStatus=Ne.SignedOut,n.error):(await this.completeLogin(n),this.sessionStatus=Ne.SignedIn,O.Success)}catch(e){return this.sessionStatus=Ne.SignedOut,"string"==typeof e?(atom.notifications.addError("Error logging in: ",{detail:e}),e):(console.error("Unexpected error signing into CodeStream",e),O.Unknown)}}completeLogin(e){this.session={user:e.loginResponse.user,teamId:e.state.teamId,token:{url:this.environment.serverUrl,email:e.loginResponse.user.email,value:e.loginResponse.accessToken}},this.lastUsedEmail=e.loginResponse.user.email,this.agentCapabilities=e.state.capabilities,this.sessionStatus=Ne.SignedIn}signOut(){this.session&&(this.session=void 0,this.sessionStatus=Ne.SignedOut),this._agent.dispose()}changeEnvironment(e){this.envConfig=e,this.signOut()}}je([function(e,t,n){const r=n.value;return n.value=async function(...e){return await this.initializeAgent(),r.apply(this,e)},n},Le("design:type",Function),Le("design:paramtypes",["function"==typeof(qe="undefined"!=typeof RT&&RT)?qe:Object,Object]),Le("design:returntype",Promise)],workspace_session_WorkspaceSession.prototype,"login",null);class WebviewIpc{constructor(){this.channel=new MessageChannel}get host(){return this.channel.port1}get webview(){return this.channel.port2}}const $e="atom://codestream",We="webview-ready",Ue="state-changed",ze="will-destroy";class codestream_view_CodestreamView{constructor(e,t){this.timestamp=Date.now(),this.onSelectionChanged=(e=>{this.sendEvent(ce,{uri:et.getUri(e.editor),selections:et.getCSSelections(e.editor),visibleRanges:et.getVisibleRanges(e.editor),lineCount:e.editor.getLineCount()})}),this.onEditorActiveEditorChanged=(e=>{const t={},n=e&&et.getRelativePath(e);e&&(t.editor={fileName:n||"",uri:et.getUri(e),visibleRanges:et.getVisibleRanges(e),selections:et.getCSSelections(e),metrics:{lineHeight:e.getLineHeightInPixels(),fontSize:atom.config.get("editor.fontSize")},lineCount:e.getLineCount()}),this.sendEvent(se,t)}),this.session=e,this.webviewContext=t,this.logger=new logger_FileLogger("webview"),this.channel=new WebviewIpc,this.emitter=new I.Emitter,this.subscriptions=new I.CompositeDisposable,this.element=document.createElement("div"),this.element.classList.add("codestream"),this.iframe=document.createElement("iframe"),this.initializeWebview(this.iframe),this.initialize(),this.setupWebviewListener()}getTitle(){return"CodeStream"}getIconName(){return"comment-discussion"}getDefaultLocation(){return"right"}getAllowedLocations(){return["right","left"]}isPermanentDockItem(){return!1}getPreferredWidth(){return 300}getURI(){return $e}async show(e,t){await atom.workspace.open(this,{activatePane:!0}),await this.webviewReady,e&&this.sendEvent(ge,{streamId:e,threadId:t})}async showCodemark(e,t){await this.show(),this.sendEvent(pe,{codemarkId:e,sourceUri:t})}async getHtml(){return!Ye.isDebugging()&&this._html?this._html:new Promise((e,t)=>{N.readFile(Ze("dist/webview/index.html"),"utf8",(n,r)=>{if(n)return t(n);this._html=r.replace(/{{root}}/g,Ze(".")),e(this._html)})})}async initializeWebview(e){e.height="100%",e.width="100%",e.style.border="none",e.srcdoc=await this.getHtml(),e.classList.add("webview","native-key-bindings"),e.addEventListener("load",async()=>{e.contentWindow.postMessage({label:"codestream-webview-initialize",styles:await container_Container.styles.getStylesheets(),isDebugging:Ye.isDebugging()},"*",[this.channel.webview]),e.contentWindow.addEventListener("message",({data:e})=>{switch(e.label){case"open-link":ve.shell.openExternal(e.link);break;case"log":{const{type:t,message:n,args:r}=e;this.logger.log(t,n,JSON.stringify(r))}}})}),this.subscriptions.add(container_Container.styles.onDidChange(t=>{e.contentWindow&&e.contentWindow.postMessage({label:"update-styles",styles:t},"*")})),this.iframe=e,this.element.append(e)}observeWorkspace(){this.editorSelectionObserver=new editor_observer_EditorObserver,this.editorSelectionObserver.onDidChangeSelection(this.onSelectionChanged),this.editorSelectionObserver.onDidChangeActiveEditor(this.onEditorActiveEditorChanged),this.editorSelectionObserver.onDidChangeVisibleRanges(e=>{this.sendEvent(ue,{uri:et.getUri(e),selections:et.getCSSelections(e),visibleRanges:et.getVisibleRanges(e),lineCount:e.getLineCount()})})}initialize(){const e=()=>this.sendEvent(le,{focused:!1}),t=()=>this.sendEvent(le,{focused:!0}),n=ve.remote.getCurrentWindow();n.on("focus",t),n.on("blur",e),this.session.isSignedIn&&this.observeWorkspace(),this.subscriptions.add(new I.Disposable(()=>{n.removeListener("blur",e),n.removeListener("focus",t)}),this.session.agent.onDidChangeData(e=>this.sendEvent(a,e)),this.session.onDidChangeSessionStatus(e=>{e.current===Ne.SignedOut&&e.previous!==Ne.SigningIn&&(this.sendEvent(de,{}),this.editorSelectionObserver&&this.editorSelectionObserver.dispose()),e.current===Ne.SignedIn&&this.observeWorkspace()}),this.session.agent.onDidChangeDocumentMarkers(e=>this.sendEvent(c,e)),container_Container.configs.onDidChangeWebviewConfig(e=>this.sendEvent(ae,e)),this.session.agent.onDidChangeConnectionStatus(e=>{switch(e.status){case r.Disconnected:break;case r.Reconnecting:this.sendEvent(o,e);break;case r.Reconnected:if(e.reset){this.destroy(),atom.workspace.open($e);break}this.sendEvent(o,e)}})),this.webviewReady=new Promise(e=>this.subscriptions.add(this.emitter.on(We,()=>{e()})))}serialize(){return{deserializer:"codestream/CodestreamView"}}destroy(){this.emitter.emit(ze),this.element.remove(),this.subscriptions.dispose(),this.editorSelectionObserver&&this.editorSelectionObserver.dispose(),this.logger.dispose()}onWillDestroy(e){return this.emitter.on(ze,e)}onDidChangeState(e){return this.emitter.on(Ue,e)}checkToToggleMarkers(){if(!this.webviewContext||!container_Container.session.isSignedIn)return;const e=container_Container.configs;!0===e.get("showMarkers")&&!0===e.get("autoHideMarkers")&&(this.webviewContext.panelStack[0]===V.CodemarksForFile?!function(e){const t=atom.workspace.paneContainerForURI(e);if(t){const n=t.getActivePaneItem();if(!n)return!1;const r=n.getURI&&n.getURI()===e;return Ke(t)?t.isVisible()&&r:r}return!1}(this.getURI())?container_Container.markerDecorationProvider.enable():container_Container.markerDecorationProvider.disable():container_Container.markerDecorationProvider.enable())}async getSignedInBootstrapState(){await this.session.ready;const e=await this.session.agent.request(S,{}),t=atom.workspace.getActiveTextEditor();let n={};if(t){const e=et.getUri(t);n={activeFile:et.getRelativePath(t),textEditorUri:e,textEditorVisibleRanges:et.getVisibleRanges(t),textEditorSelections:et.getCSSelections(t),scmInfo:await this.session.agent.request(w,{uri:e}),textEditorLineCount:t.getLineCount()}}return Object.assign({},this.session.getBootstrapInfo(),e,{session:{userId:this.session.user.id},context:Object.assign({},this.webviewContext,{currentTeamId:this.session.teamId}),editorContext:n})}setupWebviewListener(){this.channel.host.onmessage=(({data:e})=>{if(function(e){return null!=e.method&&null!=e.id}(e)){return"host"===e.method.split("/")[0]?this.handleWebviewCommand(e):this.forwardWebviewRequest(e)}this.onWebviewNotification(e)})}async forwardWebviewRequest(e){const t=await this.session.agent.sendRequest(e.method,e.params);this.respond({id:e.id,params:t})}async handleWebviewCommand(e){switch(e.method){case K.method:try{await this.session.ready;const t=this.session.isSignedIn?await this.getSignedInBootstrapState():Object.assign({},this.session.getBootstrapInfo(),{context:this.webviewContext});this.respond({id:e.id,params:t})}catch(t){this.respond({id:e.id,error:t.message})}break;case Q.method:{const{provider:t}=e.params;ve.shell.openExternal(`${this.session.environment.serverUrl}/web/provider-auth/${t}?signupToken=${this.session.getLoginToken()}`)?this.respond({id:e.id,params:!0}):this.respond({id:e.id,error:"No app found to open url"});break}case J.method:{const t=e.params,n=await this.session.login(f,Object.assign({code:this.session.getLoginToken()},t));if(n!==O.Success)this.respond({id:e.id,error:n});else{const t=await this.getSignedInBootstrapState();this.respond({id:e.id,params:t})}break}case Z.method:{const{teamId:t,token:n,email:r}=e.params,i=await this.session.login(h,{teamId:t,token:{email:r,url:this.session.environment.serverUrl,value:n}});if(i!==O.Success)this.respond({id:e.id,error:i});else{const t=await this.getSignedInBootstrapState();this.respond({id:e.id,params:t})}break}case H.method:{const t=e.params,n=await this.session.login(d,t);if(n!==O.Success)this.respond({id:e.id,error:n});else{const t=await this.getSignedInBootstrapState();this.respond({id:e.id,params:t})}break}case te.method:{const{name:t,value:n}=e.params;container_Container.configs.isUserSetting(t)&&container_Container.configs.set(t,n),this.respond({id:e.id,params:{}}),this.sendEvent(ae,{[t]:n});break}case ne.method:{const{uri:t,highlight:n,range:r}=e.params;container_Container.editorManipulator.highlight(n,q.Convert.uriToPath(t),q.Convert.lsRangeToAtomRange(r));break}case ie.method:{const{selection:t,uri:n,preserveFocus:r}=e.params;await container_Container.editorManipulator.select(q.Convert.uriToPath(n),q.Convert.lsRangeToAtomRange(t)),r&&atom.views.getView(this).focus();break}case re.method:{const{uri:t,range:n}=e.params;atom.workspace.getTextEditors().some(e=>e.getPath()===q.Convert.uriToPath(t)&&(e.scrollToBufferPosition(q.Convert.lsRangeToAtomRange(n).start),!0));break}case Y.method:{const{marker:t}=e.params;await container_Container.diffController.showDiff(t),this.respond({id:e.id,params:{}});break}case ee.method:{const{marker:t}=e.params;await container_Container.diffController.applyPatch(t),this.respond({id:e.id,params:{}});break}case G.method:this.session.signOut(),this.respond({id:e.id,params:{}});break;case X.method:container_Container.viewController.reload(this.getURI());break;default:Ye.isDebugging()?(atom.notifications.addWarning(`Unhandled webview message: ${e.method}`),atom.inDevMode()&&container_Container.configs.get("traceLevel")===_.Debug&&atom.notifications.addWarning(`Unhandled webview request: ${e.method}`)):container_Container.session.isSignedIn&&container_Container.session.agent.request(T,{type:C.Warning,message:`Unhandled request from webview: ${e.method}`,source:"extension"})}}onWebviewNotification(e){switch(e.method){case he.method:Ye.isDebugging()&&console.debug(`CodeStream view created and interactive in ${Date.now()-this.timestamp} `),this.emitter.emit(We);break;case fe.method:this.webviewContext=e.params.context,this.emitter.emit(Ue,e.params.context),this.checkToToggleMarkers();break;case oe.method:{const{atTop:t,uri:n,position:r,deltaPixels:i}=e.params,o=atom.workspace.getTextEditors().find(e=>et.getUri(e)===n);if(!o)return;t?o.setScrollTopRow(o.screenRowForBufferRow(r.line)):o.element.setScrollTop(o.element.getScrollTop()+i);break}default:container_Container.session.agent.request(T,{type:C.Warning,message:`Unhandled notification from webview: ${e.method}`,source:"extension"}),atom.inDevMode()&&container_Container.configs.get("traceLevel")===_.Debug&&atom.notifications.addWarning(`Unhandled webview notification: ${e.method}`)}}respond(e){this.channel.host.postMessage(e)}sendEvent(e,t){this.channel.host.postMessage({method:e.method,params:t})}newCodemarkRequest(e,t){const n=atom.workspace.getActiveTextEditor();if(void 0===n)return;const r=et.getUri(n),i=et.getCurrentSelectionRange(n);this.sendEvent(me,{type:e,uri:r,range:i,source:t}),n.setSelectedBufferRange(q.Convert.lsRangeToAtomRange(i))}}const Ve={[$e]:{state:{}}},Be=[atom.workspace.getCenter(),atom.workspace.getLeftDock(),atom.workspace.getRightDock(),atom.workspace.getBottomDock()];function Ke(e){return"center"!==e.getLocation()}class controller_ViewController{constructor(e,t=Ve){this.session=e,this.viewState=t,this.subscriptions=new I.CompositeDisposable,this.subscriptions.add(atom.workspace.addOpener(e=>this.getView(e)),atom.commands.add("atom-workspace","codestream:toggle",()=>atom.workspace.toggle($e))),Be.map(e=>{this.subscriptions.add(e.onDidStopChangingActivePaneItem(e=>{this.mainView&&this.mainView.checkToToggleMarkers()})),Ke(e)&&this.subscriptions.add(e.onDidChangeVisible(e=>{this.mainView&&this.mainView.checkToToggleMarkers()}))})}getMainView(){return this.mainView?this.mainView:(this.mainView=new codestream_view_CodestreamView(this.session,this.viewState[$e].state),this.subscriptions.add(this.mainView.onDidChangeState(e=>{this.viewState[$e]={state:e}}),this.mainView.onWillDestroy(()=>this.mainView=void 0)),this.mainView)}getView(e){if(e===$e)return this.getMainView()}reload(e){const t=atom.workspace.paneForURI(e);if(!t)return;const n=t.itemForURI(e);if(!n)return;n.destroy&&n.destroy(),this.viewState[e]&&(this.viewState[e].state=void 0);const r=t.onDidRemoveItem(t=>{t.item===n&&(atom.workspace.toggle(e),r.dispose())});t.destroyItem(n)}serialize(){return this.viewState}dispose(){this.subscriptions.dispose(),this.mainView&&this.mainView.destroy()}}class styles_getter_StylesProvider{constructor(){this.webviewStylesPath=Ze("/dist/webview/styles/webview.less"),this.codestreamComponentsStylesDir=Ze("../codestream-components/styles"),this.distComponentsStylesDir=Ze("dist/webview/styles/"),this.webviewLibStylesPath=Ze("/webview-lib/webview.less"),this.changeEmitter=new utils_Echo,this.subscriptions=new I.CompositeDisposable,this._csStyles="",this._atomStyles=[],this.readyPromise=new Promise(e=>{const t=atom.packages.onDidActivatePackage(n=>{"codestream"===n.name&&(this.buildStyles(),e(),t.dispose())})})}get csStyles(){return this._csStyles}get atomStyles(){return this._atomStyles}static create(){const e=new styles_getter_StylesProvider;return e.initialize(),e}initialize(){this.subscriptions.add(atom.themes.onDidChangeActiveThemes(async()=>{this.buildStyles(),this.notifyListeners()})),Ye.isDebugging()&&N.exists(this.codestreamComponentsStylesDir,async e=>{e&&this.subscriptions.add(await Object(I.watchPath)(this.codestreamComponentsStylesDir,{},e=>{try{N.copySync(this.codestreamComponentsStylesDir,this.distComponentsStylesDir),this.buildCSStyles(),this.notifyListeners()}catch(e){atom.notifications.addError("CodeStream: could not copy codestream-components styles into `dist/`",{dismissable:!0,detail:e.message})}}),await Object(I.watchPath)(this.webviewLibStylesPath,{},e=>{N.copyFile(this.webviewLibStylesPath,this.webviewStylesPath,e=>{if(e)return atom.notifications.addError("CodeStream: could not copy styles into `dist/`",{dismissable:!0,detail:e.message});this.buildCSStyles(),this.notifyListeners()})}))})}dispose(){this.subscriptions.dispose()}onDidChange(e){return this.changeEmitter.add(e)}async notifyListeners(){this.changeEmitter.push(await this.getStylesheets())}buildStyles(){this.buildCSStyles(),this.buildAtomStyles()}buildCSStyles(){this._csStyles=atom.themes.loadLessStylesheet(this.webviewStylesPath)}buildAtomStyles(){const e=atom.styles.getStyleElements(),[t,n,...r]=e,[i,o]=r.reverse();this._atomStyles=[t.innerHTML,n.innerHTML,i.innerHTML,o.innerHTML]}async getStylesheets(){return await this.readyPromise,[...this.atomStyles,this.csStyles]}}var He=n(27);class diff_controller_DiffController{constructor(){this.splitDiffServiceInitEmitter=new utils_Echo,Je("split-diff")||He.install("codestream")}set splitDiffService(e){void 0!==e&&this.splitDiffServiceInitEmitter.push(),this._splitDiffService=e}dispose(){this.splitDiffServiceInitEmitter.dispose()}async applyPatch(e){const t=await container_Container.session.agent.request(y,{markerId:e.id,repoId:e.repoId});if(void 0===t)return;const n=q.Convert.uriToPath(t.textDocument.uri);atom.project.contains(n)&&(await atom.workspace.open(n)).setTextInBufferRange(q.Convert.lsRangeToAtomRange(t.range),t.marker.code)}async showDiff(e){await this.ensureSplitDiffEnabled();const t=await container_Container.session.agent.request(y,{markerId:e.id,repoId:e.repoId}),n=atom.workspace.getActiveTextEditor();if(void 0===t)return;const r=await function(e,t=""){const n=L.join(j.tmpdir(),e);return new Promise((e,r)=>{N.writeFile(n,t,t=>{t?r(t):e(n)})})}(`codestream-diff-${L.basename(e.file)}`,n.getText()),i=await atom.workspace.createItemForURI(r);i.setTextInBufferRange(q.Convert.lsRangeToAtomRange(t.range),t.marker.code),await i.save(),i.setReadOnly(!0),atom.workspace.getCenter().getActivePane().splitRight({items:[i],copyActiveItem:!1}),container_Container.editorManipulator.scrollIntoView(i,t.range.start.line,{center:!0}),this._splitDiffService.diffEditors(n,i,{muteNotifications:!0})}async ensureSplitDiffEnabled(){if(void 0===this._splitDiffService){if(atom.packages.isPackageDisabled("split-diff"))return void atom.notifications.addWarning("The split-diff package is disabled",{description:"Please enable it to view codemark diffs"});try{await new Promise(async(e,t)=>{const n=this.splitDiffServiceInitEmitter.add(()=>{e(),n.dispose()});await He.install("codestream"),Je("split-diff")||t()})}catch(e){return void atom.notifications.addInfo("Installation of split-diff cancelled")}}}}class editor_manipulator_EditorManipulator{constructor(){this.highlights=new Map}dispose(){this.highlights.forEach(e=>e.dispose())}async open(e,t=!1){return new Promise(n=>{Object(N.exists)(e,async r=>{r||t?n(atom.workspace.open(e)):n()})})}scrollIntoView(e,t,n={center:!0}){e.scrollToBufferPosition(new I.Point(t,0),n)}async highlight(e,t,n){const r=await this.open(t);if(!r)return!1;if(e){this.scrollIntoView(r,n.start.row,{center:!1});const e=r.markBufferRange(n,{invalidate:"never"});r.decorateMarker(e,{type:"highlight",class:"codestream-highlight"}),this.highlights.set(e.id,new I.CompositeDisposable(new I.Disposable(()=>{e.destroy()}),r.onDidChangeSelectionRange(()=>this.removeHighlight(e.id))))}else{r.findMarkers({startBufferRow:n.start.row}).forEach(e=>{this.removeHighlight(e.id)})}return!0}removeHighlight(e){const t=this.highlights.get(e);t&&t.dispose()}async select(e,t){const n=await this.open(e);n&&(t.isEmpty()?this.scrollIntoView(n,t.start.row):n.setSelectedBufferRange(t))}}class MapWithDefaults extends Map{constructor(e,t){super(t),this.createDefault=e}get(e){let t=super.get(e);return t||(t=this.createDefault(e),this.set(e,t),t)}}class marker_decoration_provider_MarkerDecorationProvider{constructor(e,t){this.observedEditors=new Map,this.gutters=new Map,this.markers=new MapWithDefaults(()=>[]),this.editorResources=new MapWithDefaults(()=>new I.CompositeDisposable),this.sessionSubscriptions=new I.CompositeDisposable,this.isDisabled=!1,this.onActiveEditor=(e=>{if(!this.isDisabled&&e&&e.getPath())if(this.observedEditors.has(e.id))this.provideFor(e);else{const t=e.id;this.observedEditors.set(t,e),this.provideFor(e);const n=this.editorResources.get(e.id);n.add(e.onDidDestroy(()=>{this.observedEditors.delete(t),n.dispose()}))}}),this.session=e,this.viewController=t,this.subscriptions=new I.CompositeDisposable(e.observeSessionStatus(e=>{switch(e){case Ne.SignedOut:this.reset();break;case Ne.SignedIn:container_Container.configs.get("showMarkers")&&this.initialize()}}),container_Container.configs.onDidChange("showMarkers",({newValue:e})=>!0===e?this.initialize():this.reset()))}initialize(){this.sessionSubscriptions.add(atom.workspace.observeActiveTextEditor(this.onActiveEditor),this.session.agent.onDidChangeDocumentMarkers(({textDocument:e})=>{for(const t of this.observedEditors.values())if(et.getUri(t)===e.uri){this.provideFor(t);break}}))}async provideFor(e){const t=await this.session.agent.request(m,{textDocument:{uri:q.Convert.pathToUri(e.getPath())}});t&&t.markers&&(t.markers=t.markers.filter(e=>"none"!==e.codemark.color&&(e.codemark.type!==E.Issue||e.codemark.status===x.Open)),this.editorResources.has(e.id)&&this.editorResources.get(e.id).dispose(),this.editorResources.set(e.id,new I.CompositeDisposable(...t.markers.map(t=>this.decorate(e,t)))))}getGutter(e){let t=this.gutters.get(e.id);return t||(t=e.addGutter({name:`codestream-${e.id}`}),this.editorResources.get(e.id).add(t.onDidDestroy(()=>{this.gutters.delete(e.id)})),this.gutters.set(e.id,t)),t}decorate(e,t){const n=e.markBufferRange(q.Convert.lsRangeToAtomRange(t.range),{invalidate:"never"});this.markers.get(e.id).push(n);let r=t.codemark.color||"blue";r="none"===r?"":`-${r}`;const i=q.Convert.pathToUri(Ze(`dist/icons/marker-${t.codemark.type}${r}.svg`)),o=document.createElement("img");o.src=i;const s=document.createElement("div");s.onclick=(n=>{n.preventDefault(),this.viewController.getMainView().showCodemark(t.codemarkId,et.getUri(e)),container_Container.session.agent.telemetry({eventName:"Codemark Clicked",properties:{"Codemark Location":"Source File"}})}),s.classList.add("codemark"),s.appendChild(o),this.getGutter(e).decorateMarker(n,{item:s});const a=atom.tooltips.add(o,{title:`${t.creatorName}: ${t.summary}`,placement:"right"});return new I.CompositeDisposable(a,new I.Disposable(()=>{n.destroy(),s.remove()}),n.onDidDestroy(()=>{const t=this.markers.get(e.id);this.markers.set(e.id,t.filter(e=>!1===e.isDestroyed()))}))}reset(){this.observedEditors.clear(),this.gutters.forEach(e=>Ge(()=>e.destroy())),this.gutters.clear(),this.markers.forEach(e=>e.forEach(e=>Ge(()=>e.destroy()))),this.markers.clear(),this.editorResources.forEach(e=>e.dispose()),this.editorResources.clear(),this.sessionSubscriptions.dispose(),this.sessionSubscriptions=new I.CompositeDisposable}disable(){this.isDisabled||(this.isDisabled=!0,this.reset())}enable(){this.isDisabled&&(this.isDisabled=!1,this.initialize())}dispose(){this.reset(),this.subscriptions.dispose()}}class container_Container{static get markerDecorationProvider(){return this._markerDecorationProvider}static get configs(){return this._configs}static get session(){return this._session}static get viewController(){return this._viewController}static get styles(){return this._styles}static get editorManipulator(){return this._editorManipulator}static get diffController(){return this._diffController}static initialize(e){this._configs=new ConfigManager(e),this._styles=styles_getter_StylesProvider.create(),this._editorManipulator=new editor_manipulator_EditorManipulator,this._diffController=new diff_controller_DiffController,this._session=workspace_session_WorkspaceSession.create(e),this._viewController=new controller_ViewController(this._session,e.views),this._markerDecorationProvider=new marker_decoration_provider_MarkerDecorationProvider(this.session,this._viewController)}}const Ge=e=>{try{return e()}catch(e){return}};function Qe(){return atom.packages.getLoadedPackage("codestream")}function Je(e){return atom.packages.isPackageLoaded(e)&&!atom.packages.isPackageDisabled(e)}const Ze=e=>{const t=atom.packages.resolvePackagePath("codestream");if(!t)throw new Error("Atom could not find path for CodeStream package");return L.join(t,e)},Xe=()=>Qe().metadata.version;var Ye,et;!function(e){e.setDebugging=function(e){container_Container.configs.inMemory.debug=e},e.isDebugging=function(){return container_Container.configs.inMemory.debug},e.isSilent=function(){return container_Container.configs.get("traceLevel")===_.Silent}}(Ye||(Ye={})),function(e){e.selectRange=async function(e,t){e.setSelectedBufferRange(t)},e.getRelativePath=function(e){const t=e.getPath();return void 0===t?"":atom.project.relativize(t)},e.getUri=function(e){const t=e.getPath();return t?q.Convert.pathToUri(t):""},e.getCurrentSelectionRange=function(e){const t=e.getSelectedBufferRange(),n=q.Convert.atomRangeToLSRange(t);return t.isEmpty()?F.Range.create(n.start.line,0,n.start.line,e.lineTextForBufferRow(t.end.row).length):n},e.getCSSelections=function(e){return e.getSelections().map(t=>{const n=e.getCursorBufferPosition(),{start:r,end:i}=q.Convert.atomRangeToLSRange(t.getBufferRange());return{cursor:{line:n.row,character:n.column},start:r,end:i}})},e.getVisibleRanges=function(e){const t=[],n=e.getLastVisibleScreenRow();let r=e.getFirstVisibleScreenRow();for(let i=r;i<=n;i++){if(i===n){t.push(F.Range.create(e.bufferRowForScreenRow(r),0,e.bufferRowForScreenRow(i),e.getApproximateLongestScreenRow()));break}e.isFoldedAtScreenRow(i)&&(t.push(F.Range.create(e.bufferRowForScreenRow(r),0,e.bufferRowForScreenRow(i),e.getApproximateLongestScreenRow())),r=i+1)}return t}}(et||(et={}));class utils_Echo{constructor(){this.listeners=new Set}add(e){return this.listeners.add(e),new I.Disposable(()=>{this.listeners.delete(e)})}push(e){this.listeners.forEach(t=>t(e))}dispose(){this.listeners.clear()}}const tt=L.join(j.tmpdir(),"atom-codestream/logs");class logger_FileLogger{constructor(e){this._isReady=!1,this.fileName=`${e}.log`,this.filePath=L.join(tt,this.fileName),this.initialize()}async initialize(){try{await(e=tt,new Promise((t,n)=>{N.makeTree(e,e=>{e?n(e):t()})})),this._isReady=!0}catch(e){Ye.isSilent()||console.error("CodeStream: error creating log folder",e)}var e}async dispose(){try{await(e=this.filePath,new Promise((t,n)=>{N.unlink(e,e=>{e&&!e.message.includes("no such file or directory")?n(e):t()})}))}catch(e){Ye.isSilent()||console.error(`CodeStream: error deleting ${this.fileName}`,e)}var e}log(e,t,n=""){this._isReady&&N.appendFile(this.filePath,`[${e}]: ${t} ${n}\n`,e=>{e&&Ye.isSilent()&&console.error(`CodeStream: failed to write to ${this.fileName}`,e)})}}class codestream_CodestreamPackage{constructor(){this.subscriptions=new I.CompositeDisposable,this.environmentChangeEmitter=new utils_Echo,this.initialize()}async initialize(){const e=container_Container.session;this.subscriptions.add(e.observeSessionStatus(t=>{this.sessionStatusCommand&&this.sessionStatusCommand.dispose(),t===Ne.SignedIn&&(this.registerLoggedInCommands(),this.sessionStatusCommand=atom.commands.add("atom-workspace","codestream:sign-out",()=>{e.signOut()})),t===Ne.SignedOut&&(this.loggedInCommandsSubscription&&this.loggedInCommandsSubscription.dispose(),this.sessionStatusCommand=atom.commands.add("atom-workspace","codestream:sign-in",()=>{}))}));const t=!atom.inDevMode();this.subscriptions.add(atom.commands.add("atom-workspace","codestream:open-logs",()=>{atom.project.addPath(tt),atom.notifications.addInfo("The CodeStream log directory has been added to workspace")}),atom.commands.add("atom-workspace","codestream:reload-webview",{didDispatch:()=>{container_Container.viewController.reload($e)},hiddenInCommandPalette:t}),atom.commands.add("atom-workspace","codestream:point-to-qa",{didDispatch:()=>{e.changeEnvironment(ke),this.environmentChangeEmitter.push(ke)},hiddenInCommandPalette:t}),atom.commands.add("atom-workspace","codestream:point-to-dev",{didDispatch:()=>{e.changeEnvironment(Re),this.environmentChangeEmitter.push(Re)},hiddenInCommandPalette:t}),atom.commands.add("atom-workspace","codestream:point-to-production",{didDispatch:()=>{e.changeEnvironment(Te),this.environmentChangeEmitter.push(Te)},hiddenInCommandPalette:t}))}deserializeCodestreamView(){return container_Container.viewController.getMainView()}serialize(){return Object.assign({},container_Container.session.serialize(),{views:container_Container.viewController.serialize(),debug:Ye.isDebugging()})}deactivate(){this.environmentChangeEmitter.dispose(),container_Container.session.dispose(),this.subscriptions.dispose(),this.sessionStatusCommand.dispose(),container_Container.viewController.dispose(),container_Container.markerDecorationProvider.dispose(),container_Container.styles.dispose(),container_Container.editorManipulator.dispose(),this.loggedInCommandsSubscription&&this.loggedInCommandsSubscription.dispose()}provideEnvironmentConfig(){return{get:()=>container_Container.session.environment,onDidChange:e=>this.environmentChangeEmitter.add(e)}}provideDebugConfig(){return{set:e=>{Ye.setDebugging(e)},get:()=>Ye.isDebugging()}}registerLoggedInCommands(){const e=(e,t)=>{const n=container_Container.viewController.getMainView();n.show().then(()=>{n.newCodemarkRequest(e,t)})};this.loggedInCommandsSubscription=new I.CompositeDisposable(atom.commands.add("atom-workspace","codestream:context-create-comment",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Comment,"Context Menu")}),atom.commands.add("atom-workspace","codestream:context-create-issue",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Issue,"Context Menu")}),atom.commands.add("atom-workspace","codestream:context-create-bookmark",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Bookmark,"Context Menu")}),atom.commands.add("atom-workspace","codestream:context-get-permalink",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Link,"Context Menu")}),atom.commands.add("atom-workspace","codestream:keymap-create-comment",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Comment,"Shortcut")}),atom.commands.add("atom-workspace","codestream:keymap-create-issue",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Issue,"Shortcut")}),atom.commands.add("atom-workspace","codestream:keymap-create-bookmark",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Bookmark,"Shortcut")}),atom.commands.add("atom-workspace","codestream:keymap-get-permalink",{hiddenInCommandPalette:!0,didDispatch:()=>e(E.Link,"Shortcut")}),atom.commands.add("atom-workspace","codestream:keymap-copy-permalink",{hiddenInCommandPalette:!0,didDispatch:async()=>{const e=atom.workspace.getActiveTextEditor();if(!e)return;const t=await container_Container.session.agent.request(p,{uri:et.getUri(e),range:et.getCurrentSelectionRange(e),privacy:"private"});atom.clipboard.write(t.linkUrl),atom.notifications.addInfo("Permalink copied to clipboard!")}})),function(e,t){for(let n=0;n<e;n++)t(n+1)}(9,e=>{this.subscriptions.add(atom.commands.add("atom-workspace",`codestream:go-to-codemark-${e}`,async()=>{const t=await container_Container.session.agent.request(v,{key:e});if(!t)return;const{textDocument:n,range:r,marker:i}=t;container_Container.session.agent.telemetry({eventName:"Codemark Clicked",properties:{"Codemark Location":"Shortcut"}});const o=q.Convert.lsRangeToAtomRange(r),s=q.Convert.uriToPath(n.uri),a=container_Container.editorManipulator,c=await a.open(s);c?(await a.highlight(!0,s,o),a.scrollIntoView(c,o.start.row),container_Container.viewController.getMainView().showCodemark(i.codemarkId,n.uri)):container_Container.viewController.getMainView().showCodemark(i.codemarkId)}))})}async consumeStatusBar(e){const t=(e,t)=>{const n=(()=>{const e=container_Container.session.environment.name;switch(e){case _e.PD:return`${e}:`;default:return""}})(),r=(()=>{if(t){if(t.totalMentions>0)return`(${t.totalMentions})`;if(t.totalUnreads>0)return" •"}return""})();switch(e){case Ne.SignedIn:return`${n} ${container_Container.session.user.username} ${r}`.trim();case Ne.SigningIn:return`Signing in...${n}`.replace(":","");default:return`${n} Sign in`.trim()}},n=(e,t)=>e===Ne.SigningIn?"icon loading loading-spinner-tiny inline-block".split(" "):"icon icon-comment-discussion".split(" "),r=document.createElement("div");r.classList.add("inline-block","codestream-session-status"),r.onclick=(e=>{e.stopPropagation(),atom.commands.dispatch(document.querySelector("atom-workspace"),"codestream:toggle")});const i=document.createElement("span");i.classList.add(...n(container_Container.session.status)),r.appendChild(i),atom.tooltips.add(r,{title:"Toggle CodeStream"});const o=document.createElement("span");r.appendChild(o);const a=e.addRightTile({item:r,priority:400}),c=container_Container.session.observeSessionStatus(e=>{o.innerText=t(e),i.classList.remove(...i.classList.values()),i.classList.add(...n(container_Container.session.status))});this.environmentChangeEmitter.add(()=>{o.innerText=t(container_Container.session.status)});const u=container_Container.session.agent.onDidChangeData(e=>{e.type===s.Unreads&&(o.innerText=t(container_Container.session.status,e.data))});return new I.Disposable(()=>{c.dispose(),u.dispose(),a&&a.destroy()})}consumeSplitDiff(e){return container_Container.diffController.splitDiffService=e,new I.Disposable(()=>{e.disable(),container_Container.diffController.splitDiffService=void 0})}}let nt;const rt={initialize(e){container_Container.initialize(e),Ye.isDebugging()&&console.debug("CodeStream package initialized with state:",e),nt=new codestream_CodestreamPackage}};t.default=new Proxy(rt,{get(e,t){if(nt&&Reflect.has(nt,t)){let e=nt[t];return"function"==typeof e&&(e=e.bind(nt)),e}return e[t]}})}]).default;